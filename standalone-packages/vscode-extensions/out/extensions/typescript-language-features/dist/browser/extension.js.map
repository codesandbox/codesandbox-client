{"version":3,"sources":["webpack://typescript-language-features/external \"vscode\"","webpack://typescript-language-features/./src/api.ts","webpack://typescript-language-features/./src/commands/commandManager.ts","webpack://typescript-language-features/./src/commands/index.ts","webpack://typescript-language-features/./src/commands/configurePlugin.ts","webpack://typescript-language-features/./src/commands/goToProjectConfiguration.ts","webpack://typescript-language-features/./src/utils/tsconfig.ts","webpack://typescript-language-features/../../node_modules/path-browserify/index.js","webpack://typescript-language-features/./src/utils/cancellation.ts","webpack://typescript-language-features/./src/commands/learnMoreAboutRefactorings.ts","webpack://typescript-language-features/./src/utils/languageModeIds.ts","webpack://typescript-language-features/./src/commands/openTsServerLog.ts","webpack://typescript-language-features/./src/commands/reloadProject.ts","webpack://typescript-language-features/./src/commands/restartTsServer.ts","webpack://typescript-language-features/./src/commands/selectTypeScriptVersion.ts","webpack://typescript-language-features/./src/languageFeatures/languageConfiguration.ts","webpack://typescript-language-features/./src/utils/dispose.ts","webpack://typescript-language-features/./src/lazyClientHost.ts","webpack://typescript-language-features/./src/typeScriptServiceClientHost.ts","webpack://typescript-language-features/./src/languageFeatures/fileConfigurationManager.ts","webpack://typescript-language-features/./src/utils/api.ts","webpack://typescript-language-features/../../node_modules/semver/semver.js","webpack://typescript-language-features/./src/utils/fileSchemes.ts","webpack://typescript-language-features/./src/utils/objects.ts","webpack://typescript-language-features/./src/utils/arrays.ts","webpack://typescript-language-features/./src/utils/resourceMap.ts","webpack://typescript-language-features/./src/languageProvider.ts","webpack://typescript-language-features/./src/tsServer/cachedResponse.ts","webpack://typescript-language-features/./src/typescriptService.ts","webpack://typescript-language-features/./src/languageFeatures/callHierarchy.ts","webpack://typescript-language-features/./src/protocol.const.ts","webpack://typescript-language-features/./src/utils/dependentRegistration.ts","webpack://typescript-language-features/./src/utils/modifiers.ts","webpack://typescript-language-features/./src/utils/typeConverters.ts","webpack://typescript-language-features/./src/languageFeatures/codeLens/implementationsCodeLens.ts","webpack://typescript-language-features/./src/languageFeatures/codeLens/baseCodeLensProvider.ts","webpack://typescript-language-features/./src/utils/regexp.ts","webpack://typescript-language-features/./src/languageFeatures/codeLens/referencesCodeLens.ts","webpack://typescript-language-features/./src/tsServer/server.ts","webpack://typescript-language-features/./src/tsServer/callbackMap.ts","webpack://typescript-language-features/./src/tsServer/requestQueue.ts","webpack://typescript-language-features/./src/tsServer/serverError.ts","webpack://typescript-language-features/./src/languageFeatures/completions.ts","webpack://typescript-language-features/./src/utils/codeAction.ts","webpack://typescript-language-features/./src/utils/previewer.ts","webpack://typescript-language-features/./src/utils/snippetForFunctionCall.ts","webpack://typescript-language-features/./src/languageFeatures/definitions.ts","webpack://typescript-language-features/./src/languageFeatures/definitionProviderBase.ts","webpack://typescript-language-features/./src/languageFeatures/directiveCommentCompletions.ts","webpack://typescript-language-features/./src/languageFeatures/documentHighlight.ts","webpack://typescript-language-features/./src/languageFeatures/documentSymbol.ts","webpack://typescript-language-features/./src/languageFeatures/fileReferences.ts","webpack://typescript-language-features/./src/languageFeatures/fixAll.ts","webpack://typescript-language-features/./src/utils/errorCodes.ts","webpack://typescript-language-features/./src/utils/fixNames.ts","webpack://typescript-language-features/./src/languageFeatures/folding.ts","webpack://typescript-language-features/./src/languageFeatures/formatting.ts","webpack://typescript-language-features/./src/languageFeatures/hover.ts","webpack://typescript-language-features/./src/tsServer/versionProvider.ts","webpack://typescript-language-features/./src/languageFeatures/implementations.ts","webpack://typescript-language-features/./src/languageFeatures/jsDocCompletions.ts","webpack://typescript-language-features/./src/languageFeatures/organizeImports.ts","webpack://typescript-language-features/./src/languageFeatures/quickFix.ts","webpack://typescript-language-features/./src/utils/memoize.ts","webpack://typescript-language-features/./src/languageFeatures/refactor.ts","webpack://typescript-language-features/./src/languageFeatures/references.ts","webpack://typescript-language-features/./src/languageFeatures/rename.ts","webpack://typescript-language-features/./src/languageFeatures/semanticTokens.ts","webpack://typescript-language-features/./src/languageFeatures/signatureHelp.ts","webpack://typescript-language-features/./src/languageFeatures/smartSelect.ts","webpack://typescript-language-features/./src/languageFeatures/tagClosing.ts","webpack://typescript-language-features/./src/languageFeatures/typeDefinitions.ts","webpack://typescript-language-features/./src/languageFeatures/inlayHints.ts","webpack://typescript-language-features/./src/typescriptServiceClient.ts","webpack://typescript-language-features/./src/languageFeatures/diagnostics.ts","webpack://typescript-language-features/./src/tsServer/bufferSyncSupport.ts","webpack://typescript-language-features/./src/utils/async.ts","webpack://typescript-language-features/./src/tsServer/spawner.ts","webpack://typescript-language-features/./src/utils/configuration.ts","webpack://typescript-language-features/./src/utils/platform.ts","webpack://typescript-language-features/./src/tsServer/versionManager.ts","webpack://typescript-language-features/./src/utils/logger.ts","webpack://typescript-language-features/./src/utils/pluginPathsProvider.ts","webpack://typescript-language-features/./src/utils/relativePathResolver.ts","webpack://typescript-language-features/./src/utils/telemetry.ts","webpack://typescript-language-features/./src/utils/tracer.ts","webpack://typescript-language-features/./src/ui/intellisenseStatus.ts","webpack://typescript-language-features/./src/ui/versionStatus.ts","webpack://typescript-language-features/./src/utils/largeProjectStatus.ts","webpack://typescript-language-features/./src/utils/logLevelMonitor.ts","webpack://typescript-language-features/./src/utils/typingsStatus.ts","webpack://typescript-language-features/./src/languageFeatures/updatePathsOnRename.ts","webpack://typescript-language-features/./src/utils/languageDescription.ts","webpack://typescript-language-features/./src/languageFeatures/workspaceSymbols.ts","webpack://typescript-language-features/./src/utils/lazy.ts","webpack://typescript-language-features/./src/utils/managedFileContext.ts","webpack://typescript-language-features/./src/tsServer/cancellation.ts","webpack://typescript-language-features/./src/tsServer/logDirectoryProvider.ts","webpack://typescript-language-features/./src/tsServer/serverProcess.browser.ts","webpack://typescript-language-features/./src/utils/activeJsTsEditorTracker.ts","webpack://typescript-language-features/./src/utils/configuration.browser.ts","webpack://typescript-language-features/./src/utils/plugins.ts","webpack://typescript-language-features/./src/languageFeatures/tsconfig.ts","webpack://typescript-language-features/webpack/bootstrap","webpack://typescript-language-features/webpack/runtime/global","webpack://typescript-language-features/./src/extension.browser.ts"],"names":[],"mappings":"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;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,sCAAsC,8BAA8B;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,mBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,UAAU,yBAAyB;AACnC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAU,qBAAqB;AAC/B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAU,aAAa;AACvB;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA,WAAW;AACX;AACA,qCAAqC;AACrC;AACA;AACA,SAAS;AACT;AACA;AACA,gDAAgD;AAChD;AACA,WAAW;AACX;AACA,wCAAwC;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,2CAA2C,cAAc;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,QAAQ;AACzC;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,+BAA+B,QAAQ;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,gDAAgD;AAChD;AACA,KAAK;AACL,+BAA+B,QAAQ;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,QAAQ;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,UAAU,YAAY;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oFAAoF;AACpF;AACA,KAAK;AACL;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA,8DAA8D;;AAE9D;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;;;;;;;;AChhBA;;;gGAGgG;;;AAEhG,sCAAiC;AAEjC,MAAM,cAAc,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,E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CA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAoB,oCAAoC;AACxD,0BAA0B,oCAAoC;AAC9D,0BAA0B,oCAAoC;AAC9D;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;;AAEA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA,aAAa;AACb;AACA;AACA;AACA;;AAEA,aAAa;AACb;AACA;AACA;AACA;;AAEA,cAAc;;AAEd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,WAAW;AACX;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA,YAAY;AACZ;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,0BAA0B;;AAE1B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,2BAA2B;AAC3B;AACA;AACA;;AAEA,aAAa;AACb;AACA;AACA;;AAEA,aAAa;AACb;AACA;AACA;;AAEA,aAAa;AACb;AACA;AACA;;AAEA,eAAe;AACf;AACA;AACA;;AAEA,oBAAoB;AACpB;AACA;AACA;;AAEA,gBAAgB;AAChB;AACA;AACA;;AAEA,YAAY;AACZ;AACA;AACA;AACA,GAAG;AACH;;AAEA,aAAa;AACb;AACA;AACA;AACA,GAAG;AACH;;AAEA,UAAU;AACV;AACA;AACA;;AAEA,UAAU;AACV;AACA;AACA;;AAEA,UAAU;AACV;AACA;AACA;;AAEA,WAAW;AACX;AACA;AACA;;AAEA,WAAW;AACX;AACA;AACA;;AAEA,WAAW;AACX;AACA;AACA;;AAEA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP,KAAK;AACL,GAAG;AACH;;AAEA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;;AAEA;;AAEA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,iBAAiB,qBAAqB;AACtC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,iBAAiB,gBAAgB;AACjC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,gBAAgB;AAC/B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,iBAAiB;AACjB;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA,kBAAkB;AAClB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,iBAAiB,sBAAsB;AACvC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA,WAAW;AACX;AACA;AACA;;AAEA;AACA,WAAW;AACX;AACA;AACA;;AAEA,eAAe;AACf;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,iBAAiB,sBAAsB;AACvC;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA,kBAAkB;AAClB;AACA;AACA;AACA;;AAEA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;;AAEA,cAAc;AACd;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;;;;;;AC18CA;;;gGAGgG;;;AAEnF,YAAI,GAAG,MAAM,CAAC;AACd,gBAAQ,GAAG,UAAU,CAAC;AACtB,WAAG,GAAG,KAAK,CAAC;AACzB,wBAAwB;AACX,YAAI,GAAG,MAAM,CAAC;AACd,0BAAkB,GAAG,oBAAoB,CAAC;AAC1C,0BAAkB,GAAG,sBAAsB,CAAC;AAC5C,aAAK,GAAG,OAAO,CAAC;AAChB,iBAAS,GAAG,YAAY,CAAC;AAEzB,gCAAwB,GAAG;IACvC,YAAI;IACJ,gBAAQ;IACR,0BAAkB;IAClB,0BAAkB;CAClB,CAAC;AAEF;;GAEG;AACU,uBAAe,GAAG,IAAI,GAAG,CAAC;IA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","file":"extension.js","sourcesContent":["module.exports = require(\"vscode\");","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { PluginManager } from './utils/plugins';\n\nclass ApiV0 {\n\tpublic constructor(\n\t\tpublic readonly onCompletionAccepted: vscode.Event<vscode.CompletionItem & { metadata?: any }>,\n\t\tprivate readonly _pluginManager: PluginManager,\n\t) { }\n\n\tconfigurePlugin(pluginId: string, configuration: {}): void {\n\t\tthis._pluginManager.setConfiguration(pluginId, configuration);\n\t}\n}\n\nexport interface Api {\n\tgetAPI(version: 0): ApiV0 | undefined;\n}\n\nexport function getExtensionApi(\n\tonCompletionAccepted: vscode.Event<vscode.CompletionItem>,\n\tpluginManager: PluginManager,\n): Api {\n\treturn {\n\t\tgetAPI(version) {\n\t\t\tif (version === 0) {\n\t\t\t\treturn new ApiV0(onCompletionAccepted, pluginManager);\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}\n\t};\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\n\nexport interface Command {\n\treadonly id: string;\n\n\texecute(...args: any[]): void;\n}\n\nexport class CommandManager {\n\tprivate readonly commands = new Map<string, vscode.Disposable>();\n\n\tpublic dispose() {\n\t\tfor (const registration of this.commands.values()) {\n\t\t\tregistration.dispose();\n\t\t}\n\t\tthis.commands.clear();\n\t}\n\n\tpublic register<T extends Command>(command: T): T {\n\t\tif (!this.commands.has(command.id)) {\n\t\t\tthis.commands.set(command.id, vscode.commands.registerCommand(command.id, command.execute, command));\n\t\t}\n\t\treturn command;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport TypeScriptServiceClientHost from '../typeScriptServiceClientHost';\nimport { ActiveJsTsEditorTracker } from '../utils/activeJsTsEditorTracker';\nimport { Lazy } from '../utils/lazy';\nimport { PluginManager } from '../utils/plugins';\nimport { CommandManager } from './commandManager';\nimport { ConfigurePluginCommand } from './configurePlugin';\nimport { JavaScriptGoToProjectConfigCommand, TypeScriptGoToProjectConfigCommand } from './goToProjectConfiguration';\nimport { LearnMoreAboutRefactoringsCommand } from './learnMoreAboutRefactorings';\nimport { OpenTsServerLogCommand } from './openTsServerLog';\nimport { ReloadJavaScriptProjectsCommand, ReloadTypeScriptProjectsCommand } from './reloadProject';\nimport { RestartTsServerCommand } from './restartTsServer';\nimport { SelectTypeScriptVersionCommand } from './selectTypeScriptVersion';\n\nexport function registerBaseCommands(\n\tcommandManager: CommandManager,\n\tlazyClientHost: Lazy<TypeScriptServiceClientHost>,\n\tpluginManager: PluginManager,\n\tactiveJsTsEditorTracker: ActiveJsTsEditorTracker,\n): void {\n\tcommandManager.register(new ReloadTypeScriptProjectsCommand(lazyClientHost));\n\tcommandManager.register(new ReloadJavaScriptProjectsCommand(lazyClientHost));\n\tcommandManager.register(new SelectTypeScriptVersionCommand(lazyClientHost));\n\tcommandManager.register(new OpenTsServerLogCommand(lazyClientHost));\n\tcommandManager.register(new RestartTsServerCommand(lazyClientHost));\n\tcommandManager.register(new TypeScriptGoToProjectConfigCommand(activeJsTsEditorTracker, lazyClientHost));\n\tcommandManager.register(new JavaScriptGoToProjectConfigCommand(activeJsTsEditorTracker, lazyClientHost));\n\tcommandManager.register(new ConfigurePluginCommand(pluginManager));\n\tcommandManager.register(new LearnMoreAboutRefactoringsCommand());\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { PluginManager } from '../utils/plugins';\nimport { Command } from './commandManager';\n\nexport class ConfigurePluginCommand implements Command {\n\tpublic readonly id = '_typescript.configurePlugin';\n\n\tpublic constructor(\n\t\tprivate readonly pluginManager: PluginManager,\n\t) { }\n\n\tpublic execute(pluginId: string, configuration: any) {\n\t\tthis.pluginManager.setConfiguration(pluginId, configuration);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport TypeScriptServiceClientHost from '../typeScriptServiceClientHost';\nimport { ActiveJsTsEditorTracker } from '../utils/activeJsTsEditorTracker';\nimport { Lazy } from '../utils/lazy';\nimport { openProjectConfigForFile, ProjectType } from '../utils/tsconfig';\nimport { Command } from './commandManager';\n\nexport class TypeScriptGoToProjectConfigCommand implements Command {\n\tpublic readonly id = 'typescript.goToProjectConfig';\n\n\tpublic constructor(\n\t\tprivate readonly activeJsTsEditorTracker: ActiveJsTsEditorTracker,\n\t\tprivate readonly lazyClientHost: Lazy<TypeScriptServiceClientHost>,\n\t) { }\n\n\tpublic execute() {\n\t\tconst editor = this.activeJsTsEditorTracker.activeJsTsEditor;\n\t\tif (editor) {\n\t\t\topenProjectConfigForFile(ProjectType.TypeScript, this.lazyClientHost.value.serviceClient, editor.document.uri);\n\t\t}\n\t}\n}\n\nexport class JavaScriptGoToProjectConfigCommand implements Command {\n\tpublic readonly id = 'javascript.goToProjectConfig';\n\n\tpublic constructor(\n\t\tprivate readonly activeJsTsEditorTracker: ActiveJsTsEditorTracker,\n\t\tprivate readonly lazyClientHost: Lazy<TypeScriptServiceClientHost>,\n\t) { }\n\n\tpublic execute() {\n\t\tconst editor = this.activeJsTsEditorTracker.activeJsTsEditor;\n\t\tif (editor) {\n\t\t\topenProjectConfigForFile(ProjectType.JavaScript, this.lazyClientHost.value.serviceClient, editor.document.uri);\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as path from 'path';\nimport * as vscode from 'vscode';\nimport * as nls from 'vscode-nls';\nimport type * as Proto from '../protocol';\nimport { ITypeScriptServiceClient, ServerResponse } from '../typescriptService';\nimport { nulToken } from '../utils/cancellation';\nimport { TypeScriptServiceConfiguration } from './configuration';\n\nconst localize = nls.loadMessageBundle();\n\nexport const enum ProjectType {\n\tTypeScript,\n\tJavaScript,\n}\n\nexport function isImplicitProjectConfigFile(configFileName: string) {\n\treturn configFileName.startsWith('/dev/null/');\n}\n\nexport function inferredProjectCompilerOptions(\n\tprojectType: ProjectType,\n\tserviceConfig: TypeScriptServiceConfiguration,\n): Proto.ExternalProjectCompilerOptions {\n\tconst projectConfig: Proto.ExternalProjectCompilerOptions = {\n\t\tmodule: 'commonjs' as Proto.ModuleKind,\n\t\ttarget: 'es2020' as Proto.ScriptTarget,\n\t\tjsx: 'preserve' as Proto.JsxEmit,\n\t};\n\n\tif (serviceConfig.implicitProjectConfiguration.checkJs) {\n\t\tprojectConfig.checkJs = true;\n\t\tif (projectType === ProjectType.TypeScript) {\n\t\t\tprojectConfig.allowJs = true;\n\t\t}\n\t}\n\n\tif (serviceConfig.implicitProjectConfiguration.experimentalDecorators) {\n\t\tprojectConfig.experimentalDecorators = true;\n\t}\n\n\tif (serviceConfig.implicitProjectConfiguration.strictNullChecks) {\n\t\tprojectConfig.strictNullChecks = true;\n\t}\n\n\tif (serviceConfig.implicitProjectConfiguration.strictFunctionTypes) {\n\t\tprojectConfig.strictFunctionTypes = true;\n\t}\n\n\tif (projectType === ProjectType.TypeScript) {\n\t\tprojectConfig.sourceMap = true;\n\t}\n\n\treturn projectConfig;\n}\n\nfunction inferredProjectConfigSnippet(\n\tprojectType: ProjectType,\n\tconfig: TypeScriptServiceConfiguration\n) {\n\tconst baseConfig = inferredProjectCompilerOptions(projectType, config);\n\tconst compilerOptions = Object.keys(baseConfig).map(key => `\"${key}\": ${JSON.stringify(baseConfig[key])}`);\n\treturn new vscode.SnippetString(`{\n\t\"compilerOptions\": {\n\t\t${compilerOptions.join(',\\n\\t\\t')}$0\n\t},\n\t\"exclude\": [\n\t\t\"node_modules\",\n\t\t\"**/node_modules/*\"\n\t]\n}`);\n}\n\nexport async function openOrCreateConfig(\n\tprojectType: ProjectType,\n\trootPath: string,\n\tconfiguration: TypeScriptServiceConfiguration,\n): Promise<vscode.TextEditor | null> {\n\tconst configFile = vscode.Uri.file(path.join(rootPath, projectType === ProjectType.TypeScript ? 'tsconfig.json' : 'jsconfig.json'));\n\tconst col = vscode.window.activeTextEditor?.viewColumn;\n\ttry {\n\t\tconst doc = await vscode.workspace.openTextDocument(configFile);\n\t\treturn vscode.window.showTextDocument(doc, col);\n\t} catch {\n\t\tconst doc = await vscode.workspace.openTextDocument(configFile.with({ scheme: 'untitled' }));\n\t\tconst editor = await vscode.window.showTextDocument(doc, col);\n\t\tif (editor.document.getText().length === 0) {\n\t\t\tawait editor.insertSnippet(inferredProjectConfigSnippet(projectType, configuration));\n\t\t}\n\t\treturn editor;\n\t}\n}\n\nexport async function openProjectConfigOrPromptToCreate(\n\tprojectType: ProjectType,\n\tclient: ITypeScriptServiceClient,\n\trootPath: string,\n\tconfigFileName: string,\n): Promise<void> {\n\tif (!isImplicitProjectConfigFile(configFileName)) {\n\t\tconst doc = await vscode.workspace.openTextDocument(configFileName);\n\t\tvscode.window.showTextDocument(doc, vscode.window.activeTextEditor?.viewColumn);\n\t\treturn;\n\t}\n\n\tconst CreateConfigItem: vscode.MessageItem = {\n\t\ttitle: projectType === ProjectType.TypeScript\n\t\t\t? localize('typescript.configureTsconfigQuickPick', 'Configure tsconfig.json')\n\t\t\t: localize('typescript.configureJsconfigQuickPick', 'Configure jsconfig.json'),\n\t};\n\n\tconst selected = await vscode.window.showInformationMessage(\n\t\t(projectType === ProjectType.TypeScript\n\t\t\t? localize('typescript.noTypeScriptProjectConfig', 'File is not part of a TypeScript project. Click [here]({0}) to learn more.', 'https://go.microsoft.com/fwlink/?linkid=841896')\n\t\t\t: localize('typescript.noJavaScriptProjectConfig', 'File is not part of a JavaScript project Click [here]({0}) to learn more.', 'https://go.microsoft.com/fwlink/?linkid=759670')\n\t\t),\n\t\tCreateConfigItem);\n\n\tswitch (selected) {\n\t\tcase CreateConfigItem:\n\t\t\topenOrCreateConfig(projectType, rootPath, client.configuration);\n\t\t\treturn;\n\t}\n}\n\nexport async function openProjectConfigForFile(\n\tprojectType: ProjectType,\n\tclient: ITypeScriptServiceClient,\n\tresource: vscode.Uri,\n): Promise<void> {\n\tconst rootPath = client.getWorkspaceRootForResource(resource);\n\tif (!rootPath) {\n\t\tvscode.window.showInformationMessage(\n\t\t\tlocalize(\n\t\t\t\t'typescript.projectConfigNoWorkspace',\n\t\t\t\t'Please open a folder in VS Code to use a TypeScript or JavaScript project'));\n\t\treturn;\n\t}\n\n\tconst file = client.toPath(resource);\n\t// TSServer errors when 'projectInfo' is invoked on a non js/ts file\n\tif (!file || !await client.toPath(resource)) {\n\t\tvscode.window.showWarningMessage(\n\t\t\tlocalize(\n\t\t\t\t'typescript.projectConfigUnsupportedFile',\n\t\t\t\t'Could not determine TypeScript or JavaScript project. Unsupported file type'));\n\t\treturn;\n\t}\n\n\tlet res: ServerResponse.Response<protocol.ProjectInfoResponse> | undefined;\n\ttry {\n\t\tres = await client.execute('projectInfo', { file, needFileNameList: false }, nulToken);\n\t} catch {\n\t\t// noop\n\t}\n\n\tif (res?.type !== 'response' || !res.body) {\n\t\tvscode.window.showWarningMessage(localize('typescript.projectConfigCouldNotGetInfo', 'Could not determine TypeScript or JavaScript project'));\n\t\treturn;\n\t}\n\treturn openProjectConfigOrPromptToCreate(projectType, client, rootPath, res.body.configFileName);\n}\n\n","// 'path' module extracted from Node.js v8.11.1 (only the posix part)\n// transplited with Babel\n\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nfunction assertPath(path) {\n  if (typeof path !== 'string') {\n    throw new TypeError('Path must be a string. Received ' + JSON.stringify(path));\n  }\n}\n\n// Resolves . and .. elements in a path with directory names\nfunction normalizeStringPosix(path, allowAboveRoot) {\n  var res = '';\n  var lastSegmentLength = 0;\n  var lastSlash = -1;\n  var dots = 0;\n  var code;\n  for (var i = 0; i <= path.length; ++i) {\n    if (i < path.length)\n      code = path.charCodeAt(i);\n    else if (code === 47 /*/*/)\n      break;\n    else\n      code = 47 /*/*/;\n    if (code === 47 /*/*/) {\n      if (lastSlash === i - 1 || dots === 1) {\n        // NOOP\n      } else if (lastSlash !== i - 1 && dots === 2) {\n        if (res.length < 2 || lastSegmentLength !== 2 || res.charCodeAt(res.length - 1) !== 46 /*.*/ || res.charCodeAt(res.length - 2) !== 46 /*.*/) {\n          if (res.length > 2) {\n            var lastSlashIndex = res.lastIndexOf('/');\n            if (lastSlashIndex !== res.length - 1) {\n              if (lastSlashIndex === -1) {\n                res = '';\n                lastSegmentLength = 0;\n              } else {\n                res = res.slice(0, lastSlashIndex);\n                lastSegmentLength = res.length - 1 - res.lastIndexOf('/');\n              }\n              lastSlash = i;\n              dots = 0;\n              continue;\n            }\n          } else if (res.length === 2 || res.length === 1) {\n            res = '';\n            lastSegmentLength = 0;\n            lastSlash = i;\n            dots = 0;\n            continue;\n          }\n        }\n        if (allowAboveRoot) {\n          if (res.length > 0)\n            res += '/..';\n          else\n            res = '..';\n          lastSegmentLength = 2;\n        }\n      } else {\n        if (res.length > 0)\n          res += '/' + path.slice(lastSlash + 1, i);\n        else\n          res = path.slice(lastSlash + 1, i);\n        lastSegmentLength = i - lastSlash - 1;\n      }\n      lastSlash = i;\n      dots = 0;\n    } else if (code === 46 /*.*/ && dots !== -1) {\n      ++dots;\n    } else {\n      dots = -1;\n    }\n  }\n  return res;\n}\n\nfunction _format(sep, pathObject) {\n  var dir = pathObject.dir || pathObject.root;\n  var base = pathObject.base || (pathObject.name || '') + (pathObject.ext || '');\n  if (!dir) {\n    return base;\n  }\n  if (dir === pathObject.root) {\n    return dir + base;\n  }\n  return dir + sep + base;\n}\n\nvar posix = {\n  // path.resolve([from ...], to)\n  resolve: function resolve() {\n    var resolvedPath = '';\n    var resolvedAbsolute = false;\n    var cwd;\n\n    for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n      var path;\n      if (i >= 0)\n        path = arguments[i];\n      else {\n        if (cwd === undefined)\n          cwd = process.cwd();\n        path = cwd;\n      }\n\n      assertPath(path);\n\n      // Skip empty entries\n      if (path.length === 0) {\n        continue;\n      }\n\n      resolvedPath = path + '/' + resolvedPath;\n      resolvedAbsolute = path.charCodeAt(0) === 47 /*/*/;\n    }\n\n    // At this point the path should be resolved to a full absolute path, but\n    // handle relative paths to be safe (might happen when process.cwd() fails)\n\n    // Normalize the path\n    resolvedPath = normalizeStringPosix(resolvedPath, !resolvedAbsolute);\n\n    if (resolvedAbsolute) {\n      if (resolvedPath.length > 0)\n        return '/' + resolvedPath;\n      else\n        return '/';\n    } else if (resolvedPath.length > 0) {\n      return resolvedPath;\n    } else {\n      return '.';\n    }\n  },\n\n  normalize: function normalize(path) {\n    assertPath(path);\n\n    if (path.length === 0) return '.';\n\n    var isAbsolute = path.charCodeAt(0) === 47 /*/*/;\n    var trailingSeparator = path.charCodeAt(path.length - 1) === 47 /*/*/;\n\n    // Normalize the path\n    path = normalizeStringPosix(path, !isAbsolute);\n\n    if (path.length === 0 && !isAbsolute) path = '.';\n    if (path.length > 0 && trailingSeparator) path += '/';\n\n    if (isAbsolute) return '/' + path;\n    return path;\n  },\n\n  isAbsolute: function isAbsolute(path) {\n    assertPath(path);\n    return path.length > 0 && path.charCodeAt(0) === 47 /*/*/;\n  },\n\n  join: function join() {\n    if (arguments.length === 0)\n      return '.';\n    var joined;\n    for (var i = 0; i < arguments.length; ++i) {\n      var arg = arguments[i];\n      assertPath(arg);\n      if (arg.length > 0) {\n        if (joined === undefined)\n          joined = arg;\n        else\n          joined += '/' + arg;\n      }\n    }\n    if (joined === undefined)\n      return '.';\n    return posix.normalize(joined);\n  },\n\n  relative: function relative(from, to) {\n    assertPath(from);\n    assertPath(to);\n\n    if (from === to) return '';\n\n    from = posix.resolve(from);\n    to = posix.resolve(to);\n\n    if (from === to) return '';\n\n    // Trim any leading backslashes\n    var fromStart = 1;\n    for (; fromStart < from.length; ++fromStart) {\n      if (from.charCodeAt(fromStart) !== 47 /*/*/)\n        break;\n    }\n    var fromEnd = from.length;\n    var fromLen = fromEnd - fromStart;\n\n    // Trim any leading backslashes\n    var toStart = 1;\n    for (; toStart < to.length; ++toStart) {\n      if (to.charCodeAt(toStart) !== 47 /*/*/)\n        break;\n    }\n    var toEnd = to.length;\n    var toLen = toEnd - toStart;\n\n    // Compare paths to find the longest common path from root\n    var length = fromLen < toLen ? fromLen : toLen;\n    var lastCommonSep = -1;\n    var i = 0;\n    for (; i <= length; ++i) {\n      if (i === length) {\n        if (toLen > length) {\n          if (to.charCodeAt(toStart + i) === 47 /*/*/) {\n            // We get here if `from` is the exact base path for `to`.\n            // For example: from='/foo/bar'; to='/foo/bar/baz'\n            return to.slice(toStart + i + 1);\n          } else if (i === 0) {\n            // We get here if `from` is the root\n            // For example: from='/'; to='/foo'\n            return to.slice(toStart + i);\n          }\n        } else if (fromLen > length) {\n          if (from.charCodeAt(fromStart + i) === 47 /*/*/) {\n            // We get here if `to` is the exact base path for `from`.\n            // For example: from='/foo/bar/baz'; to='/foo/bar'\n            lastCommonSep = i;\n          } else if (i === 0) {\n            // We get here if `to` is the root.\n            // For example: from='/foo'; to='/'\n            lastCommonSep = 0;\n          }\n        }\n        break;\n      }\n      var fromCode = from.charCodeAt(fromStart + i);\n      var toCode = to.charCodeAt(toStart + i);\n      if (fromCode !== toCode)\n        break;\n      else if (fromCode === 47 /*/*/)\n        lastCommonSep = i;\n    }\n\n    var out = '';\n    // Generate the relative path based on the path difference between `to`\n    // and `from`\n    for (i = fromStart + lastCommonSep + 1; i <= fromEnd; ++i) {\n      if (i === fromEnd || from.charCodeAt(i) === 47 /*/*/) {\n        if (out.length === 0)\n          out += '..';\n        else\n          out += '/..';\n      }\n    }\n\n    // Lastly, append the rest of the destination (`to`) path that comes after\n    // the common path parts\n    if (out.length > 0)\n      return out + to.slice(toStart + lastCommonSep);\n    else {\n      toStart += lastCommonSep;\n      if (to.charCodeAt(toStart) === 47 /*/*/)\n        ++toStart;\n      return to.slice(toStart);\n    }\n  },\n\n  _makeLong: function _makeLong(path) {\n    return path;\n  },\n\n  dirname: function dirname(path) {\n    assertPath(path);\n    if (path.length === 0) return '.';\n    var code = path.charCodeAt(0);\n    var hasRoot = code === 47 /*/*/;\n    var end = -1;\n    var matchedSlash = true;\n    for (var i = path.length - 1; i >= 1; --i) {\n      code = path.charCodeAt(i);\n      if (code === 47 /*/*/) {\n          if (!matchedSlash) {\n            end = i;\n            break;\n          }\n        } else {\n        // We saw the first non-path separator\n        matchedSlash = false;\n      }\n    }\n\n    if (end === -1) return hasRoot ? '/' : '.';\n    if (hasRoot && end === 1) return '//';\n    return path.slice(0, end);\n  },\n\n  basename: function basename(path, ext) {\n    if (ext !== undefined && typeof ext !== 'string') throw new TypeError('\"ext\" argument must be a string');\n    assertPath(path);\n\n    var start = 0;\n    var end = -1;\n    var matchedSlash = true;\n    var i;\n\n    if (ext !== undefined && ext.length > 0 && ext.length <= path.length) {\n      if (ext.length === path.length && ext === path) return '';\n      var extIdx = ext.length - 1;\n      var firstNonSlashEnd = -1;\n      for (i = path.length - 1; i >= 0; --i) {\n        var code = path.charCodeAt(i);\n        if (code === 47 /*/*/) {\n            // If we reached a path separator that was not part of a set of path\n            // separators at the end of the string, stop now\n            if (!matchedSlash) {\n              start = i + 1;\n              break;\n            }\n          } else {\n          if (firstNonSlashEnd === -1) {\n            // We saw the first non-path separator, remember this index in case\n            // we need it if the extension ends up not matching\n            matchedSlash = false;\n            firstNonSlashEnd = i + 1;\n          }\n          if (extIdx >= 0) {\n            // Try to match the explicit extension\n            if (code === ext.charCodeAt(extIdx)) {\n              if (--extIdx === -1) {\n                // We matched the extension, so mark this as the end of our path\n                // component\n                end = i;\n              }\n            } else {\n              // Extension does not match, so our result is the entire path\n              // component\n              extIdx = -1;\n              end = firstNonSlashEnd;\n            }\n          }\n        }\n      }\n\n      if (start === end) end = firstNonSlashEnd;else if (end === -1) end = path.length;\n      return path.slice(start, end);\n    } else {\n      for (i = path.length - 1; i >= 0; --i) {\n        if (path.charCodeAt(i) === 47 /*/*/) {\n            // If we reached a path separator that was not part of a set of path\n            // separators at the end of the string, stop now\n            if (!matchedSlash) {\n              start = i + 1;\n              break;\n            }\n          } else if (end === -1) {\n          // We saw the first non-path separator, mark this as the end of our\n          // path component\n          matchedSlash = false;\n          end = i + 1;\n        }\n      }\n\n      if (end === -1) return '';\n      return path.slice(start, end);\n    }\n  },\n\n  extname: function extname(path) {\n    assertPath(path);\n    var startDot = -1;\n    var startPart = 0;\n    var end = -1;\n    var matchedSlash = true;\n    // Track the state of characters (if any) we see before our first dot and\n    // after any path separator we find\n    var preDotState = 0;\n    for (var i = path.length - 1; i >= 0; --i) {\n      var code = path.charCodeAt(i);\n      if (code === 47 /*/*/) {\n          // If we reached a path separator that was not part of a set of path\n          // separators at the end of the string, stop now\n          if (!matchedSlash) {\n            startPart = i + 1;\n            break;\n          }\n          continue;\n        }\n      if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // extension\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46 /*.*/) {\n          // If this is our first dot, mark it as the start of our extension\n          if (startDot === -1)\n            startDot = i;\n          else if (preDotState !== 1)\n            preDotState = 1;\n      } else if (startDot !== -1) {\n        // We saw a non-dot and non-path separator before our dot, so we should\n        // have a good chance at having a non-empty extension\n        preDotState = -1;\n      }\n    }\n\n    if (startDot === -1 || end === -1 ||\n        // We saw a non-dot character immediately before the dot\n        preDotState === 0 ||\n        // The (right-most) trimmed path component is exactly '..'\n        preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {\n      return '';\n    }\n    return path.slice(startDot, end);\n  },\n\n  format: function format(pathObject) {\n    if (pathObject === null || typeof pathObject !== 'object') {\n      throw new TypeError('The \"pathObject\" argument must be of type Object. Received type ' + typeof pathObject);\n    }\n    return _format('/', pathObject);\n  },\n\n  parse: function parse(path) {\n    assertPath(path);\n\n    var ret = { root: '', dir: '', base: '', ext: '', name: '' };\n    if (path.length === 0) return ret;\n    var code = path.charCodeAt(0);\n    var isAbsolute = code === 47 /*/*/;\n    var start;\n    if (isAbsolute) {\n      ret.root = '/';\n      start = 1;\n    } else {\n      start = 0;\n    }\n    var startDot = -1;\n    var startPart = 0;\n    var end = -1;\n    var matchedSlash = true;\n    var i = path.length - 1;\n\n    // Track the state of characters (if any) we see before our first dot and\n    // after any path separator we find\n    var preDotState = 0;\n\n    // Get non-dir info\n    for (; i >= start; --i) {\n      code = path.charCodeAt(i);\n      if (code === 47 /*/*/) {\n          // If we reached a path separator that was not part of a set of path\n          // separators at the end of the string, stop now\n          if (!matchedSlash) {\n            startPart = i + 1;\n            break;\n          }\n          continue;\n        }\n      if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // extension\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46 /*.*/) {\n          // If this is our first dot, mark it as the start of our extension\n          if (startDot === -1) startDot = i;else if (preDotState !== 1) preDotState = 1;\n        } else if (startDot !== -1) {\n        // We saw a non-dot and non-path separator before our dot, so we should\n        // have a good chance at having a non-empty extension\n        preDotState = -1;\n      }\n    }\n\n    if (startDot === -1 || end === -1 ||\n    // We saw a non-dot character immediately before the dot\n    preDotState === 0 ||\n    // The (right-most) trimmed path component is exactly '..'\n    preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {\n      if (end !== -1) {\n        if (startPart === 0 && isAbsolute) ret.base = ret.name = path.slice(1, end);else ret.base = ret.name = path.slice(startPart, end);\n      }\n    } else {\n      if (startPart === 0 && isAbsolute) {\n        ret.name = path.slice(1, startDot);\n        ret.base = path.slice(1, end);\n      } else {\n        ret.name = path.slice(startPart, startDot);\n        ret.base = path.slice(startPart, end);\n      }\n      ret.ext = path.slice(startDot, end);\n    }\n\n    if (startPart > 0) ret.dir = path.slice(0, startPart - 1);else if (isAbsolute) ret.dir = '/';\n\n    return ret;\n  },\n\n  sep: '/',\n  delimiter: ':',\n  win32: null,\n  posix: null\n};\n\nposix.posix = posix;\n\nmodule.exports = posix;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\n\nconst noopDisposable = vscode.Disposable.from();\n\nexport const nulToken: vscode.CancellationToken = {\n\tisCancellationRequested: false,\n\tonCancellationRequested: () => noopDisposable\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { isTypeScriptDocument } from '../utils/languageModeIds';\nimport { Command } from './commandManager';\n\nexport class LearnMoreAboutRefactoringsCommand implements Command {\n\tpublic static readonly id = '_typescript.learnMoreAboutRefactorings';\n\tpublic readonly id = LearnMoreAboutRefactoringsCommand.id;\n\n\tpublic execute() {\n\t\tconst docUrl = vscode.window.activeTextEditor && isTypeScriptDocument(vscode.window.activeTextEditor.document)\n\t\t\t? 'https://go.microsoft.com/fwlink/?linkid=2114477'\n\t\t\t: 'https://go.microsoft.com/fwlink/?linkid=2116761';\n\n\t\tvscode.env.openExternal(vscode.Uri.parse(docUrl));\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\n\nexport const typescript = 'typescript';\nexport const typescriptreact = 'typescriptreact';\nexport const javascript = 'javascript';\nexport const javascriptreact = 'javascriptreact';\nexport const jsxTags = 'jsx-tags';\n\nexport const jsTsLanguageModes = [\n\tjavascript,\n\tjavascriptreact,\n\ttypescript,\n\ttypescriptreact,\n];\n\nexport function isSupportedLanguageMode(doc: vscode.TextDocument) {\n\treturn vscode.languages.match([typescript, typescriptreact, javascript, javascriptreact], doc) > 0;\n}\n\nexport function isTypeScriptDocument(doc: vscode.TextDocument) {\n\treturn vscode.languages.match([typescript, typescriptreact], doc) > 0;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport TypeScriptServiceClientHost from '../typeScriptServiceClientHost';\nimport { Lazy } from '../utils/lazy';\nimport { Command } from './commandManager';\n\nexport class OpenTsServerLogCommand implements Command {\n\tpublic readonly id = 'typescript.openTsServerLog';\n\n\tpublic constructor(\n\t\tprivate readonly lazyClientHost: Lazy<TypeScriptServiceClientHost>\n\t) { }\n\n\tpublic execute() {\n\t\tthis.lazyClientHost.value.serviceClient.openTsServerLogFile();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport TypeScriptServiceClientHost from '../typeScriptServiceClientHost';\nimport { Lazy } from '../utils/lazy';\nimport { Command } from './commandManager';\n\nexport class ReloadTypeScriptProjectsCommand implements Command {\n\tpublic readonly id = 'typescript.reloadProjects';\n\n\tpublic constructor(\n\t\tprivate readonly lazyClientHost: Lazy<TypeScriptServiceClientHost>\n\t) { }\n\n\tpublic execute() {\n\t\tthis.lazyClientHost.value.reloadProjects();\n\t}\n}\n\nexport class ReloadJavaScriptProjectsCommand implements Command {\n\tpublic readonly id = 'javascript.reloadProjects';\n\n\tpublic constructor(\n\t\tprivate readonly lazyClientHost: Lazy<TypeScriptServiceClientHost>\n\t) { }\n\n\tpublic execute() {\n\t\tthis.lazyClientHost.value.reloadProjects();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport TypeScriptServiceClientHost from '../typeScriptServiceClientHost';\nimport { Lazy } from '../utils/lazy';\nimport { Command } from './commandManager';\n\nexport class RestartTsServerCommand implements Command {\n\tpublic readonly id = 'typescript.restartTsServer';\n\n\tpublic constructor(\n\t\tprivate readonly lazyClientHost: Lazy<TypeScriptServiceClientHost>\n\t) { }\n\n\tpublic execute() {\n\t\tthis.lazyClientHost.value.serviceClient.restartTsServer();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport TypeScriptServiceClientHost from '../typeScriptServiceClientHost';\nimport { Lazy } from '../utils/lazy';\nimport { Command } from './commandManager';\n\nexport class SelectTypeScriptVersionCommand implements Command {\n\tpublic static readonly id = 'typescript.selectTypeScriptVersion';\n\tpublic readonly id = SelectTypeScriptVersionCommand.id;\n\n\tpublic constructor(\n\t\tprivate readonly lazyClientHost: Lazy<TypeScriptServiceClientHost>\n\t) { }\n\n\tpublic execute() {\n\t\tthis.lazyClientHost.value.serviceClient.showVersionPicker();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n/* --------------------------------------------------------------------------------------------\n * Includes code from typescript-sublime-plugin project, obtained from\n * https://github.com/microsoft/TypeScript-Sublime-Plugin/blob/master/TypeScript%20Indent.tmPreferences\n * ------------------------------------------------------------------------------------------ */\n\nimport * as vscode from 'vscode';\nimport { Disposable } from '../utils/dispose';\nimport * as languageModeIds from '../utils/languageModeIds';\n\nconst jsTsLanguageConfiguration: vscode.LanguageConfiguration = {\n\tindentationRules: {\n\t\tdecreaseIndentPattern: /^((?!.*?\\/\\*).*\\*\\/)?\\s*[\\}\\]].*$/,\n\t\tincreaseIndentPattern: /^((?!\\/\\/).)*(\\{([^}\"'`]*|(\\t|[ ])*\\/\\/.*)|\\([^)\"'`]*|\\[[^\\]\"'`]*)$/,\n\t\t// e.g.  * ...| or */| or *-----*/|\n\t\tunIndentedLinePattern: /^(\\t|[ ])*[ ]\\*[^/]*\\*\\/\\s*$|^(\\t|[ ])*[ ]\\*\\/\\s*$|^(\\t|[ ])*[ ]\\*([ ]([^\\*]|\\*(?!\\/))*)?$/\n\t},\n\twordPattern: /(-?\\d*\\.\\d\\w*)|([^\\`\\~\\!\\@\\%\\^\\&\\*\\(\\)\\-\\=\\+\\[\\{\\]\\}\\\\\\|\\;\\:\\'\\\"\\,\\.\\<\\>\\/\\?\\s]+)/g,\n\tonEnterRules: [\n\t\t{\n\t\t\t// e.g. /** | */\n\t\t\tbeforeText: /^\\s*\\/\\*\\*(?!\\/)([^\\*]|\\*(?!\\/))*$/,\n\t\t\tafterText: /^\\s*\\*\\/$/,\n\t\t\taction: { indentAction: vscode.IndentAction.IndentOutdent, appendText: ' * ' },\n\t\t}, {\n\t\t\t// e.g. /** ...|\n\t\t\tbeforeText: /^\\s*\\/\\*\\*(?!\\/)([^\\*]|\\*(?!\\/))*$/,\n\t\t\taction: { indentAction: vscode.IndentAction.None, appendText: ' * ' },\n\t\t}, {\n\t\t\t// e.g.  * ...|\n\t\t\tbeforeText: /^(\\t|[ ])*[ ]\\*([ ]([^\\*]|\\*(?!\\/))*)?$/,\n\t\t\tpreviousLineText: /(?=^(\\s*(\\/\\*\\*|\\*)).*)(?=(?!(\\s*\\*\\/)))/,\n\t\t\taction: { indentAction: vscode.IndentAction.None, appendText: '* ' },\n\t\t}, {\n\t\t\t// e.g.  */|\n\t\t\tbeforeText: /^(\\t|[ ])*[ ]\\*\\/\\s*$/,\n\t\t\taction: { indentAction: vscode.IndentAction.None, removeText: 1 },\n\t\t},\n\t\t{\n\t\t\t// e.g.  *-----*/|\n\t\t\tbeforeText: /^(\\t|[ ])*[ ]\\*[^/]*\\*\\/\\s*$/,\n\t\t\taction: { indentAction: vscode.IndentAction.None, removeText: 1 },\n\t\t},\n\t\t{\n\t\t\tbeforeText: /^\\s*(\\bcase\\s.+:|\\bdefault:)$/,\n\t\t\tafterText: /^(?!\\s*(\\bcase\\b|\\bdefault\\b))/,\n\t\t\taction: { indentAction: vscode.IndentAction.Indent },\n\t\t}\n\t]\n};\n\nconst EMPTY_ELEMENTS: string[] = ['area', 'base', 'br', 'col', 'embed', 'hr', 'img', 'input', 'keygen', 'link', 'menuitem', 'meta', 'param', 'source', 'track', 'wbr'];\n\nconst jsxTagsLanguageConfiguration: vscode.LanguageConfiguration = {\n\twordPattern: /(-?\\d*\\.\\d\\w*)|([^\\`\\~\\!\\@\\$\\^\\&\\*\\(\\)\\=\\+\\[\\{\\]\\}\\\\\\|\\;\\:\\'\\\"\\,\\.\\<\\>\\/\\s]+)/g,\n\tonEnterRules: [\n\t\t{\n\t\t\tbeforeText: new RegExp(`<(?!(?:${EMPTY_ELEMENTS.join('|')}))([_:\\\\w][_:\\\\w\\\\-.\\\\d]*)([^/>]*(?!/)>)[^<]*$`, 'i'),\n\t\t\tafterText: /^<\\/([_:\\w][_:\\w-.\\d]*)\\s*>$/i,\n\t\t\taction: { indentAction: vscode.IndentAction.IndentOutdent }\n\t\t},\n\t\t{\n\t\t\tbeforeText: new RegExp(`<(?!(?:${EMPTY_ELEMENTS.join('|')}))([_:\\\\w][_:\\\\w\\\\-.\\\\d]*)([^/>]*(?!/)>)[^<]*$`, 'i'),\n\t\t\taction: { indentAction: vscode.IndentAction.Indent }\n\t\t},\n\t\t{\n\t\t\t// `beforeText` only applies to tokens of a given language. Since we are dealing with jsx-tags,\n\t\t\t// make sure we apply to the closing `>` of a tag so that mixed language spans\n\t\t\t// such as `<div onclick={1}>` are handled properly.\n\t\t\tbeforeText: /^>$/,\n\t\t\tafterText: /^<\\/([_:\\w][_:\\w-.\\d]*)\\s*>$/i,\n\t\t\taction: { indentAction: vscode.IndentAction.IndentOutdent }\n\t\t},\n\t\t{\n\t\t\tbeforeText: /^>$/,\n\t\t\taction: { indentAction: vscode.IndentAction.Indent }\n\t\t},\n\t],\n};\n\nexport class LanguageConfigurationManager extends Disposable {\n\n\tconstructor() {\n\t\tsuper();\n\t\tconst standardLanguages = [\n\t\t\tlanguageModeIds.javascript,\n\t\t\tlanguageModeIds.javascriptreact,\n\t\t\tlanguageModeIds.typescript,\n\t\t\tlanguageModeIds.typescriptreact,\n\t\t];\n\t\tfor (const language of standardLanguages) {\n\t\t\tthis.registerConfiguration(language, jsTsLanguageConfiguration);\n\t\t}\n\n\t\tthis.registerConfiguration(languageModeIds.jsxTags, jsxTagsLanguageConfiguration);\n\t}\n\n\tprivate registerConfiguration(language: string, config: vscode.LanguageConfiguration) {\n\t\tthis._register(vscode.languages.setLanguageConfiguration(language, config));\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\n\nexport function disposeAll(disposables: vscode.Disposable[]) {\n\twhile (disposables.length) {\n\t\tconst item = disposables.pop();\n\t\tif (item) {\n\t\t\titem.dispose();\n\t\t}\n\t}\n}\n\nexport abstract class Disposable {\n\tprivate _isDisposed = false;\n\n\tprotected _disposables: vscode.Disposable[] = [];\n\n\tpublic dispose(): any {\n\t\tif (this._isDisposed) {\n\t\t\treturn;\n\t\t}\n\t\tthis._isDisposed = true;\n\t\tdisposeAll(this._disposables);\n\t}\n\n\tprotected _register<T extends vscode.Disposable>(value: T): T {\n\t\tif (this._isDisposed) {\n\t\t\tvalue.dispose();\n\t\t} else {\n\t\t\tthis._disposables.push(value);\n\t\t}\n\t\treturn value;\n\t}\n\n\tprotected get isDisposed() {\n\t\treturn this._isDisposed;\n\t}\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { CommandManager } from './commands/commandManager';\nimport { OngoingRequestCancellerFactory } from './tsServer/cancellation';\nimport { ILogDirectoryProvider } from './tsServer/logDirectoryProvider';\nimport { TsServerProcessFactory } from './tsServer/server';\nimport { ITypeScriptVersionProvider } from './tsServer/versionProvider';\nimport TypeScriptServiceClientHost from './typeScriptServiceClientHost';\nimport { ActiveJsTsEditorTracker } from './utils/activeJsTsEditorTracker';\nimport { flatten } from './utils/arrays';\nimport { ServiceConfigurationProvider } from './utils/configuration';\nimport * as fileSchemes from './utils/fileSchemes';\nimport { standardLanguageDescriptions } from './utils/languageDescription';\nimport { lazy, Lazy } from './utils/lazy';\nimport ManagedFileContextManager from './utils/managedFileContext';\nimport { PluginManager } from './utils/plugins';\n\nexport function createLazyClientHost(\n\tcontext: vscode.ExtensionContext,\n\tonCaseInsensitiveFileSystem: boolean,\n\tservices: {\n\t\tpluginManager: PluginManager,\n\t\tcommandManager: CommandManager,\n\t\tlogDirectoryProvider: ILogDirectoryProvider,\n\t\tcancellerFactory: OngoingRequestCancellerFactory,\n\t\tversionProvider: ITypeScriptVersionProvider,\n\t\tprocessFactory: TsServerProcessFactory,\n\t\tactiveJsTsEditorTracker: ActiveJsTsEditorTracker,\n\t\tserviceConfigurationProvider: ServiceConfigurationProvider,\n\t},\n\tonCompletionAccepted: (item: vscode.CompletionItem) => void,\n): Lazy<TypeScriptServiceClientHost> {\n\treturn lazy(() => {\n\t\tconst clientHost = new TypeScriptServiceClientHost(\n\t\t\tstandardLanguageDescriptions,\n\t\t\tcontext,\n\t\t\tonCaseInsensitiveFileSystem,\n\t\t\tservices,\n\t\t\tonCompletionAccepted);\n\n\t\tcontext.subscriptions.push(clientHost);\n\n\t\treturn clientHost;\n\t});\n}\n\nexport function lazilyActivateClient(\n\tlazyClientHost: Lazy<TypeScriptServiceClientHost>,\n\tpluginManager: PluginManager,\n\tactiveJsTsEditorTracker: ActiveJsTsEditorTracker,\n): vscode.Disposable {\n\tconst disposables: vscode.Disposable[] = [];\n\n\tconst supportedLanguage = flatten([\n\t\t...standardLanguageDescriptions.map(x => x.modeIds),\n\t\t...pluginManager.plugins.map(x => x.languages)\n\t]);\n\n\tlet hasActivated = false;\n\tconst maybeActivate = (textDocument: vscode.TextDocument): boolean => {\n\t\tif (!hasActivated && isSupportedDocument(supportedLanguage, textDocument)) {\n\t\t\thasActivated = true;\n\t\t\t// Force activation\n\t\t\tvoid lazyClientHost.value;\n\n\t\t\tdisposables.push(new ManagedFileContextManager(activeJsTsEditorTracker, resource => {\n\t\t\t\treturn lazyClientHost.value.serviceClient.toPath(resource);\n\t\t\t}));\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t};\n\n\tconst didActivate = vscode.workspace.textDocuments.some(maybeActivate);\n\tif (!didActivate) {\n\t\tconst openListener = vscode.workspace.onDidOpenTextDocument(doc => {\n\t\t\tif (maybeActivate(doc)) {\n\t\t\t\topenListener.dispose();\n\t\t\t}\n\t\t}, undefined, disposables);\n\t}\n\n\treturn vscode.Disposable.from(...disposables);\n}\n\nfunction isSupportedDocument(\n\tsupportedLanguage: readonly string[],\n\tdocument: vscode.TextDocument\n): boolean {\n\treturn supportedLanguage.indexOf(document.languageId) >= 0\n\t\t&& !fileSchemes.disabledSchemes.has(document.uri.scheme);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n/* --------------------------------------------------------------------------------------------\n * Includes code from typescript-sublime-plugin project, obtained from\n * https://github.com/microsoft/TypeScript-Sublime-Plugin/blob/master/TypeScript%20Indent.tmPreferences\n * ------------------------------------------------------------------------------------------ */\n\nimport * as vscode from 'vscode';\nimport { CommandManager } from './commands/commandManager';\nimport { DiagnosticKind } from './languageFeatures/diagnostics';\nimport FileConfigurationManager from './languageFeatures/fileConfigurationManager';\nimport LanguageProvider from './languageProvider';\nimport * as Proto from './protocol';\nimport * as PConst from './protocol.const';\nimport { OngoingRequestCancellerFactory } from './tsServer/cancellation';\nimport { ILogDirectoryProvider } from './tsServer/logDirectoryProvider';\nimport { TsServerProcessFactory } from './tsServer/server';\nimport { ITypeScriptVersionProvider } from './tsServer/versionProvider';\nimport TypeScriptServiceClient from './typescriptServiceClient';\nimport { IntellisenseStatus } from './ui/intellisenseStatus';\nimport { VersionStatus } from './ui/versionStatus';\nimport { ActiveJsTsEditorTracker } from './utils/activeJsTsEditorTracker';\nimport { coalesce, flatten } from './utils/arrays';\nimport { ServiceConfigurationProvider } from './utils/configuration';\nimport { Disposable } from './utils/dispose';\nimport * as errorCodes from './utils/errorCodes';\nimport { DiagnosticLanguage, LanguageDescription } from './utils/languageDescription';\nimport * as LargeProjectStatus from './utils/largeProjectStatus';\nimport { LogLevelMonitor } from './utils/logLevelMonitor';\nimport { PluginManager } from './utils/plugins';\nimport * as typeConverters from './utils/typeConverters';\nimport TypingsStatus, { AtaProgressReporter } from './utils/typingsStatus';\n\n// Style check diagnostics that can be reported as warnings\nconst styleCheckDiagnostics = new Set([\n\t...errorCodes.variableDeclaredButNeverUsed,\n\t...errorCodes.propertyDeclaretedButNeverUsed,\n\t...errorCodes.allImportsAreUnused,\n\t...errorCodes.unreachableCode,\n\t...errorCodes.unusedLabel,\n\t...errorCodes.fallThroughCaseInSwitch,\n\t...errorCodes.notAllCodePathsReturnAValue,\n]);\n\nexport default class TypeScriptServiceClientHost extends Disposable {\n\n\tprivate readonly client: TypeScriptServiceClient;\n\tprivate readonly languages: LanguageProvider[] = [];\n\tprivate readonly languagePerId = new Map<string, LanguageProvider>();\n\n\tprivate readonly typingsStatus: TypingsStatus;\n\n\tprivate readonly fileConfigurationManager: FileConfigurationManager;\n\n\tprivate reportStyleCheckAsWarnings: boolean = true;\n\n\tprivate readonly commandManager: CommandManager;\n\n\tconstructor(\n\t\tdescriptions: LanguageDescription[],\n\t\tcontext: vscode.ExtensionContext,\n\t\tonCaseInsenitiveFileSystem: boolean,\n\t\tservices: {\n\t\t\tpluginManager: PluginManager,\n\t\t\tcommandManager: CommandManager,\n\t\t\tlogDirectoryProvider: ILogDirectoryProvider,\n\t\t\tcancellerFactory: OngoingRequestCancellerFactory,\n\t\t\tversionProvider: ITypeScriptVersionProvider,\n\t\t\tprocessFactory: TsServerProcessFactory,\n\t\t\tactiveJsTsEditorTracker: ActiveJsTsEditorTracker,\n\t\t\tserviceConfigurationProvider: ServiceConfigurationProvider,\n\t\t},\n\t\tonCompletionAccepted: (item: vscode.CompletionItem) => void,\n\t) {\n\t\tsuper();\n\n\t\tthis.commandManager = services.commandManager;\n\n\t\tconst allModeIds = this.getAllModeIds(descriptions, services.pluginManager);\n\t\tthis.client = this._register(new TypeScriptServiceClient(\n\t\t\tcontext,\n\t\t\tonCaseInsenitiveFileSystem,\n\t\t\tservices,\n\t\t\tallModeIds));\n\n\t\tthis.client.onDiagnosticsReceived(({ kind, resource, diagnostics }) => {\n\t\t\tthis.diagnosticsReceived(kind, resource, diagnostics);\n\t\t}, null, this._disposables);\n\n\t\tthis.client.onConfigDiagnosticsReceived(diag => this.configFileDiagnosticsReceived(diag), null, this._disposables);\n\t\tthis.client.onResendModelsRequested(() => this.populateService(), null, this._disposables);\n\n\t\tthis._register(new VersionStatus(this.client));\n\t\tthis._register(new IntellisenseStatus(this.client, services.commandManager, services.activeJsTsEditorTracker));\n\t\tthis._register(new AtaProgressReporter(this.client));\n\t\tthis.typingsStatus = this._register(new TypingsStatus(this.client));\n\t\tthis._register(LargeProjectStatus.create(this.client));\n\n\t\tthis.fileConfigurationManager = this._register(new FileConfigurationManager(this.client, onCaseInsenitiveFileSystem));\n\n\t\tfor (const description of descriptions) {\n\t\t\tconst manager = new LanguageProvider(this.client, description, this.commandManager, this.client.telemetryReporter, this.typingsStatus, this.fileConfigurationManager, onCompletionAccepted);\n\t\t\tthis.languages.push(manager);\n\t\t\tthis._register(manager);\n\t\t\tthis.languagePerId.set(description.id, manager);\n\t\t}\n\n\t\timport('./languageFeatures/updatePathsOnRename').then(module =>\n\t\t\tthis._register(module.register(this.client, this.fileConfigurationManager, uri => this.handles(uri))));\n\n\t\timport('./languageFeatures/workspaceSymbols').then(module =>\n\t\t\tthis._register(module.register(this.client, allModeIds)));\n\n\t\tthis.client.ensureServiceStarted();\n\t\tthis.client.onReady(() => {\n\t\t\tconst languages = new Set<string>();\n\t\t\tfor (const plugin of services.pluginManager.plugins) {\n\t\t\t\tif (plugin.configNamespace && plugin.languages.length) {\n\t\t\t\t\tthis.registerExtensionLanguageProvider({\n\t\t\t\t\t\tid: plugin.configNamespace,\n\t\t\t\t\t\tmodeIds: Array.from(plugin.languages),\n\t\t\t\t\t\tdiagnosticSource: 'ts-plugin',\n\t\t\t\t\t\tdiagnosticLanguage: DiagnosticLanguage.TypeScript,\n\t\t\t\t\t\tdiagnosticOwner: 'typescript',\n\t\t\t\t\t\tisExternal: true,\n\t\t\t\t\t\tstandardFileExtensions: [],\n\t\t\t\t\t}, onCompletionAccepted);\n\t\t\t\t} else {\n\t\t\t\t\tfor (const language of plugin.languages) {\n\t\t\t\t\t\tlanguages.add(language);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (languages.size) {\n\t\t\t\tthis.registerExtensionLanguageProvider({\n\t\t\t\t\tid: 'typescript-plugins',\n\t\t\t\t\tmodeIds: Array.from(languages.values()),\n\t\t\t\t\tdiagnosticSource: 'ts-plugin',\n\t\t\t\t\tdiagnosticLanguage: DiagnosticLanguage.TypeScript,\n\t\t\t\t\tdiagnosticOwner: 'typescript',\n\t\t\t\t\tisExternal: true,\n\t\t\t\t\tstandardFileExtensions: [],\n\t\t\t\t}, onCompletionAccepted);\n\t\t\t}\n\t\t});\n\n\t\tthis.client.onTsServerStarted(() => {\n\t\t\tthis.triggerAllDiagnostics();\n\t\t});\n\n\t\tvscode.workspace.onDidChangeConfiguration(this.configurationChanged, this, this._disposables);\n\t\tthis.configurationChanged();\n\t\tthis._register(new LogLevelMonitor(context));\n\t}\n\n\tprivate registerExtensionLanguageProvider(description: LanguageDescription, onCompletionAccepted: (item: vscode.CompletionItem) => void) {\n\t\tconst manager = new LanguageProvider(this.client, description, this.commandManager, this.client.telemetryReporter, this.typingsStatus, this.fileConfigurationManager, onCompletionAccepted);\n\t\tthis.languages.push(manager);\n\t\tthis._register(manager);\n\t\tthis.languagePerId.set(description.id, manager);\n\t}\n\n\tprivate getAllModeIds(descriptions: LanguageDescription[], pluginManager: PluginManager) {\n\t\tconst allModeIds = flatten([\n\t\t\t...descriptions.map(x => x.modeIds),\n\t\t\t...pluginManager.plugins.map(x => x.languages)\n\t\t]);\n\t\treturn allModeIds;\n\t}\n\n\tpublic get serviceClient(): TypeScriptServiceClient {\n\t\treturn this.client;\n\t}\n\n\tpublic reloadProjects(): void {\n\t\tthis.client.executeWithoutWaitingForResponse('reloadProjects', null);\n\t\tthis.triggerAllDiagnostics();\n\t}\n\n\tpublic async handles(resource: vscode.Uri): Promise<boolean> {\n\t\tconst provider = await this.findLanguage(resource);\n\t\tif (provider) {\n\t\t\treturn true;\n\t\t}\n\t\treturn this.client.bufferSyncSupport.handles(resource);\n\t}\n\n\tprivate configurationChanged(): void {\n\t\tconst typescriptConfig = vscode.workspace.getConfiguration('typescript');\n\n\t\tthis.reportStyleCheckAsWarnings = typescriptConfig.get('reportStyleChecksAsWarnings', true);\n\t}\n\n\tprivate async findLanguage(resource: vscode.Uri): Promise<LanguageProvider | undefined> {\n\t\ttry {\n\t\t\t// First try finding language just based on the resource.\n\t\t\t// This is not strictly correct but should be in the vast majority of cases\n\t\t\t// (except when someone goes and maps `.js` to `typescript` or something...)\n\t\t\tfor (const language of this.languages) {\n\t\t\t\tif (language.handlesUri(resource)) {\n\t\t\t\t\treturn language;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If that doesn't work, fallback to using a text document language mode.\n\t\t\t// This is not ideal since we have to open the document but should always\n\t\t\t// be correct\n\t\t\tconst doc = await vscode.workspace.openTextDocument(resource);\n\t\t\treturn this.languages.find(language => language.handlesDocument(doc));\n\t\t} catch {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tprivate triggerAllDiagnostics() {\n\t\tfor (const language of this.languagePerId.values()) {\n\t\t\tlanguage.triggerAllDiagnostics();\n\t\t}\n\t}\n\n\tprivate populateService(): void {\n\t\tthis.fileConfigurationManager.reset();\n\n\t\tfor (const language of this.languagePerId.values()) {\n\t\t\tlanguage.reInitialize();\n\t\t}\n\t}\n\n\tprivate async diagnosticsReceived(\n\t\tkind: DiagnosticKind,\n\t\tresource: vscode.Uri,\n\t\tdiagnostics: Proto.Diagnostic[]\n\t): Promise<void> {\n\t\tconst language = await this.findLanguage(resource);\n\t\tif (language) {\n\t\t\tlanguage.diagnosticsReceived(\n\t\t\t\tkind,\n\t\t\t\tresource,\n\t\t\t\tthis.createMarkerDatas(diagnostics, language.diagnosticSource));\n\t\t}\n\t}\n\n\tprivate configFileDiagnosticsReceived(event: Proto.ConfigFileDiagnosticEvent): void {\n\t\t// See https://github.com/microsoft/TypeScript/issues/10384\n\t\tconst body = event.body;\n\t\tif (!body || !body.diagnostics || !body.configFile) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.findLanguage(this.client.toResource(body.configFile)).then(language => {\n\t\t\tif (!language) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlanguage.configFileDiagnosticsReceived(this.client.toResource(body.configFile), body.diagnostics.map(tsDiag => {\n\t\t\t\tconst range = tsDiag.start && tsDiag.end ? typeConverters.Range.fromTextSpan(tsDiag) : new vscode.Range(0, 0, 0, 1);\n\t\t\t\tconst diagnostic = new vscode.Diagnostic(range, body.diagnostics[0].text, this.getDiagnosticSeverity(tsDiag));\n\t\t\t\tdiagnostic.source = language.diagnosticSource;\n\t\t\t\treturn diagnostic;\n\t\t\t}));\n\t\t});\n\t}\n\n\tprivate createMarkerDatas(\n\t\tdiagnostics: Proto.Diagnostic[],\n\t\tsource: string\n\t): (vscode.Diagnostic & { reportUnnecessary: any, reportDeprecated: any })[] {\n\t\treturn diagnostics.map(tsDiag => this.tsDiagnosticToVsDiagnostic(tsDiag, source));\n\t}\n\n\tprivate tsDiagnosticToVsDiagnostic(diagnostic: Proto.Diagnostic, source: string): vscode.Diagnostic & { reportUnnecessary: any, reportDeprecated: any } {\n\t\tconst { start, end, text } = diagnostic;\n\t\tconst range = new vscode.Range(typeConverters.Position.fromLocation(start), typeConverters.Position.fromLocation(end));\n\t\tconst converted = new vscode.Diagnostic(range, text, this.getDiagnosticSeverity(diagnostic));\n\t\tconverted.source = diagnostic.source || source;\n\t\tif (diagnostic.code) {\n\t\t\tconverted.code = diagnostic.code;\n\t\t}\n\t\tconst relatedInformation = diagnostic.relatedInformation;\n\t\tif (relatedInformation) {\n\t\t\tconverted.relatedInformation = coalesce(relatedInformation.map((info: any) => {\n\t\t\t\tconst span = info.span;\n\t\t\t\tif (!span) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\treturn new vscode.DiagnosticRelatedInformation(typeConverters.Location.fromTextSpan(this.client.toResource(span.file), span), info.message);\n\t\t\t}));\n\t\t}\n\t\tconst tags: vscode.DiagnosticTag[] = [];\n\t\tif (diagnostic.reportsUnnecessary) {\n\t\t\ttags.push(vscode.DiagnosticTag.Unnecessary);\n\t\t}\n\t\tif (diagnostic.reportsDeprecated) {\n\t\t\ttags.push(vscode.DiagnosticTag.Deprecated);\n\t\t}\n\t\tconverted.tags = tags.length ? tags : undefined;\n\n\t\tconst resultConverted = converted as vscode.Diagnostic & { reportUnnecessary: any, reportDeprecated: any };\n\t\tresultConverted.reportUnnecessary = diagnostic.reportsUnnecessary;\n\t\tresultConverted.reportDeprecated = diagnostic.reportsDeprecated;\n\t\treturn resultConverted;\n\t}\n\n\tprivate getDiagnosticSeverity(diagnostic: Proto.Diagnostic): vscode.DiagnosticSeverity {\n\t\tif (this.reportStyleCheckAsWarnings\n\t\t\t&& this.isStyleCheckDiagnostic(diagnostic.code)\n\t\t\t&& diagnostic.category === PConst.DiagnosticCategory.error\n\t\t) {\n\t\t\treturn vscode.DiagnosticSeverity.Warning;\n\t\t}\n\n\t\tswitch (diagnostic.category) {\n\t\t\tcase PConst.DiagnosticCategory.error:\n\t\t\t\treturn vscode.DiagnosticSeverity.Error;\n\n\t\t\tcase PConst.DiagnosticCategory.warning:\n\t\t\t\treturn vscode.DiagnosticSeverity.Warning;\n\n\t\t\tcase PConst.DiagnosticCategory.suggestion:\n\t\t\t\treturn vscode.DiagnosticSeverity.Hint;\n\n\t\t\tdefault:\n\t\t\t\treturn vscode.DiagnosticSeverity.Error;\n\t\t}\n\t}\n\n\tprivate isStyleCheckDiagnostic(code: number | undefined): boolean {\n\t\treturn typeof code === 'number' && styleCheckDiagnostics.has(code);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../protocol';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport API from '../utils/api';\nimport { Disposable } from '../utils/dispose';\nimport * as fileSchemes from '../utils/fileSchemes';\nimport { isTypeScriptDocument } from '../utils/languageModeIds';\nimport { equals } from '../utils/objects';\nimport { ResourceMap } from '../utils/resourceMap';\n\nnamespace ExperimentalProto {\n\texport interface UserPreferences extends Proto.UserPreferences {\n\t\tdisplayPartsForJSDoc: true\n\n\t\tincludeInlayParameterNameHints?: 'none' | 'literals' | 'all';\n\t\tincludeInlayParameterNameHintsWhenArgumentMatchesName?: boolean;\n\t\tincludeInlayFunctionParameterTypeHints?: boolean;\n\t\tincludeInlayVariableTypeHints?: boolean;\n\t\tincludeInlayPropertyDeclarationTypeHints?: boolean;\n\t\tincludeInlayFunctionLikeReturnTypeHints?: boolean;\n\t\tincludeInlayEnumMemberValueHints?: boolean;\n\t}\n}\n\ninterface FileConfiguration {\n\treadonly formatOptions: Proto.FormatCodeSettings;\n\treadonly preferences: Proto.UserPreferences;\n}\n\nfunction areFileConfigurationsEqual(a: FileConfiguration, b: FileConfiguration): boolean {\n\treturn equals(a, b);\n}\n\nexport default class FileConfigurationManager extends Disposable {\n\tprivate readonly formatOptions: ResourceMap<Promise<FileConfiguration | undefined>>;\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tonCaseInsensitiveFileSystem: boolean\n\t) {\n\t\tsuper();\n\t\tthis.formatOptions = new ResourceMap(undefined, { onCaseInsensitiveFileSystem });\n\t\tvscode.workspace.onDidCloseTextDocument(textDocument => {\n\t\t\t// When a document gets closed delete the cached formatting options.\n\t\t\t// This is necessary since the tsserver now closed a project when its\n\t\t\t// last file in it closes which drops the stored formatting options\n\t\t\t// as well.\n\t\t\tthis.formatOptions.delete(textDocument.uri);\n\t\t}, undefined, this._disposables);\n\t}\n\n\tpublic async ensureConfigurationForDocument(\n\t\tdocument: vscode.TextDocument,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<void> {\n\t\tconst formattingOptions = this.getFormattingOptions(document);\n\t\tif (formattingOptions) {\n\t\t\treturn this.ensureConfigurationOptions(document, formattingOptions, token);\n\t\t}\n\t}\n\n\tprivate getFormattingOptions(\n\t\tdocument: vscode.TextDocument\n\t): vscode.FormattingOptions | undefined {\n\t\tconst editor = vscode.window.visibleTextEditors.find(editor => editor.document.fileName === document.fileName);\n\t\treturn editor\n\t\t\t? {\n\t\t\t\ttabSize: editor.options.tabSize,\n\t\t\t\tinsertSpaces: editor.options.insertSpaces\n\t\t\t} as vscode.FormattingOptions\n\t\t\t: undefined;\n\t}\n\n\tpublic async ensureConfigurationOptions(\n\t\tdocument: vscode.TextDocument,\n\t\toptions: vscode.FormattingOptions,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<void> {\n\t\tconst file = this.client.toOpenedFilePath(document);\n\t\tif (!file) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentOptions = this.getFileOptions(document, options);\n\t\tconst cachedOptions = this.formatOptions.get(document.uri);\n\t\tif (cachedOptions) {\n\t\t\tconst cachedOptionsValue = await cachedOptions;\n\t\t\tif (cachedOptionsValue && areFileConfigurationsEqual(cachedOptionsValue, currentOptions)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tlet resolve: (x: FileConfiguration | undefined) => void;\n\t\tthis.formatOptions.set(document.uri, new Promise<FileConfiguration | undefined>(r => resolve = r));\n\n\t\tconst args: Proto.ConfigureRequestArguments = {\n\t\t\tfile,\n\t\t\t...currentOptions,\n\t\t};\n\t\ttry {\n\t\t\tconst response = await this.client.execute('configure', args, token);\n\t\t\tresolve!(response.type === 'response' ? currentOptions : undefined);\n\t\t} finally {\n\t\t\tresolve!(undefined);\n\t\t}\n\t}\n\n\tpublic async setGlobalConfigurationFromDocument(\n\t\tdocument: vscode.TextDocument,\n\t\ttoken: vscode.CancellationToken,\n\t): Promise<void> {\n\t\tconst formattingOptions = this.getFormattingOptions(document);\n\t\tif (!formattingOptions) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst args: Proto.ConfigureRequestArguments = {\n\t\t\tfile: undefined /*global*/,\n\t\t\t...this.getFileOptions(document, formattingOptions),\n\t\t};\n\t\tawait this.client.execute('configure', args, token);\n\t}\n\n\tpublic reset() {\n\t\tthis.formatOptions.clear();\n\t}\n\n\tprivate getFileOptions(\n\t\tdocument: vscode.TextDocument,\n\t\toptions: vscode.FormattingOptions\n\t): FileConfiguration {\n\t\treturn {\n\t\t\tformatOptions: this.getFormatOptions(document, options),\n\t\t\tpreferences: this.getPreferences(document)\n\t\t};\n\t}\n\n\tprivate getFormatOptions(\n\t\tdocument: vscode.TextDocument,\n\t\toptions: vscode.FormattingOptions\n\t): Proto.FormatCodeSettings {\n\t\tconst config = vscode.workspace.getConfiguration(\n\t\t\tisTypeScriptDocument(document) ? 'typescript.format' : 'javascript.format',\n\t\t\tdocument.uri);\n\n\t\treturn {\n\t\t\ttabSize: options.tabSize,\n\t\t\tindentSize: options.tabSize,\n\t\t\tconvertTabsToSpaces: options.insertSpaces,\n\t\t\t// We can use \\n here since the editor normalizes later on to its line endings.\n\t\t\tnewLineCharacter: '\\n',\n\t\t\tinsertSpaceAfterCommaDelimiter: config.get<boolean>('insertSpaceAfterCommaDelimiter'),\n\t\t\tinsertSpaceAfterConstructor: config.get<boolean>('insertSpaceAfterConstructor'),\n\t\t\tinsertSpaceAfterSemicolonInForStatements: config.get<boolean>('insertSpaceAfterSemicolonInForStatements'),\n\t\t\tinsertSpaceBeforeAndAfterBinaryOperators: config.get<boolean>('insertSpaceBeforeAndAfterBinaryOperators'),\n\t\t\tinsertSpaceAfterKeywordsInControlFlowStatements: config.get<boolean>('insertSpaceAfterKeywordsInControlFlowStatements'),\n\t\t\tinsertSpaceAfterFunctionKeywordForAnonymousFunctions: config.get<boolean>('insertSpaceAfterFunctionKeywordForAnonymousFunctions'),\n\t\t\tinsertSpaceBeforeFunctionParenthesis: config.get<boolean>('insertSpaceBeforeFunctionParenthesis'),\n\t\t\tinsertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis: config.get<boolean>('insertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis'),\n\t\t\tinsertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets: config.get<boolean>('insertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets'),\n\t\t\tinsertSpaceAfterOpeningAndBeforeClosingNonemptyBraces: config.get<boolean>('insertSpaceAfterOpeningAndBeforeClosingNonemptyBraces'),\n\t\t\tinsertSpaceAfterOpeningAndBeforeClosingEmptyBraces: config.get<boolean>('insertSpaceAfterOpeningAndBeforeClosingEmptyBraces'),\n\t\t\tinsertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces: config.get<boolean>('insertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces'),\n\t\t\tinsertSpaceAfterOpeningAndBeforeClosingJsxExpressionBraces: config.get<boolean>('insertSpaceAfterOpeningAndBeforeClosingJsxExpressionBraces'),\n\t\t\tinsertSpaceAfterTypeAssertion: config.get<boolean>('insertSpaceAfterTypeAssertion'),\n\t\t\tplaceOpenBraceOnNewLineForFunctions: config.get<boolean>('placeOpenBraceOnNewLineForFunctions'),\n\t\t\tplaceOpenBraceOnNewLineForControlBlocks: config.get<boolean>('placeOpenBraceOnNewLineForControlBlocks'),\n\t\t\tsemicolons: config.get<Proto.SemicolonPreference>('semicolons'),\n\t\t};\n\t}\n\n\tprivate getPreferences(document: vscode.TextDocument): Proto.UserPreferences {\n\t\tif (this.client.apiVersion.lt(API.v290)) {\n\t\t\treturn {};\n\t\t}\n\n\t\tconst config = vscode.workspace.getConfiguration(\n\t\t\tisTypeScriptDocument(document) ? 'typescript' : 'javascript',\n\t\t\tdocument.uri);\n\n\t\tconst preferencesConfig = vscode.workspace.getConfiguration(\n\t\t\tisTypeScriptDocument(document) ? 'typescript.preferences' : 'javascript.preferences',\n\t\t\tdocument.uri);\n\n\t\tconst preferences: ExperimentalProto.UserPreferences = {\n\t\t\tquotePreference: this.getQuoteStylePreference(preferencesConfig),\n\t\t\timportModuleSpecifierPreference: getImportModuleSpecifierPreference(preferencesConfig),\n\t\t\timportModuleSpecifierEnding: getImportModuleSpecifierEndingPreference(preferencesConfig),\n\t\t\t// @ts-expect-error until TS 4.5 protocol update\n\t\t\tjsxAttributeCompletionStyle: getJsxAttributeCompletionStyle(preferencesConfig),\n\t\t\tallowTextChangesInNewFiles: document.uri.scheme === fileSchemes.file,\n\t\t\tprovidePrefixAndSuffixTextForRename: preferencesConfig.get<boolean>('renameShorthandProperties', true) === false ? false : preferencesConfig.get<boolean>('useAliasesForRenames', true),\n\t\t\tallowRenameOfImportPath: true,\n\t\t\tincludeAutomaticOptionalChainCompletions: config.get<boolean>('suggest.includeAutomaticOptionalChainCompletions', true),\n\t\t\tprovideRefactorNotApplicableReason: true,\n\t\t\tgenerateReturnInDocTemplate: config.get<boolean>('suggest.jsdoc.generateReturns', true),\n\t\t\tincludeCompletionsForImportStatements: config.get<boolean>('suggest.includeCompletionsForImportStatements', true),\n\t\t\tincludeCompletionsWithSnippetText: config.get<boolean>('suggest.includeCompletionsWithSnippetText', true),\n\t\t\tallowIncompleteCompletions: true,\n\t\t\tdisplayPartsForJSDoc: true,\n\t\t\t...getInlayHintsPreferences(config),\n\t\t};\n\n\t\treturn preferences;\n\t}\n\n\tprivate getQuoteStylePreference(config: vscode.WorkspaceConfiguration) {\n\t\tswitch (config.get<string>('quoteStyle')) {\n\t\t\tcase 'single': return 'single';\n\t\t\tcase 'double': return 'double';\n\t\t\tdefault: return this.client.apiVersion.gte(API.v333) ? 'auto' : undefined;\n\t\t}\n\t}\n}\n\nexport class InlayHintSettingNames {\n\tstatic readonly parameterNamesSuppressWhenArgumentMatchesName = 'inlayHints.parameterNames.suppressWhenArgumentMatchesName';\n\tstatic readonly parameterNamesEnabled = 'inlayHints.parameterTypes.enabled';\n\tstatic readonly variableTypesEnabled = 'inlayHints.variableTypes.enabled';\n\tstatic readonly propertyDeclarationTypesEnabled = 'inlayHints.propertyDeclarationTypes.enabled';\n\tstatic readonly functionLikeReturnTypesEnabled = 'inlayHints.functionLikeReturnTypes.enabled';\n\tstatic readonly enumMemberValuesEnabled = 'inlayHints.enumMemberValues.enabled';\n}\n\nexport function getInlayHintsPreferences(config: vscode.WorkspaceConfiguration) {\n\treturn {\n\t\tincludeInlayParameterNameHints: getInlayParameterNameHintsPreference(config),\n\t\tincludeInlayParameterNameHintsWhenArgumentMatchesName: !config.get<boolean>(InlayHintSettingNames.parameterNamesSuppressWhenArgumentMatchesName, true),\n\t\tincludeInlayFunctionParameterTypeHints: config.get<boolean>(InlayHintSettingNames.parameterNamesEnabled, false),\n\t\tincludeInlayVariableTypeHints: config.get<boolean>(InlayHintSettingNames.variableTypesEnabled, false),\n\t\tincludeInlayPropertyDeclarationTypeHints: config.get<boolean>(InlayHintSettingNames.propertyDeclarationTypesEnabled, false),\n\t\tincludeInlayFunctionLikeReturnTypeHints: config.get<boolean>(InlayHintSettingNames.functionLikeReturnTypesEnabled, false),\n\t\tincludeInlayEnumMemberValueHints: config.get<boolean>(InlayHintSettingNames.enumMemberValuesEnabled, false),\n\t} as const;\n}\n\nfunction getInlayParameterNameHintsPreference(config: vscode.WorkspaceConfiguration) {\n\tswitch (config.get<string>('inlayHints.parameterNames.enabled')) {\n\t\tcase 'none': return 'none';\n\t\tcase 'literals': return 'literals';\n\t\tcase 'all': return 'all';\n\t\tdefault: return undefined;\n\t}\n}\n\nfunction getImportModuleSpecifierPreference(config: vscode.WorkspaceConfiguration) {\n\tswitch (config.get<string>('importModuleSpecifier')) {\n\t\tcase 'project-relative': return 'project-relative';\n\t\tcase 'relative': return 'relative';\n\t\tcase 'non-relative': return 'non-relative';\n\t\tdefault: return undefined;\n\t}\n}\n\nfunction getImportModuleSpecifierEndingPreference(config: vscode.WorkspaceConfiguration) {\n\tswitch (config.get<string>('importModuleSpecifierEnding')) {\n\t\tcase 'minimal': return 'minimal';\n\t\tcase 'index': return 'index';\n\t\tcase 'js': return 'js';\n\t\tdefault: return 'auto';\n\t}\n}\n\nfunction getJsxAttributeCompletionStyle(config: vscode.WorkspaceConfiguration) {\n\tswitch (config.get<string>('jsxAttributeCompletionStyle')) {\n\t\tcase 'braces': return 'braces';\n\t\tcase 'none': return 'none';\n\t\tdefault: return 'auto';\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as semver from 'semver';\nimport * as nls from 'vscode-nls';\n\nconst localize = nls.loadMessageBundle();\n\nexport default class API {\n\tpublic static fromSimpleString(value: string): API {\n\t\treturn new API(value, value, value);\n\t}\n\n\tpublic static readonly defaultVersion = API.fromSimpleString('1.0.0');\n\tpublic static readonly v240 = API.fromSimpleString('2.4.0');\n\tpublic static readonly v250 = API.fromSimpleString('2.5.0');\n\tpublic static readonly v260 = API.fromSimpleString('2.6.0');\n\tpublic static readonly v270 = API.fromSimpleString('2.7.0');\n\tpublic static readonly v280 = API.fromSimpleString('2.8.0');\n\tpublic static readonly v290 = API.fromSimpleString('2.9.0');\n\tpublic static readonly v291 = API.fromSimpleString('2.9.1');\n\tpublic static readonly v300 = API.fromSimpleString('3.0.0');\n\tpublic static readonly v310 = API.fromSimpleString('3.1.0');\n\tpublic static readonly v314 = API.fromSimpleString('3.1.4');\n\tpublic static readonly v320 = API.fromSimpleString('3.2.0');\n\tpublic static readonly v333 = API.fromSimpleString('3.3.3');\n\tpublic static readonly v340 = API.fromSimpleString('3.4.0');\n\tpublic static readonly v345 = API.fromSimpleString('3.4.5');\n\tpublic static readonly v350 = API.fromSimpleString('3.5.0');\n\tpublic static readonly v380 = API.fromSimpleString('3.8.0');\n\tpublic static readonly v381 = API.fromSimpleString('3.8.1');\n\tpublic static readonly v390 = API.fromSimpleString('3.9.0');\n\tpublic static readonly v400 = API.fromSimpleString('4.0.0');\n\tpublic static readonly v401 = API.fromSimpleString('4.0.1');\n\tpublic static readonly v420 = API.fromSimpleString('4.2.0');\n\tpublic static readonly v430 = API.fromSimpleString('4.3.0');\n\tpublic static readonly v440 = API.fromSimpleString('4.4.0');\n\n\tpublic static fromVersionString(versionString: string): API {\n\t\tlet version = semver.valid(versionString);\n\t\tif (!version) {\n\t\t\treturn new API(localize('invalidVersion', 'invalid version'), '1.0.0', '1.0.0');\n\t\t}\n\n\t\t// Cut off any prerelease tag since we sometimes consume those on purpose.\n\t\tconst index = versionString.indexOf('-');\n\t\tif (index >= 0) {\n\t\t\tversion = version.substr(0, index);\n\t\t}\n\t\treturn new API(versionString, version, versionString);\n\t}\n\n\tprivate constructor(\n\t\t/**\n\t\t * Human readable string for the current version. Displayed in the UI\n\t\t */\n\t\tpublic readonly displayName: string,\n\n\t\t/**\n\t\t * Semver version, e.g. '3.9.0'\n\t\t */\n\t\tpublic readonly version: string,\n\n\t\t/**\n\t\t * Full version string including pre-release tags, e.g. '3.9.0-beta'\n\t\t */\n\t\tpublic readonly fullVersionString: string,\n\t) { }\n\n\tpublic eq(other: API): boolean {\n\t\treturn semver.eq(this.version, other.version);\n\t}\n\n\tpublic gte(other: API): boolean {\n\t\treturn semver.gte(this.version, other.version);\n\t}\n\n\tpublic lt(other: API): boolean {\n\t\treturn !this.gte(other);\n\t}\n}\n","exports = module.exports = SemVer\n\nvar debug\n/* istanbul ignore next */\nif (typeof process === 'object' &&\n    process.env &&\n    process.env.NODE_DEBUG &&\n    /\\bsemver\\b/i.test(process.env.NODE_DEBUG)) {\n  debug = function () {\n    var args = Array.prototype.slice.call(arguments, 0)\n    args.unshift('SEMVER')\n    console.log.apply(console, args)\n  }\n} else {\n  debug = function () {}\n}\n\n// Note: this is the semver.org version of the spec that it implements\n// Not necessarily the package version of this code.\nexports.SEMVER_SPEC_VERSION = '2.0.0'\n\nvar MAX_LENGTH = 256\nvar MAX_SAFE_INTEGER = Number.MAX_SAFE_INTEGER ||\n  /* istanbul ignore next */ 9007199254740991\n\n// Max safe segment length for coercion.\nvar MAX_SAFE_COMPONENT_LENGTH = 16\n\n// The actual regexps go on exports.re\nvar re = exports.re = []\nvar src = exports.src = []\nvar R = 0\n\n// The following Regular Expressions can be used for tokenizing,\n// validating, and parsing SemVer version strings.\n\n// ## Numeric Identifier\n// A single `0`, or a non-zero digit followed by zero or more digits.\n\nvar NUMERICIDENTIFIER = R++\nsrc[NUMERICIDENTIFIER] = '0|[1-9]\\\\d*'\nvar NUMERICIDENTIFIERLOOSE = R++\nsrc[NUMERICIDENTIFIERLOOSE] = '[0-9]+'\n\n// ## Non-numeric Identifier\n// Zero or more digits, followed by a letter or hyphen, and then zero or\n// more letters, digits, or hyphens.\n\nvar NONNUMERICIDENTIFIER = R++\nsrc[NONNUMERICIDENTIFIER] = '\\\\d*[a-zA-Z-][a-zA-Z0-9-]*'\n\n// ## Main Version\n// Three dot-separated numeric identifiers.\n\nvar MAINVERSION = R++\nsrc[MAINVERSION] = '(' + src[NUMERICIDENTIFIER] + ')\\\\.' +\n                   '(' + src[NUMERICIDENTIFIER] + ')\\\\.' +\n                   '(' + src[NUMERICIDENTIFIER] + ')'\n\nvar MAINVERSIONLOOSE = R++\nsrc[MAINVERSIONLOOSE] = '(' + src[NUMERICIDENTIFIERLOOSE] + ')\\\\.' +\n                        '(' + src[NUMERICIDENTIFIERLOOSE] + ')\\\\.' +\n                        '(' + src[NUMERICIDENTIFIERLOOSE] + ')'\n\n// ## Pre-release Version Identifier\n// A numeric identifier, or a non-numeric identifier.\n\nvar PRERELEASEIDENTIFIER = R++\nsrc[PRERELEASEIDENTIFIER] = '(?:' + src[NUMERICIDENTIFIER] +\n                            '|' + src[NONNUMERICIDENTIFIER] + ')'\n\nvar PRERELEASEIDENTIFIERLOOSE = R++\nsrc[PRERELEASEIDENTIFIERLOOSE] = '(?:' + src[NUMERICIDENTIFIERLOOSE] +\n                                 '|' + src[NONNUMERICIDENTIFIER] + ')'\n\n// ## Pre-release Version\n// Hyphen, followed by one or more dot-separated pre-release version\n// identifiers.\n\nvar PRERELEASE = R++\nsrc[PRERELEASE] = '(?:-(' + src[PRERELEASEIDENTIFIER] +\n                  '(?:\\\\.' + src[PRERELEASEIDENTIFIER] + ')*))'\n\nvar PRERELEASELOOSE = R++\nsrc[PRERELEASELOOSE] = '(?:-?(' + src[PRERELEASEIDENTIFIERLOOSE] +\n                       '(?:\\\\.' + src[PRERELEASEIDENTIFIERLOOSE] + ')*))'\n\n// ## Build Metadata Identifier\n// Any combination of digits, letters, or hyphens.\n\nvar BUILDIDENTIFIER = R++\nsrc[BUILDIDENTIFIER] = '[0-9A-Za-z-]+'\n\n// ## Build Metadata\n// Plus sign, followed by one or more period-separated build metadata\n// identifiers.\n\nvar BUILD = R++\nsrc[BUILD] = '(?:\\\\+(' + src[BUILDIDENTIFIER] +\n             '(?:\\\\.' + src[BUILDIDENTIFIER] + ')*))'\n\n// ## Full Version String\n// A main version, followed optionally by a pre-release version and\n// build metadata.\n\n// Note that the only major, minor, patch, and pre-release sections of\n// the version string are capturing groups.  The build metadata is not a\n// capturing group, because it should not ever be used in version\n// comparison.\n\nvar FULL = R++\nvar FULLPLAIN = 'v?' + src[MAINVERSION] +\n                src[PRERELEASE] + '?' +\n                src[BUILD] + '?'\n\nsrc[FULL] = '^' + FULLPLAIN + '$'\n\n// like full, but allows v1.2.3 and =1.2.3, which people do sometimes.\n// also, 1.0.0alpha1 (prerelease without the hyphen) which is pretty\n// common in the npm registry.\nvar LOOSEPLAIN = '[v=\\\\s]*' + src[MAINVERSIONLOOSE] +\n                 src[PRERELEASELOOSE] + '?' +\n                 src[BUILD] + '?'\n\nvar LOOSE = R++\nsrc[LOOSE] = '^' + LOOSEPLAIN + '$'\n\nvar GTLT = R++\nsrc[GTLT] = '((?:<|>)?=?)'\n\n// Something like \"2.*\" or \"1.2.x\".\n// Note that \"x.x\" is a valid xRange identifer, meaning \"any version\"\n// Only the first item is strictly required.\nvar XRANGEIDENTIFIERLOOSE = R++\nsrc[XRANGEIDENTIFIERLOOSE] = src[NUMERICIDENTIFIERLOOSE] + '|x|X|\\\\*'\nvar XRANGEIDENTIFIER = R++\nsrc[XRANGEIDENTIFIER] = src[NUMERICIDENTIFIER] + '|x|X|\\\\*'\n\nvar XRANGEPLAIN = R++\nsrc[XRANGEPLAIN] = '[v=\\\\s]*(' + src[XRANGEIDENTIFIER] + ')' +\n                   '(?:\\\\.(' + src[XRANGEIDENTIFIER] + ')' +\n                   '(?:\\\\.(' + src[XRANGEIDENTIFIER] + ')' +\n                   '(?:' + src[PRERELEASE] + ')?' +\n                   src[BUILD] + '?' +\n                   ')?)?'\n\nvar XRANGEPLAINLOOSE = R++\nsrc[XRANGEPLAINLOOSE] = '[v=\\\\s]*(' + src[XRANGEIDENTIFIERLOOSE] + ')' +\n                        '(?:\\\\.(' + src[XRANGEIDENTIFIERLOOSE] + ')' +\n                        '(?:\\\\.(' + src[XRANGEIDENTIFIERLOOSE] + ')' +\n                        '(?:' + src[PRERELEASELOOSE] + ')?' +\n                        src[BUILD] + '?' +\n                        ')?)?'\n\nvar XRANGE = R++\nsrc[XRANGE] = '^' + src[GTLT] + '\\\\s*' + src[XRANGEPLAIN] + '$'\nvar XRANGELOOSE = R++\nsrc[XRANGELOOSE] = '^' + src[GTLT] + '\\\\s*' + src[XRANGEPLAINLOOSE] + '$'\n\n// Coercion.\n// Extract anything that could conceivably be a part of a valid semver\nvar COERCE = R++\nsrc[COERCE] = '(?:^|[^\\\\d])' +\n              '(\\\\d{1,' + MAX_SAFE_COMPONENT_LENGTH + '})' +\n              '(?:\\\\.(\\\\d{1,' + MAX_SAFE_COMPONENT_LENGTH + '}))?' +\n              '(?:\\\\.(\\\\d{1,' + MAX_SAFE_COMPONENT_LENGTH + '}))?' +\n              '(?:$|[^\\\\d])'\n\n// Tilde ranges.\n// Meaning is \"reasonably at or greater than\"\nvar LONETILDE = R++\nsrc[LONETILDE] = '(?:~>?)'\n\nvar TILDETRIM = R++\nsrc[TILDETRIM] = '(\\\\s*)' + src[LONETILDE] + '\\\\s+'\nre[TILDETRIM] = new RegExp(src[TILDETRIM], 'g')\nvar tildeTrimReplace = '$1~'\n\nvar TILDE = R++\nsrc[TILDE] = '^' + src[LONETILDE] + src[XRANGEPLAIN] + '$'\nvar TILDELOOSE = R++\nsrc[TILDELOOSE] = '^' + src[LONETILDE] + src[XRANGEPLAINLOOSE] + '$'\n\n// Caret ranges.\n// Meaning is \"at least and backwards compatible with\"\nvar LONECARET = R++\nsrc[LONECARET] = '(?:\\\\^)'\n\nvar CARETTRIM = R++\nsrc[CARETTRIM] = '(\\\\s*)' + src[LONECARET] + '\\\\s+'\nre[CARETTRIM] = new RegExp(src[CARETTRIM], 'g')\nvar caretTrimReplace = '$1^'\n\nvar CARET = R++\nsrc[CARET] = '^' + src[LONECARET] + src[XRANGEPLAIN] + '$'\nvar CARETLOOSE = R++\nsrc[CARETLOOSE] = '^' + src[LONECARET] + src[XRANGEPLAINLOOSE] + '$'\n\n// A simple gt/lt/eq thing, or just \"\" to indicate \"any version\"\nvar COMPARATORLOOSE = R++\nsrc[COMPARATORLOOSE] = '^' + src[GTLT] + '\\\\s*(' + LOOSEPLAIN + ')$|^$'\nvar COMPARATOR = R++\nsrc[COMPARATOR] = '^' + src[GTLT] + '\\\\s*(' + FULLPLAIN + ')$|^$'\n\n// An expression to strip any whitespace between the gtlt and the thing\n// it modifies, so that `> 1.2.3` ==> `>1.2.3`\nvar COMPARATORTRIM = R++\nsrc[COMPARATORTRIM] = '(\\\\s*)' + src[GTLT] +\n                      '\\\\s*(' + LOOSEPLAIN + '|' + src[XRANGEPLAIN] + ')'\n\n// this one has to use the /g flag\nre[COMPARATORTRIM] = new RegExp(src[COMPARATORTRIM], 'g')\nvar comparatorTrimReplace = '$1$2$3'\n\n// Something like `1.2.3 - 1.2.4`\n// Note that these all use the loose form, because they'll be\n// checked against either the strict or loose comparator form\n// later.\nvar HYPHENRANGE = R++\nsrc[HYPHENRANGE] = '^\\\\s*(' + src[XRANGEPLAIN] + ')' +\n                   '\\\\s+-\\\\s+' +\n                   '(' + src[XRANGEPLAIN] + ')' +\n                   '\\\\s*$'\n\nvar HYPHENRANGELOOSE = R++\nsrc[HYPHENRANGELOOSE] = '^\\\\s*(' + src[XRANGEPLAINLOOSE] + ')' +\n                        '\\\\s+-\\\\s+' +\n                        '(' + src[XRANGEPLAINLOOSE] + ')' +\n                        '\\\\s*$'\n\n// Star ranges basically just allow anything at all.\nvar STAR = R++\nsrc[STAR] = '(<|>)?=?\\\\s*\\\\*'\n\n// Compile to actual regexp objects.\n// All are flag-free, unless they were created above with a flag.\nfor (var i = 0; i < R; i++) {\n  debug(i, src[i])\n  if (!re[i]) {\n    re[i] = new RegExp(src[i])\n  }\n}\n\nexports.parse = parse\nfunction parse (version, options) {\n  if (!options || typeof options !== 'object') {\n    options = {\n      loose: !!options,\n      includePrerelease: false\n    }\n  }\n\n  if (version instanceof SemVer) {\n    return version\n  }\n\n  if (typeof version !== 'string') {\n    return null\n  }\n\n  if (version.length > MAX_LENGTH) {\n    return null\n  }\n\n  var r = options.loose ? re[LOOSE] : re[FULL]\n  if (!r.test(version)) {\n    return null\n  }\n\n  try {\n    return new SemVer(version, options)\n  } catch (er) {\n    return null\n  }\n}\n\nexports.valid = valid\nfunction valid (version, options) {\n  var v = parse(version, options)\n  return v ? v.version : null\n}\n\nexports.clean = clean\nfunction clean (version, options) {\n  var s = parse(version.trim().replace(/^[=v]+/, ''), options)\n  return s ? s.version : null\n}\n\nexports.SemVer = SemVer\n\nfunction SemVer (version, options) {\n  if (!options || typeof options !== 'object') {\n    options = {\n      loose: !!options,\n      includePrerelease: false\n    }\n  }\n  if (version instanceof SemVer) {\n    if (version.loose === options.loose) {\n      return version\n    } else {\n      version = version.version\n    }\n  } else if (typeof version !== 'string') {\n    throw new TypeError('Invalid Version: ' + version)\n  }\n\n  if (version.length > MAX_LENGTH) {\n    throw new TypeError('version is longer than ' + MAX_LENGTH + ' characters')\n  }\n\n  if (!(this instanceof SemVer)) {\n    return new SemVer(version, options)\n  }\n\n  debug('SemVer', version, options)\n  this.options = options\n  this.loose = !!options.loose\n\n  var m = version.trim().match(options.loose ? re[LOOSE] : re[FULL])\n\n  if (!m) {\n    throw new TypeError('Invalid Version: ' + version)\n  }\n\n  this.raw = version\n\n  // these are actually numbers\n  this.major = +m[1]\n  this.minor = +m[2]\n  this.patch = +m[3]\n\n  if (this.major > MAX_SAFE_INTEGER || this.major < 0) {\n    throw new TypeError('Invalid major version')\n  }\n\n  if (this.minor > MAX_SAFE_INTEGER || this.minor < 0) {\n    throw new TypeError('Invalid minor version')\n  }\n\n  if (this.patch > MAX_SAFE_INTEGER || this.patch < 0) {\n    throw new TypeError('Invalid patch version')\n  }\n\n  // numberify any prerelease numeric ids\n  if (!m[4]) {\n    this.prerelease = []\n  } else {\n    this.prerelease = m[4].split('.').map(function (id) {\n      if (/^[0-9]+$/.test(id)) {\n        var num = +id\n        if (num >= 0 && num < MAX_SAFE_INTEGER) {\n          return num\n        }\n      }\n      return id\n    })\n  }\n\n  this.build = m[5] ? m[5].split('.') : []\n  this.format()\n}\n\nSemVer.prototype.format = function () {\n  this.version = this.major + '.' + this.minor + '.' + this.patch\n  if (this.prerelease.length) {\n    this.version += '-' + this.prerelease.join('.')\n  }\n  return this.version\n}\n\nSemVer.prototype.toString = function () {\n  return this.version\n}\n\nSemVer.prototype.compare = function (other) {\n  debug('SemVer.compare', this.version, this.options, other)\n  if (!(other instanceof SemVer)) {\n    other = new SemVer(other, this.options)\n  }\n\n  return this.compareMain(other) || this.comparePre(other)\n}\n\nSemVer.prototype.compareMain = function (other) {\n  if (!(other instanceof SemVer)) {\n    other = new SemVer(other, this.options)\n  }\n\n  return compareIdentifiers(this.major, other.major) ||\n         compareIdentifiers(this.minor, other.minor) ||\n         compareIdentifiers(this.patch, other.patch)\n}\n\nSemVer.prototype.comparePre = function (other) {\n  if (!(other instanceof SemVer)) {\n    other = new SemVer(other, this.options)\n  }\n\n  // NOT having a prerelease is > having one\n  if (this.prerelease.length && !other.prerelease.length) {\n    return -1\n  } else if (!this.prerelease.length && other.prerelease.length) {\n    return 1\n  } else if (!this.prerelease.length && !other.prerelease.length) {\n    return 0\n  }\n\n  var i = 0\n  do {\n    var a = this.prerelease[i]\n    var b = other.prerelease[i]\n    debug('prerelease compare', i, a, b)\n    if (a === undefined && b === undefined) {\n      return 0\n    } else if (b === undefined) {\n      return 1\n    } else if (a === undefined) {\n      return -1\n    } else if (a === b) {\n      continue\n    } else {\n      return compareIdentifiers(a, b)\n    }\n  } while (++i)\n}\n\n// preminor will bump the version up to the next minor release, and immediately\n// down to pre-release. premajor and prepatch work the same way.\nSemVer.prototype.inc = function (release, identifier) {\n  switch (release) {\n    case 'premajor':\n      this.prerelease.length = 0\n      this.patch = 0\n      this.minor = 0\n      this.major++\n      this.inc('pre', identifier)\n      break\n    case 'preminor':\n      this.prerelease.length = 0\n      this.patch = 0\n      this.minor++\n      this.inc('pre', identifier)\n      break\n    case 'prepatch':\n      // If this is already a prerelease, it will bump to the next version\n      // drop any prereleases that might already exist, since they are not\n      // relevant at this point.\n      this.prerelease.length = 0\n      this.inc('patch', identifier)\n      this.inc('pre', identifier)\n      break\n    // If the input is a non-prerelease version, this acts the same as\n    // prepatch.\n    case 'prerelease':\n      if (this.prerelease.length === 0) {\n        this.inc('patch', identifier)\n      }\n      this.inc('pre', identifier)\n      break\n\n    case 'major':\n      // If this is a pre-major version, bump up to the same major version.\n      // Otherwise increment major.\n      // 1.0.0-5 bumps to 1.0.0\n      // 1.1.0 bumps to 2.0.0\n      if (this.minor !== 0 ||\n          this.patch !== 0 ||\n          this.prerelease.length === 0) {\n        this.major++\n      }\n      this.minor = 0\n      this.patch = 0\n      this.prerelease = []\n      break\n    case 'minor':\n      // If this is a pre-minor version, bump up to the same minor version.\n      // Otherwise increment minor.\n      // 1.2.0-5 bumps to 1.2.0\n      // 1.2.1 bumps to 1.3.0\n      if (this.patch !== 0 || this.prerelease.length === 0) {\n        this.minor++\n      }\n      this.patch = 0\n      this.prerelease = []\n      break\n    case 'patch':\n      // If this is not a pre-release version, it will increment the patch.\n      // If it is a pre-release it will bump up to the same patch version.\n      // 1.2.0-5 patches to 1.2.0\n      // 1.2.0 patches to 1.2.1\n      if (this.prerelease.length === 0) {\n        this.patch++\n      }\n      this.prerelease = []\n      break\n    // This probably shouldn't be used publicly.\n    // 1.0.0 \"pre\" would become 1.0.0-0 which is the wrong direction.\n    case 'pre':\n      if (this.prerelease.length === 0) {\n        this.prerelease = [0]\n      } else {\n        var i = this.prerelease.length\n        while (--i >= 0) {\n          if (typeof this.prerelease[i] === 'number') {\n            this.prerelease[i]++\n            i = -2\n          }\n        }\n        if (i === -1) {\n          // didn't increment anything\n          this.prerelease.push(0)\n        }\n      }\n      if (identifier) {\n        // 1.2.0-beta.1 bumps to 1.2.0-beta.2,\n        // 1.2.0-beta.fooblz or 1.2.0-beta bumps to 1.2.0-beta.0\n        if (this.prerelease[0] === identifier) {\n          if (isNaN(this.prerelease[1])) {\n            this.prerelease = [identifier, 0]\n          }\n        } else {\n          this.prerelease = [identifier, 0]\n        }\n      }\n      break\n\n    default:\n      throw new Error('invalid increment argument: ' + release)\n  }\n  this.format()\n  this.raw = this.version\n  return this\n}\n\nexports.inc = inc\nfunction inc (version, release, loose, identifier) {\n  if (typeof (loose) === 'string') {\n    identifier = loose\n    loose = undefined\n  }\n\n  try {\n    return new SemVer(version, loose).inc(release, identifier).version\n  } catch (er) {\n    return null\n  }\n}\n\nexports.diff = diff\nfunction diff (version1, version2) {\n  if (eq(version1, version2)) {\n    return null\n  } else {\n    var v1 = parse(version1)\n    var v2 = parse(version2)\n    var prefix = ''\n    if (v1.prerelease.length || v2.prerelease.length) {\n      prefix = 'pre'\n      var defaultResult = 'prerelease'\n    }\n    for (var key in v1) {\n      if (key === 'major' || key === 'minor' || key === 'patch') {\n        if (v1[key] !== v2[key]) {\n          return prefix + key\n        }\n      }\n    }\n    return defaultResult // may be undefined\n  }\n}\n\nexports.compareIdentifiers = compareIdentifiers\n\nvar numeric = /^[0-9]+$/\nfunction compareIdentifiers (a, b) {\n  var anum = numeric.test(a)\n  var bnum = numeric.test(b)\n\n  if (anum && bnum) {\n    a = +a\n    b = +b\n  }\n\n  return a === b ? 0\n    : (anum && !bnum) ? -1\n    : (bnum && !anum) ? 1\n    : a < b ? -1\n    : 1\n}\n\nexports.rcompareIdentifiers = rcompareIdentifiers\nfunction rcompareIdentifiers (a, b) {\n  return compareIdentifiers(b, a)\n}\n\nexports.major = major\nfunction major (a, loose) {\n  return new SemVer(a, loose).major\n}\n\nexports.minor = minor\nfunction minor (a, loose) {\n  return new SemVer(a, loose).minor\n}\n\nexports.patch = patch\nfunction patch (a, loose) {\n  return new SemVer(a, loose).patch\n}\n\nexports.compare = compare\nfunction compare (a, b, loose) {\n  return new SemVer(a, loose).compare(new SemVer(b, loose))\n}\n\nexports.compareLoose = compareLoose\nfunction compareLoose (a, b) {\n  return compare(a, b, true)\n}\n\nexports.rcompare = rcompare\nfunction rcompare (a, b, loose) {\n  return compare(b, a, loose)\n}\n\nexports.sort = sort\nfunction sort (list, loose) {\n  return list.sort(function (a, b) {\n    return exports.compare(a, b, loose)\n  })\n}\n\nexports.rsort = rsort\nfunction rsort (list, loose) {\n  return list.sort(function (a, b) {\n    return exports.rcompare(a, b, loose)\n  })\n}\n\nexports.gt = gt\nfunction gt (a, b, loose) {\n  return compare(a, b, loose) > 0\n}\n\nexports.lt = lt\nfunction lt (a, b, loose) {\n  return compare(a, b, loose) < 0\n}\n\nexports.eq = eq\nfunction eq (a, b, loose) {\n  return compare(a, b, loose) === 0\n}\n\nexports.neq = neq\nfunction neq (a, b, loose) {\n  return compare(a, b, loose) !== 0\n}\n\nexports.gte = gte\nfunction gte (a, b, loose) {\n  return compare(a, b, loose) >= 0\n}\n\nexports.lte = lte\nfunction lte (a, b, loose) {\n  return compare(a, b, loose) <= 0\n}\n\nexports.cmp = cmp\nfunction cmp (a, op, b, loose) {\n  switch (op) {\n    case '===':\n      if (typeof a === 'object')\n        a = a.version\n      if (typeof b === 'object')\n        b = b.version\n      return a === b\n\n    case '!==':\n      if (typeof a === 'object')\n        a = a.version\n      if (typeof b === 'object')\n        b = b.version\n      return a !== b\n\n    case '':\n    case '=':\n    case '==':\n      return eq(a, b, loose)\n\n    case '!=':\n      return neq(a, b, loose)\n\n    case '>':\n      return gt(a, b, loose)\n\n    case '>=':\n      return gte(a, b, loose)\n\n    case '<':\n      return lt(a, b, loose)\n\n    case '<=':\n      return lte(a, b, loose)\n\n    default:\n      throw new TypeError('Invalid operator: ' + op)\n  }\n}\n\nexports.Comparator = Comparator\nfunction Comparator (comp, options) {\n  if (!options || typeof options !== 'object') {\n    options = {\n      loose: !!options,\n      includePrerelease: false\n    }\n  }\n\n  if (comp instanceof Comparator) {\n    if (comp.loose === !!options.loose) {\n      return comp\n    } else {\n      comp = comp.value\n    }\n  }\n\n  if (!(this instanceof Comparator)) {\n    return new Comparator(comp, options)\n  }\n\n  debug('comparator', comp, options)\n  this.options = options\n  this.loose = !!options.loose\n  this.parse(comp)\n\n  if (this.semver === ANY) {\n    this.value = ''\n  } else {\n    this.value = this.operator + this.semver.version\n  }\n\n  debug('comp', this)\n}\n\nvar ANY = {}\nComparator.prototype.parse = function (comp) {\n  var r = this.options.loose ? re[COMPARATORLOOSE] : re[COMPARATOR]\n  var m = comp.match(r)\n\n  if (!m) {\n    throw new TypeError('Invalid comparator: ' + comp)\n  }\n\n  this.operator = m[1]\n  if (this.operator === '=') {\n    this.operator = ''\n  }\n\n  // if it literally is just '>' or '' then allow anything.\n  if (!m[2]) {\n    this.semver = ANY\n  } else {\n    this.semver = new SemVer(m[2], this.options.loose)\n  }\n}\n\nComparator.prototype.toString = function () {\n  return this.value\n}\n\nComparator.prototype.test = function (version) {\n  debug('Comparator.test', version, this.options.loose)\n\n  if (this.semver === ANY) {\n    return true\n  }\n\n  if (typeof version === 'string') {\n    version = new SemVer(version, this.options)\n  }\n\n  return cmp(version, this.operator, this.semver, this.options)\n}\n\nComparator.prototype.intersects = function (comp, options) {\n  if (!(comp instanceof Comparator)) {\n    throw new TypeError('a Comparator is required')\n  }\n\n  if (!options || typeof options !== 'object') {\n    options = {\n      loose: !!options,\n      includePrerelease: false\n    }\n  }\n\n  var rangeTmp\n\n  if (this.operator === '') {\n    rangeTmp = new Range(comp.value, options)\n    return satisfies(this.value, rangeTmp, options)\n  } else if (comp.operator === '') {\n    rangeTmp = new Range(this.value, options)\n    return satisfies(comp.semver, rangeTmp, options)\n  }\n\n  var sameDirectionIncreasing =\n    (this.operator === '>=' || this.operator === '>') &&\n    (comp.operator === '>=' || comp.operator === '>')\n  var sameDirectionDecreasing =\n    (this.operator === '<=' || this.operator === '<') &&\n    (comp.operator === '<=' || comp.operator === '<')\n  var sameSemVer = this.semver.version === comp.semver.version\n  var differentDirectionsInclusive =\n    (this.operator === '>=' || this.operator === '<=') &&\n    (comp.operator === '>=' || comp.operator === '<=')\n  var oppositeDirectionsLessThan =\n    cmp(this.semver, '<', comp.semver, options) &&\n    ((this.operator === '>=' || this.operator === '>') &&\n    (comp.operator === '<=' || comp.operator === '<'))\n  var oppositeDirectionsGreaterThan =\n    cmp(this.semver, '>', comp.semver, options) &&\n    ((this.operator === '<=' || this.operator === '<') &&\n    (comp.operator === '>=' || comp.operator === '>'))\n\n  return sameDirectionIncreasing || sameDirectionDecreasing ||\n    (sameSemVer && differentDirectionsInclusive) ||\n    oppositeDirectionsLessThan || oppositeDirectionsGreaterThan\n}\n\nexports.Range = Range\nfunction Range (range, options) {\n  if (!options || typeof options !== 'object') {\n    options = {\n      loose: !!options,\n      includePrerelease: false\n    }\n  }\n\n  if (range instanceof Range) {\n    if (range.loose === !!options.loose &&\n        range.includePrerelease === !!options.includePrerelease) {\n      return range\n    } else {\n      return new Range(range.raw, options)\n    }\n  }\n\n  if (range instanceof Comparator) {\n    return new Range(range.value, options)\n  }\n\n  if (!(this instanceof Range)) {\n    return new Range(range, options)\n  }\n\n  this.options = options\n  this.loose = !!options.loose\n  this.includePrerelease = !!options.includePrerelease\n\n  // First, split based on boolean or ||\n  this.raw = range\n  this.set = range.split(/\\s*\\|\\|\\s*/).map(function (range) {\n    return this.parseRange(range.trim())\n  }, this).filter(function (c) {\n    // throw out any that are not relevant for whatever reason\n    return c.length\n  })\n\n  if (!this.set.length) {\n    throw new TypeError('Invalid SemVer Range: ' + range)\n  }\n\n  this.format()\n}\n\nRange.prototype.format = function () {\n  this.range = this.set.map(function (comps) {\n    return comps.join(' ').trim()\n  }).join('||').trim()\n  return this.range\n}\n\nRange.prototype.toString = function () {\n  return this.range\n}\n\nRange.prototype.parseRange = function (range) {\n  var loose = this.options.loose\n  range = range.trim()\n  // `1.2.3 - 1.2.4` => `>=1.2.3 <=1.2.4`\n  var hr = loose ? re[HYPHENRANGELOOSE] : re[HYPHENRANGE]\n  range = range.replace(hr, hyphenReplace)\n  debug('hyphen replace', range)\n  // `> 1.2.3 < 1.2.5` => `>1.2.3 <1.2.5`\n  range = range.replace(re[COMPARATORTRIM], comparatorTrimReplace)\n  debug('comparator trim', range, re[COMPARATORTRIM])\n\n  // `~ 1.2.3` => `~1.2.3`\n  range = range.replace(re[TILDETRIM], tildeTrimReplace)\n\n  // `^ 1.2.3` => `^1.2.3`\n  range = range.replace(re[CARETTRIM], caretTrimReplace)\n\n  // normalize spaces\n  range = range.split(/\\s+/).join(' ')\n\n  // At this point, the range is completely trimmed and\n  // ready to be split into comparators.\n\n  var compRe = loose ? re[COMPARATORLOOSE] : re[COMPARATOR]\n  var set = range.split(' ').map(function (comp) {\n    return parseComparator(comp, this.options)\n  }, this).join(' ').split(/\\s+/)\n  if (this.options.loose) {\n    // in loose mode, throw out any that are not valid comparators\n    set = set.filter(function (comp) {\n      return !!comp.match(compRe)\n    })\n  }\n  set = set.map(function (comp) {\n    return new Comparator(comp, this.options)\n  }, this)\n\n  return set\n}\n\nRange.prototype.intersects = function (range, options) {\n  if (!(range instanceof Range)) {\n    throw new TypeError('a Range is required')\n  }\n\n  return this.set.some(function (thisComparators) {\n    return thisComparators.every(function (thisComparator) {\n      return range.set.some(function (rangeComparators) {\n        return rangeComparators.every(function (rangeComparator) {\n          return thisComparator.intersects(rangeComparator, options)\n        })\n      })\n    })\n  })\n}\n\n// Mostly just for testing and legacy API reasons\nexports.toComparators = toComparators\nfunction toComparators (range, options) {\n  return new Range(range, options).set.map(function (comp) {\n    return comp.map(function (c) {\n      return c.value\n    }).join(' ').trim().split(' ')\n  })\n}\n\n// comprised of xranges, tildes, stars, and gtlt's at this point.\n// already replaced the hyphen ranges\n// turn into a set of JUST comparators.\nfunction parseComparator (comp, options) {\n  debug('comp', comp, options)\n  comp = replaceCarets(comp, options)\n  debug('caret', comp)\n  comp = replaceTildes(comp, options)\n  debug('tildes', comp)\n  comp = replaceXRanges(comp, options)\n  debug('xrange', comp)\n  comp = replaceStars(comp, options)\n  debug('stars', comp)\n  return comp\n}\n\nfunction isX (id) {\n  return !id || id.toLowerCase() === 'x' || id === '*'\n}\n\n// ~, ~> --> * (any, kinda silly)\n// ~2, ~2.x, ~2.x.x, ~>2, ~>2.x ~>2.x.x --> >=2.0.0 <3.0.0\n// ~2.0, ~2.0.x, ~>2.0, ~>2.0.x --> >=2.0.0 <2.1.0\n// ~1.2, ~1.2.x, ~>1.2, ~>1.2.x --> >=1.2.0 <1.3.0\n// ~1.2.3, ~>1.2.3 --> >=1.2.3 <1.3.0\n// ~1.2.0, ~>1.2.0 --> >=1.2.0 <1.3.0\nfunction replaceTildes (comp, options) {\n  return comp.trim().split(/\\s+/).map(function (comp) {\n    return replaceTilde(comp, options)\n  }).join(' ')\n}\n\nfunction replaceTilde (comp, options) {\n  var r = options.loose ? re[TILDELOOSE] : re[TILDE]\n  return comp.replace(r, function (_, M, m, p, pr) {\n    debug('tilde', comp, _, M, m, p, pr)\n    var ret\n\n    if (isX(M)) {\n      ret = ''\n    } else if (isX(m)) {\n      ret = '>=' + M + '.0.0 <' + (+M + 1) + '.0.0'\n    } else if (isX(p)) {\n      // ~1.2 == >=1.2.0 <1.3.0\n      ret = '>=' + M + '.' + m + '.0 <' + M + '.' + (+m + 1) + '.0'\n    } else if (pr) {\n      debug('replaceTilde pr', pr)\n      ret = '>=' + M + '.' + m + '.' + p + '-' + pr +\n            ' <' + M + '.' + (+m + 1) + '.0'\n    } else {\n      // ~1.2.3 == >=1.2.3 <1.3.0\n      ret = '>=' + M + '.' + m + '.' + p +\n            ' <' + M + '.' + (+m + 1) + '.0'\n    }\n\n    debug('tilde return', ret)\n    return ret\n  })\n}\n\n// ^ --> * (any, kinda silly)\n// ^2, ^2.x, ^2.x.x --> >=2.0.0 <3.0.0\n// ^2.0, ^2.0.x --> >=2.0.0 <3.0.0\n// ^1.2, ^1.2.x --> >=1.2.0 <2.0.0\n// ^1.2.3 --> >=1.2.3 <2.0.0\n// ^1.2.0 --> >=1.2.0 <2.0.0\nfunction replaceCarets (comp, options) {\n  return comp.trim().split(/\\s+/).map(function (comp) {\n    return replaceCaret(comp, options)\n  }).join(' ')\n}\n\nfunction replaceCaret (comp, options) {\n  debug('caret', comp, options)\n  var r = options.loose ? re[CARETLOOSE] : re[CARET]\n  return comp.replace(r, function (_, M, m, p, pr) {\n    debug('caret', comp, _, M, m, p, pr)\n    var ret\n\n    if (isX(M)) {\n      ret = ''\n    } else if (isX(m)) {\n      ret = '>=' + M + '.0.0 <' + (+M + 1) + '.0.0'\n    } else if (isX(p)) {\n      if (M === '0') {\n        ret = '>=' + M + '.' + m + '.0 <' + M + '.' + (+m + 1) + '.0'\n      } else {\n        ret = '>=' + M + '.' + m + '.0 <' + (+M + 1) + '.0.0'\n      }\n    } else if (pr) {\n      debug('replaceCaret pr', pr)\n      if (M === '0') {\n        if (m === '0') {\n          ret = '>=' + M + '.' + m + '.' + p + '-' + pr +\n                ' <' + M + '.' + m + '.' + (+p + 1)\n        } else {\n          ret = '>=' + M + '.' + m + '.' + p + '-' + pr +\n                ' <' + M + '.' + (+m + 1) + '.0'\n        }\n      } else {\n        ret = '>=' + M + '.' + m + '.' + p + '-' + pr +\n              ' <' + (+M + 1) + '.0.0'\n      }\n    } else {\n      debug('no pr')\n      if (M === '0') {\n        if (m === '0') {\n          ret = '>=' + M + '.' + m + '.' + p +\n                ' <' + M + '.' + m + '.' + (+p + 1)\n        } else {\n          ret = '>=' + M + '.' + m + '.' + p +\n                ' <' + M + '.' + (+m + 1) + '.0'\n        }\n      } else {\n        ret = '>=' + M + '.' + m + '.' + p +\n              ' <' + (+M + 1) + '.0.0'\n      }\n    }\n\n    debug('caret return', ret)\n    return ret\n  })\n}\n\nfunction replaceXRanges (comp, options) {\n  debug('replaceXRanges', comp, options)\n  return comp.split(/\\s+/).map(function (comp) {\n    return replaceXRange(comp, options)\n  }).join(' ')\n}\n\nfunction replaceXRange (comp, options) {\n  comp = comp.trim()\n  var r = options.loose ? re[XRANGELOOSE] : re[XRANGE]\n  return comp.replace(r, function (ret, gtlt, M, m, p, pr) {\n    debug('xRange', comp, ret, gtlt, M, m, p, pr)\n    var xM = isX(M)\n    var xm = xM || isX(m)\n    var xp = xm || isX(p)\n    var anyX = xp\n\n    if (gtlt === '=' && anyX) {\n      gtlt = ''\n    }\n\n    if (xM) {\n      if (gtlt === '>' || gtlt === '<') {\n        // nothing is allowed\n        ret = '<0.0.0'\n      } else {\n        // nothing is forbidden\n        ret = '*'\n      }\n    } else if (gtlt && anyX) {\n      // we know patch is an x, because we have any x at all.\n      // replace X with 0\n      if (xm) {\n        m = 0\n      }\n      p = 0\n\n      if (gtlt === '>') {\n        // >1 => >=2.0.0\n        // >1.2 => >=1.3.0\n        // >1.2.3 => >= 1.2.4\n        gtlt = '>='\n        if (xm) {\n          M = +M + 1\n          m = 0\n          p = 0\n        } else {\n          m = +m + 1\n          p = 0\n        }\n      } else if (gtlt === '<=') {\n        // <=0.7.x is actually <0.8.0, since any 0.7.x should\n        // pass.  Similarly, <=7.x is actually <8.0.0, etc.\n        gtlt = '<'\n        if (xm) {\n          M = +M + 1\n        } else {\n          m = +m + 1\n        }\n      }\n\n      ret = gtlt + M + '.' + m + '.' + p\n    } else if (xm) {\n      ret = '>=' + M + '.0.0 <' + (+M + 1) + '.0.0'\n    } else if (xp) {\n      ret = '>=' + M + '.' + m + '.0 <' + M + '.' + (+m + 1) + '.0'\n    }\n\n    debug('xRange return', ret)\n\n    return ret\n  })\n}\n\n// Because * is AND-ed with everything else in the comparator,\n// and '' means \"any version\", just remove the *s entirely.\nfunction replaceStars (comp, options) {\n  debug('replaceStars', comp, options)\n  // Looseness is ignored here.  star is always as loose as it gets!\n  return comp.trim().replace(re[STAR], '')\n}\n\n// This function is passed to string.replace(re[HYPHENRANGE])\n// M, m, patch, prerelease, build\n// 1.2 - 3.4.5 => >=1.2.0 <=3.4.5\n// 1.2.3 - 3.4 => >=1.2.0 <3.5.0 Any 3.4.x will do\n// 1.2 - 3.4 => >=1.2.0 <3.5.0\nfunction hyphenReplace ($0,\n  from, fM, fm, fp, fpr, fb,\n  to, tM, tm, tp, tpr, tb) {\n  if (isX(fM)) {\n    from = ''\n  } else if (isX(fm)) {\n    from = '>=' + fM + '.0.0'\n  } else if (isX(fp)) {\n    from = '>=' + fM + '.' + fm + '.0'\n  } else {\n    from = '>=' + from\n  }\n\n  if (isX(tM)) {\n    to = ''\n  } else if (isX(tm)) {\n    to = '<' + (+tM + 1) + '.0.0'\n  } else if (isX(tp)) {\n    to = '<' + tM + '.' + (+tm + 1) + '.0'\n  } else if (tpr) {\n    to = '<=' + tM + '.' + tm + '.' + tp + '-' + tpr\n  } else {\n    to = '<=' + to\n  }\n\n  return (from + ' ' + to).trim()\n}\n\n// if ANY of the sets match ALL of its comparators, then pass\nRange.prototype.test = function (version) {\n  if (!version) {\n    return false\n  }\n\n  if (typeof version === 'string') {\n    version = new SemVer(version, this.options)\n  }\n\n  for (var i = 0; i < this.set.length; i++) {\n    if (testSet(this.set[i], version, this.options)) {\n      return true\n    }\n  }\n  return false\n}\n\nfunction testSet (set, version, options) {\n  for (var i = 0; i < set.length; i++) {\n    if (!set[i].test(version)) {\n      return false\n    }\n  }\n\n  if (version.prerelease.length && !options.includePrerelease) {\n    // Find the set of versions that are allowed to have prereleases\n    // For example, ^1.2.3-pr.1 desugars to >=1.2.3-pr.1 <2.0.0\n    // That should allow `1.2.3-pr.2` to pass.\n    // However, `1.2.4-alpha.notready` should NOT be allowed,\n    // even though it's within the range set by the comparators.\n    for (i = 0; i < set.length; i++) {\n      debug(set[i].semver)\n      if (set[i].semver === ANY) {\n        continue\n      }\n\n      if (set[i].semver.prerelease.length > 0) {\n        var allowed = set[i].semver\n        if (allowed.major === version.major &&\n            allowed.minor === version.minor &&\n            allowed.patch === version.patch) {\n          return true\n        }\n      }\n    }\n\n    // Version has a -pre, but it's not one of the ones we like.\n    return false\n  }\n\n  return true\n}\n\nexports.satisfies = satisfies\nfunction satisfies (version, range, options) {\n  try {\n    range = new Range(range, options)\n  } catch (er) {\n    return false\n  }\n  return range.test(version)\n}\n\nexports.maxSatisfying = maxSatisfying\nfunction maxSatisfying (versions, range, options) {\n  var max = null\n  var maxSV = null\n  try {\n    var rangeObj = new Range(range, options)\n  } catch (er) {\n    return null\n  }\n  versions.forEach(function (v) {\n    if (rangeObj.test(v)) {\n      // satisfies(v, range, options)\n      if (!max || maxSV.compare(v) === -1) {\n        // compare(max, v, true)\n        max = v\n        maxSV = new SemVer(max, options)\n      }\n    }\n  })\n  return max\n}\n\nexports.minSatisfying = minSatisfying\nfunction minSatisfying (versions, range, options) {\n  var min = null\n  var minSV = null\n  try {\n    var rangeObj = new Range(range, options)\n  } catch (er) {\n    return null\n  }\n  versions.forEach(function (v) {\n    if (rangeObj.test(v)) {\n      // satisfies(v, range, options)\n      if (!min || minSV.compare(v) === 1) {\n        // compare(min, v, true)\n        min = v\n        minSV = new SemVer(min, options)\n      }\n    }\n  })\n  return min\n}\n\nexports.minVersion = minVersion\nfunction minVersion (range, loose) {\n  range = new Range(range, loose)\n\n  var minver = new SemVer('0.0.0')\n  if (range.test(minver)) {\n    return minver\n  }\n\n  minver = new SemVer('0.0.0-0')\n  if (range.test(minver)) {\n    return minver\n  }\n\n  minver = null\n  for (var i = 0; i < range.set.length; ++i) {\n    var comparators = range.set[i]\n\n    comparators.forEach(function (comparator) {\n      // Clone to avoid manipulating the comparator's semver object.\n      var compver = new SemVer(comparator.semver.version)\n      switch (comparator.operator) {\n        case '>':\n          if (compver.prerelease.length === 0) {\n            compver.patch++\n          } else {\n            compver.prerelease.push(0)\n          }\n          compver.raw = compver.format()\n          /* fallthrough */\n        case '':\n        case '>=':\n          if (!minver || gt(minver, compver)) {\n            minver = compver\n          }\n          break\n        case '<':\n        case '<=':\n          /* Ignore maximum versions */\n          break\n        /* istanbul ignore next */\n        default:\n          throw new Error('Unexpected operation: ' + comparator.operator)\n      }\n    })\n  }\n\n  if (minver && range.test(minver)) {\n    return minver\n  }\n\n  return null\n}\n\nexports.validRange = validRange\nfunction validRange (range, options) {\n  try {\n    // Return '*' instead of '' so that truthiness works.\n    // This will throw if it's invalid anyway\n    return new Range(range, options).range || '*'\n  } catch (er) {\n    return null\n  }\n}\n\n// Determine if version is less than all the versions possible in the range\nexports.ltr = ltr\nfunction ltr (version, range, options) {\n  return outside(version, range, '<', options)\n}\n\n// Determine if version is greater than all the versions possible in the range.\nexports.gtr = gtr\nfunction gtr (version, range, options) {\n  return outside(version, range, '>', options)\n}\n\nexports.outside = outside\nfunction outside (version, range, hilo, options) {\n  version = new SemVer(version, options)\n  range = new Range(range, options)\n\n  var gtfn, ltefn, ltfn, comp, ecomp\n  switch (hilo) {\n    case '>':\n      gtfn = gt\n      ltefn = lte\n      ltfn = lt\n      comp = '>'\n      ecomp = '>='\n      break\n    case '<':\n      gtfn = lt\n      ltefn = gte\n      ltfn = gt\n      comp = '<'\n      ecomp = '<='\n      break\n    default:\n      throw new TypeError('Must provide a hilo val of \"<\" or \">\"')\n  }\n\n  // If it satisifes the range it is not outside\n  if (satisfies(version, range, options)) {\n    return false\n  }\n\n  // From now on, variable terms are as if we're in \"gtr\" mode.\n  // but note that everything is flipped for the \"ltr\" function.\n\n  for (var i = 0; i < range.set.length; ++i) {\n    var comparators = range.set[i]\n\n    var high = null\n    var low = null\n\n    comparators.forEach(function (comparator) {\n      if (comparator.semver === ANY) {\n        comparator = new Comparator('>=0.0.0')\n      }\n      high = high || comparator\n      low = low || comparator\n      if (gtfn(comparator.semver, high.semver, options)) {\n        high = comparator\n      } else if (ltfn(comparator.semver, low.semver, options)) {\n        low = comparator\n      }\n    })\n\n    // If the edge version comparator has a operator then our version\n    // isn't outside it\n    if (high.operator === comp || high.operator === ecomp) {\n      return false\n    }\n\n    // If the lowest version comparator has an operator and our version\n    // is less than it then it isn't higher than the range\n    if ((!low.operator || low.operator === comp) &&\n        ltefn(version, low.semver)) {\n      return false\n    } else if (low.operator === ecomp && ltfn(version, low.semver)) {\n      return false\n    }\n  }\n  return true\n}\n\nexports.prerelease = prerelease\nfunction prerelease (version, options) {\n  var parsed = parse(version, options)\n  return (parsed && parsed.prerelease.length) ? parsed.prerelease : null\n}\n\nexports.intersects = intersects\nfunction intersects (r1, r2, options) {\n  r1 = new Range(r1, options)\n  r2 = new Range(r2, options)\n  return r1.intersects(r2)\n}\n\nexports.coerce = coerce\nfunction coerce (version) {\n  if (version instanceof SemVer) {\n    return version\n  }\n\n  if (typeof version !== 'string') {\n    return null\n  }\n\n  var match = version.match(re[COERCE])\n\n  if (match == null) {\n    return null\n  }\n\n  return parse(match[1] +\n    '.' + (match[2] || '0') +\n    '.' + (match[3] || '0'))\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport const file = 'file';\nexport const untitled = 'untitled';\nexport const git = 'git';\n/** Live share scheme */\nexport const vsls = 'vsls';\nexport const walkThroughSnippet = 'walkThroughSnippet';\nexport const vscodeNotebookCell = 'vscode-notebook-cell';\nexport const memFs = 'memfs';\nexport const vscodeVfs = 'vscode-vfs';\n\nexport const semanticSupportedSchemes = [\n\tfile,\n\tuntitled,\n\twalkThroughSnippet,\n\tvscodeNotebookCell,\n];\n\n/**\n * File scheme for which JS/TS language feature should be disabled\n */\nexport const disabledSchemes = new Set([\n\tgit,\n\tvsls\n]);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as array from './arrays';\n\nexport function equals(one: any, other: any): boolean {\n\tif (one === other) {\n\t\treturn true;\n\t}\n\tif (one === null || one === undefined || other === null || other === undefined) {\n\t\treturn false;\n\t}\n\tif (typeof one !== typeof other) {\n\t\treturn false;\n\t}\n\tif (typeof one !== 'object') {\n\t\treturn false;\n\t}\n\tif (Array.isArray(one) !== Array.isArray(other)) {\n\t\treturn false;\n\t}\n\n\tif (Array.isArray(one)) {\n\t\treturn array.equals(one, other, equals);\n\t} else {\n\t\tconst oneKeys: string[] = [];\n\t\tfor (const key in one) {\n\t\t\toneKeys.push(key);\n\t\t}\n\t\toneKeys.sort();\n\t\tconst otherKeys: string[] = [];\n\t\tfor (const key in other) {\n\t\t\totherKeys.push(key);\n\t\t}\n\t\totherKeys.sort();\n\t\tif (!array.equals(oneKeys, otherKeys)) {\n\t\t\treturn false;\n\t\t}\n\t\treturn oneKeys.every(key => equals(one[key], other[key]));\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport const empty = Object.freeze([]);\n\nexport function equals<T>(\n\ta: ReadonlyArray<T>,\n\tb: ReadonlyArray<T>,\n\titemEquals: (a: T, b: T) => boolean = (a, b) => a === b\n): boolean {\n\tif (a === b) {\n\t\treturn true;\n\t}\n\tif (a.length !== b.length) {\n\t\treturn false;\n\t}\n\treturn a.every((x, i) => itemEquals(x, b[i]));\n}\n\nexport function flatten<T>(array: ReadonlyArray<T>[]): T[] {\n\treturn Array.prototype.concat.apply([], array);\n}\n\nexport function coalesce<T>(array: ReadonlyArray<T | undefined>): T[] {\n\treturn <T[]>array.filter(e => !!e);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as fileSchemes from '../utils/fileSchemes';\n\n/**\n * Maps of file resources\n *\n * Attempts to handle correct mapping on both case sensitive and case in-sensitive\n * file systems.\n */\nexport class ResourceMap<T> {\n\n\tprivate static readonly defaultPathNormalizer = (resource: vscode.Uri): string => {\n\t\tif (resource.scheme === fileSchemes.file) {\n\t\t\treturn resource.fsPath;\n\t\t}\n\t\treturn resource.toString(true);\n\t};\n\n\tprivate readonly _map = new Map<string, { readonly resource: vscode.Uri, value: T }>();\n\n\tconstructor(\n\t\tprotected readonly _normalizePath: (resource: vscode.Uri) => string | undefined = ResourceMap.defaultPathNormalizer,\n\t\tprotected readonly config: {\n\t\t\treadonly onCaseInsensitiveFileSystem: boolean,\n\t\t},\n\t) { }\n\n\tpublic get size() {\n\t\treturn this._map.size;\n\t}\n\n\tpublic has(resource: vscode.Uri): boolean {\n\t\tconst file = this.toKey(resource);\n\t\treturn !!file && this._map.has(file);\n\t}\n\n\tpublic get(resource: vscode.Uri): T | undefined {\n\t\tconst file = this.toKey(resource);\n\t\tif (!file) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst entry = this._map.get(file);\n\t\treturn entry ? entry.value : undefined;\n\t}\n\n\tpublic set(resource: vscode.Uri, value: T) {\n\t\tconst file = this.toKey(resource);\n\t\tif (!file) {\n\t\t\treturn;\n\t\t}\n\t\tconst entry = this._map.get(file);\n\t\tif (entry) {\n\t\t\tentry.value = value;\n\t\t} else {\n\t\t\tthis._map.set(file, { resource, value });\n\t\t}\n\t}\n\n\tpublic delete(resource: vscode.Uri): void {\n\t\tconst file = this.toKey(resource);\n\t\tif (file) {\n\t\t\tthis._map.delete(file);\n\t\t}\n\t}\n\n\tpublic clear(): void {\n\t\tthis._map.clear();\n\t}\n\n\tpublic get values(): Iterable<T> {\n\t\treturn Array.from(this._map.values(), x => x.value);\n\t}\n\n\tpublic get entries(): Iterable<{ resource: vscode.Uri, value: T }> {\n\t\treturn this._map.values();\n\t}\n\n\tprivate toKey(resource: vscode.Uri): string | undefined {\n\t\tconst key = this._normalizePath(resource);\n\t\tif (!key) {\n\t\t\treturn key;\n\t\t}\n\t\treturn this.isCaseInsensitivePath(key) ? key.toLowerCase() : key;\n\t}\n\n\tprivate isCaseInsensitivePath(path: string) {\n\t\tif (isWindowsPath(path)) {\n\t\t\treturn true;\n\t\t}\n\t\treturn path[0] === '/' && this.config.onCaseInsensitiveFileSystem;\n\t}\n}\n\nfunction isWindowsPath(path: string): boolean {\n\treturn /^[a-zA-Z]:[\\/\\\\]/.test(path);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { basename, extname } from 'path';\nimport * as vscode from 'vscode';\nimport { CommandManager } from './commands/commandManager';\nimport { DiagnosticKind } from './languageFeatures/diagnostics';\nimport FileConfigurationManager from './languageFeatures/fileConfigurationManager';\nimport { CachedResponse } from './tsServer/cachedResponse';\nimport { ClientCapability } from './typescriptService';\nimport TypeScriptServiceClient from './typescriptServiceClient';\nimport { Disposable } from './utils/dispose';\nimport { DocumentSelector } from './utils/documentSelector';\nimport * as fileSchemes from './utils/fileSchemes';\nimport { LanguageDescription } from './utils/languageDescription';\nimport { TelemetryReporter } from './utils/telemetry';\nimport TypingsStatus from './utils/typingsStatus';\n\n\nconst validateSetting = 'validate.enable';\nconst suggestionSetting = 'suggestionActions.enabled';\n\nexport default class LanguageProvider extends Disposable {\n\n\tconstructor(\n\t\tprivate readonly client: TypeScriptServiceClient,\n\t\tprivate readonly description: LanguageDescription,\n\t\tprivate readonly commandManager: CommandManager,\n\t\tprivate readonly telemetryReporter: TelemetryReporter,\n\t\tprivate readonly typingsStatus: TypingsStatus,\n\t\tprivate readonly fileConfigurationManager: FileConfigurationManager,\n\t\tprivate readonly onCompletionAccepted: (item: vscode.CompletionItem) => void,\n\t) {\n\t\tsuper();\n\t\tvscode.workspace.onDidChangeConfiguration(this.configurationChanged, this, this._disposables);\n\t\tthis.configurationChanged();\n\n\t\tclient.onReady(() => this.registerProviders());\n\t}\n\n\tprivate get documentSelector(): DocumentSelector {\n\t\tconst semantic: vscode.DocumentFilter[] = [];\n\t\tconst syntax: vscode.DocumentFilter[] = [];\n\t\tfor (const language of this.description.modeIds) {\n\t\t\tsyntax.push({ language });\n\t\t\tfor (const scheme of fileSchemes.semanticSupportedSchemes) {\n\t\t\t\tsemantic.push({ language, scheme });\n\t\t\t}\n\t\t}\n\n\t\treturn { semantic, syntax };\n\t}\n\n\tprivate async registerProviders(): Promise<void> {\n\t\tconst selector = this.documentSelector;\n\n\t\tconst cachedResponse = new CachedResponse();\n\n\t\tawait Promise.all([\n\t\t\timport('./languageFeatures/callHierarchy').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/codeLens/implementationsCodeLens').then(provider => this._register(provider.register(selector, this.description.id, this.client, cachedResponse))),\n\t\t\timport('./languageFeatures/codeLens/referencesCodeLens').then(provider => this._register(provider.register(selector, this.description.id, this.client, cachedResponse))),\n\t\t\timport('./languageFeatures/completions').then(provider => this._register(provider.register(selector, this.description.id, this.client, this.typingsStatus, this.fileConfigurationManager, this.commandManager, this.telemetryReporter, this.onCompletionAccepted))),\n\t\t\timport('./languageFeatures/definitions').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/directiveCommentCompletions').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/documentHighlight').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/documentSymbol').then(provider => this._register(provider.register(selector, this.client, cachedResponse))),\n\t\t\timport('./languageFeatures/fileReferences').then(provider => this._register(provider.register(this.client, this.commandManager))),\n\t\t\timport('./languageFeatures/fixAll').then(provider => this._register(provider.register(selector, this.client, this.fileConfigurationManager, this.client.diagnosticsManager))),\n\t\t\timport('./languageFeatures/folding').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/formatting').then(provider => this._register(provider.register(selector, this.description.id, this.client, this.fileConfigurationManager))),\n\t\t\timport('./languageFeatures/hover').then(provider => this._register(provider.register(selector, this.client, this.fileConfigurationManager))),\n\t\t\timport('./languageFeatures/implementations').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/jsDocCompletions').then(provider => this._register(provider.register(selector, this.description.id, this.client, this.fileConfigurationManager))),\n\t\t\timport('./languageFeatures/organizeImports').then(provider => this._register(provider.register(selector, this.client, this.commandManager, this.fileConfigurationManager, this.telemetryReporter))),\n\t\t\timport('./languageFeatures/quickFix').then(provider => this._register(provider.register(selector, this.client, this.fileConfigurationManager, this.commandManager, this.client.diagnosticsManager, this.telemetryReporter))),\n\t\t\timport('./languageFeatures/refactor').then(provider => this._register(provider.register(selector, this.client, this.fileConfigurationManager, this.commandManager, this.telemetryReporter))),\n\t\t\timport('./languageFeatures/references').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/rename').then(provider => this._register(provider.register(selector, this.client, this.fileConfigurationManager))),\n\t\t\timport('./languageFeatures/semanticTokens').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/signatureHelp').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/smartSelect').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/tagClosing').then(provider => this._register(provider.register(selector, this.description.id, this.client))),\n\t\t\timport('./languageFeatures/typeDefinitions').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/inlayHints').then(provider => this._register(provider.register(selector, this.description.id, this.description.modeIds, this.client, this.fileConfigurationManager))),\n\t\t]);\n\t}\n\n\tprivate configurationChanged(): void {\n\t\tconst config = vscode.workspace.getConfiguration(this.id, null);\n\t\tthis.updateValidate(config.get(validateSetting, true));\n\t\tthis.updateSuggestionDiagnostics(config.get(suggestionSetting, true));\n\t}\n\n\tpublic handlesUri(resource: vscode.Uri): boolean {\n\t\tconst ext = extname(resource.path).slice(1).toLowerCase();\n\t\treturn this.description.standardFileExtensions.includes(ext) || this.handlesConfigFile(resource);\n\t}\n\n\tpublic handlesDocument(doc: vscode.TextDocument): boolean {\n\t\treturn this.description.modeIds.includes(doc.languageId) || this.handlesConfigFile(doc.uri);\n\t}\n\n\tprivate handlesConfigFile(resource: vscode.Uri) {\n\t\tconst base = basename(resource.fsPath);\n\t\treturn !!base && (!!this.description.configFilePattern && this.description.configFilePattern.test(base));\n\t}\n\n\tprivate get id(): string {\n\t\treturn this.description.id;\n\t}\n\n\tpublic get diagnosticSource(): string {\n\t\treturn this.description.diagnosticSource;\n\t}\n\n\tprivate updateValidate(value: boolean) {\n\t\tthis.client.diagnosticsManager.setValidate(this._diagnosticLanguage, value);\n\t}\n\n\tprivate updateSuggestionDiagnostics(value: boolean) {\n\t\tthis.client.diagnosticsManager.setEnableSuggestions(this._diagnosticLanguage, value);\n\t}\n\n\tpublic reInitialize(): void {\n\t\tthis.client.diagnosticsManager.reInitialize();\n\t}\n\n\tpublic triggerAllDiagnostics(): void {\n\t\tthis.client.bufferSyncSupport.requestAllDiagnostics();\n\t}\n\n\tpublic diagnosticsReceived(diagnosticsKind: DiagnosticKind, file: vscode.Uri, diagnostics: (vscode.Diagnostic & { reportUnnecessary: any, reportDeprecated: any })[]): void {\n\t\tif (diagnosticsKind !== DiagnosticKind.Syntax && !this.client.hasCapabilityForResource(file, ClientCapability.Semantic)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst config = vscode.workspace.getConfiguration(this.id, file);\n\t\tconst reportUnnecessary = config.get<boolean>('showUnused', true);\n\t\tconst reportDeprecated = config.get<boolean>('showDeprecated', true);\n\t\tthis.client.diagnosticsManager.updateDiagnostics(file, this._diagnosticLanguage, diagnosticsKind, diagnostics.filter(diag => {\n\t\t\t// Don't bother reporting diagnostics we know will not be rendered\n\t\t\tif (!reportUnnecessary) {\n\t\t\t\tif (diag.reportUnnecessary && diag.severity === vscode.DiagnosticSeverity.Hint) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!reportDeprecated) {\n\t\t\t\tif (diag.reportDeprecated && diag.severity === vscode.DiagnosticSeverity.Hint) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}));\n\t}\n\n\tpublic configFileDiagnosticsReceived(file: vscode.Uri, diagnostics: vscode.Diagnostic[]): void {\n\t\tthis.client.diagnosticsManager.configFileDiagnosticsReceived(file, diagnostics);\n\t}\n\n\tprivate get _diagnosticLanguage() {\n\t\treturn this.description.diagnosticLanguage;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../protocol';\nimport { ServerResponse } from '../typescriptService';\n\ntype Resolve<T extends Proto.Response> = () => Promise<ServerResponse.Response<T>>;\n\n/**\n * Caches a class of TS Server request based on document.\n */\nexport class CachedResponse<T extends Proto.Response> {\n\tprivate response?: Promise<ServerResponse.Response<T>>;\n\tprivate version: number = -1;\n\tprivate document: string = '';\n\n\t/**\n\t * Execute a request. May return cached value or resolve the new value\n\t *\n\t * Caller must ensure that all input `resolve` functions return equivilent results (keyed only off of document).\n\t */\n\tpublic execute(\n\t\tdocument: vscode.TextDocument,\n\t\tresolve: Resolve<T>\n\t): Promise<ServerResponse.Response<T>> {\n\t\tif (this.response && this.matches(document)) {\n\t\t\t// Chain so that on cancellation we fall back to the next resolve\n\t\t\treturn this.response = this.response.then(result => result.type === 'cancelled' ? resolve() : result);\n\t\t}\n\t\treturn this.reset(document, resolve);\n\t}\n\n\tprivate matches(document: vscode.TextDocument): boolean {\n\t\treturn this.version === document.version && this.document === document.uri.toString();\n\t}\n\n\tprivate async reset(\n\t\tdocument: vscode.TextDocument,\n\t\tresolve: Resolve<T>\n\t): Promise<ServerResponse.Response<T>> {\n\t\tthis.version = document.version;\n\t\tthis.document = document.uri.toString();\n\t\treturn this.response = resolve();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as Proto from './protocol';\nimport BufferSyncSupport from './tsServer/bufferSyncSupport';\nimport { ExecutionTarget } from './tsServer/server';\nimport { TypeScriptVersion } from './tsServer/versionProvider';\nimport API from './utils/api';\nimport { TypeScriptServiceConfiguration } from './utils/configuration';\nimport { PluginManager } from './utils/plugins';\nimport { TelemetryReporter } from './utils/telemetry';\n\nexport enum ServerType {\n\tSyntax = 'syntax',\n\tSemantic = 'semantic',\n}\n\nexport namespace ServerResponse {\n\n\texport class Cancelled {\n\t\tpublic readonly type = 'cancelled';\n\n\t\tconstructor(\n\t\t\tpublic readonly reason: string\n\t\t) { }\n\t}\n\n\texport const NoContent = { type: 'noContent' } as const;\n\n\texport type Response<T extends Proto.Response> = T | Cancelled | typeof NoContent;\n}\n\ninterface StandardTsServerRequests {\n\t'applyCodeActionCommand': [Proto.ApplyCodeActionCommandRequestArgs, Proto.ApplyCodeActionCommandResponse];\n\t'completionEntryDetails': [Proto.CompletionDetailsRequestArgs, Proto.CompletionDetailsResponse];\n\t'completionInfo': [Proto.CompletionsRequestArgs, Proto.CompletionInfoResponse];\n\t'completions': [Proto.CompletionsRequestArgs, Proto.CompletionsResponse];\n\t'configure': [Proto.ConfigureRequestArguments, Proto.ConfigureResponse];\n\t'definition': [Proto.FileLocationRequestArgs, Proto.DefinitionResponse];\n\t'definitionAndBoundSpan': [Proto.FileLocationRequestArgs, Proto.DefinitionInfoAndBoundSpanResponse];\n\t'docCommentTemplate': [Proto.FileLocationRequestArgs, Proto.DocCommandTemplateResponse];\n\t'documentHighlights': [Proto.DocumentHighlightsRequestArgs, Proto.DocumentHighlightsResponse];\n\t'format': [Proto.FormatRequestArgs, Proto.FormatResponse];\n\t'formatonkey': [Proto.FormatOnKeyRequestArgs, Proto.FormatResponse];\n\t'getApplicableRefactors': [Proto.GetApplicableRefactorsRequestArgs, Proto.GetApplicableRefactorsResponse];\n\t'getCodeFixes': [Proto.CodeFixRequestArgs, Proto.CodeFixResponse];\n\t'getCombinedCodeFix': [Proto.GetCombinedCodeFixRequestArgs, Proto.GetCombinedCodeFixResponse];\n\t'getEditsForFileRename': [Proto.GetEditsForFileRenameRequestArgs, Proto.GetEditsForFileRenameResponse];\n\t'getEditsForRefactor': [Proto.GetEditsForRefactorRequestArgs, Proto.GetEditsForRefactorResponse];\n\t'getOutliningSpans': [Proto.FileRequestArgs, Proto.OutliningSpansResponse];\n\t'getSupportedCodeFixes': [null, Proto.GetSupportedCodeFixesResponse];\n\t'implementation': [Proto.FileLocationRequestArgs, Proto.ImplementationResponse];\n\t'jsxClosingTag': [Proto.JsxClosingTagRequestArgs, Proto.JsxClosingTagResponse];\n\t'navto': [Proto.NavtoRequestArgs, Proto.NavtoResponse];\n\t'navtree': [Proto.FileRequestArgs, Proto.NavTreeResponse];\n\t'organizeImports': [Proto.OrganizeImportsRequestArgs, Proto.OrganizeImportsResponse];\n\t'projectInfo': [Proto.ProjectInfoRequestArgs, Proto.ProjectInfoResponse];\n\t'quickinfo': [Proto.FileLocationRequestArgs, Proto.QuickInfoResponse];\n\t'references': [Proto.FileLocationRequestArgs, Proto.ReferencesResponse];\n\t'rename': [Proto.RenameRequestArgs, Proto.RenameResponse];\n\t'selectionRange': [Proto.SelectionRangeRequestArgs, Proto.SelectionRangeResponse];\n\t'signatureHelp': [Proto.SignatureHelpRequestArgs, Proto.SignatureHelpResponse];\n\t'typeDefinition': [Proto.FileLocationRequestArgs, Proto.TypeDefinitionResponse];\n\t'updateOpen': [Proto.UpdateOpenRequestArgs, Proto.Response];\n\t'prepareCallHierarchy': [Proto.FileLocationRequestArgs, Proto.PrepareCallHierarchyResponse];\n\t'provideCallHierarchyIncomingCalls': [Proto.FileLocationRequestArgs, Proto.ProvideCallHierarchyIncomingCallsResponse];\n\t'provideCallHierarchyOutgoingCalls': [Proto.FileLocationRequestArgs, Proto.ProvideCallHierarchyOutgoingCallsResponse];\n\t'fileReferences': [Proto.FileRequestArgs, Proto.FileReferencesResponse];\n\t'provideInlayHints': [Proto.InlayHintsRequestArgs, Proto.InlayHintsResponse];\n}\n\ninterface NoResponseTsServerRequests {\n\t'open': [Proto.OpenRequestArgs, null];\n\t'close': [Proto.FileRequestArgs, null];\n\t'change': [Proto.ChangeRequestArgs, null];\n\t'compilerOptionsForInferredProjects': [Proto.SetCompilerOptionsForInferredProjectsArgs, null];\n\t'reloadProjects': [null, null];\n\t'configurePlugin': [Proto.ConfigurePluginRequest, Proto.ConfigurePluginResponse];\n}\n\ninterface AsyncTsServerRequests {\n\t'geterr': [Proto.GeterrRequestArgs, Proto.Response];\n\t'geterrForProject': [Proto.GeterrForProjectRequestArgs, Proto.Response];\n}\n\nexport type TypeScriptRequests = StandardTsServerRequests & NoResponseTsServerRequests & AsyncTsServerRequests;\n\nexport type ExecConfig = {\n\treadonly lowPriority?: boolean;\n\treadonly nonRecoverable?: boolean;\n\treadonly cancelOnResourceChange?: vscode.Uri;\n\treadonly executionTarget?: ExecutionTarget;\n};\n\nexport enum ClientCapability {\n\t/**\n\t * Basic syntax server. All clients should support this.\n\t */\n\tSyntax,\n\n\t/**\n\t * Advanced syntax server that can provide single file IntelliSense.\n\t */\n\tEnhancedSyntax,\n\n\t/**\n\t * Complete, multi-file semantic server\n\t */\n\tSemantic,\n}\n\nexport class ClientCapabilities {\n\tprivate readonly capabilities: ReadonlySet<ClientCapability>;\n\n\tconstructor(...capabilities: ClientCapability[]) {\n\t\tthis.capabilities = new Set(capabilities);\n\t}\n\n\tpublic has(capability: ClientCapability): boolean {\n\t\treturn this.capabilities.has(capability);\n\t}\n}\n\nexport interface ITypeScriptServiceClient {\n\t/**\n\t * Convert a resource (VS Code) to a normalized path (TypeScript).\n\t *\n\t * Does not try handling case insensitivity.\n\t */\n\tnormalizedPath(resource: vscode.Uri): string | undefined;\n\n\t/**\n\t * Map a resource to a normalized path\n\t *\n\t * This will attempt to handle case insensitivity.\n\t */\n\ttoPath(resource: vscode.Uri): string | undefined;\n\n\t/**\n\t * Convert a path to a resource.\n\t */\n\ttoResource(filepath: string): vscode.Uri;\n\n\t/**\n\t * Tries to ensure that a vscode document is open on the TS server.\n\t *\n\t * @return The normalized path or `undefined` if the document is not open on the server.\n\t */\n\ttoOpenedFilePath(document: vscode.TextDocument, options?: {\n\t\tsuppressAlertOnFailure?: boolean\n\t}): string | undefined;\n\n\t/**\n\t * Checks if `resource` has a given capability.\n\t */\n\thasCapabilityForResource(resource: vscode.Uri, capability: ClientCapability): boolean;\n\n\tgetWorkspaceRootForResource(resource: vscode.Uri): string | undefined;\n\n\treadonly onTsServerStarted: vscode.Event<{ version: TypeScriptVersion, usedApiVersion: API }>;\n\treadonly onProjectLanguageServiceStateChanged: vscode.Event<Proto.ProjectLanguageServiceStateEventBody>;\n\treadonly onDidBeginInstallTypings: vscode.Event<Proto.BeginInstallTypesEventBody>;\n\treadonly onDidEndInstallTypings: vscode.Event<Proto.EndInstallTypesEventBody>;\n\treadonly onTypesInstallerInitializationFailed: vscode.Event<Proto.TypesInstallerInitializationFailedEventBody>;\n\n\treadonly capabilities: ClientCapabilities;\n\treadonly onDidChangeCapabilities: vscode.Event<void>;\n\n\tonReady(f: () => void): Promise<void>;\n\n\tshowVersionPicker(): void;\n\n\treadonly apiVersion: API;\n\n\treadonly pluginManager: PluginManager;\n\treadonly configuration: TypeScriptServiceConfiguration;\n\treadonly bufferSyncSupport: BufferSyncSupport;\n\treadonly telemetryReporter: TelemetryReporter;\n\n\texecute<K extends keyof StandardTsServerRequests>(\n\t\tcommand: K,\n\t\targs: StandardTsServerRequests[K][0],\n\t\ttoken: vscode.CancellationToken,\n\t\tconfig?: ExecConfig\n\t): Promise<ServerResponse.Response<StandardTsServerRequests[K][1]>>;\n\n\texecuteWithoutWaitingForResponse<K extends keyof NoResponseTsServerRequests>(\n\t\tcommand: K,\n\t\targs: NoResponseTsServerRequests[K][0]\n\t): void;\n\n\texecuteAsync<K extends keyof AsyncTsServerRequests>(\n\t\tcommand: K,\n\t\targs: AsyncTsServerRequests[K][0],\n\t\ttoken: vscode.CancellationToken\n\t): Promise<ServerResponse.Response<Proto.Response>>;\n\n\t/**\n\t * Cancel on going geterr requests and re-queue them after `f` has been evaluated.\n\t */\n\tinterruptGetErr<R>(f: () => R): R;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as path from 'path';\nimport * as vscode from 'vscode';\nimport type * as Proto from '../protocol';\nimport * as PConst from '../protocol.const';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport API from '../utils/api';\nimport { conditionalRegistration, requireMinVersion, requireSomeCapability } from '../utils/dependentRegistration';\nimport { DocumentSelector } from '../utils/documentSelector';\nimport { parseKindModifier } from '../utils/modifiers';\nimport * as typeConverters from '../utils/typeConverters';\n\nclass TypeScriptCallHierarchySupport implements vscode.CallHierarchyProvider {\n\tpublic static readonly minVersion = API.v380;\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient\n\t) { }\n\n\tpublic async prepareCallHierarchy(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.CallHierarchyItem | vscode.CallHierarchyItem[] | undefined> {\n\t\tconst filepath = this.client.toOpenedFilePath(document);\n\t\tif (!filepath) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(filepath, position);\n\t\tconst response = await this.client.execute('prepareCallHierarchy', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn Array.isArray(response.body)\n\t\t\t? response.body.map(fromProtocolCallHierarchyItem)\n\t\t\t: fromProtocolCallHierarchyItem(response.body);\n\t}\n\n\tpublic async provideCallHierarchyIncomingCalls(item: vscode.CallHierarchyItem, token: vscode.CancellationToken): Promise<vscode.CallHierarchyIncomingCall[] | undefined> {\n\t\tconst filepath = this.client.toPath(item.uri);\n\t\tif (!filepath) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(filepath, item.selectionRange.start);\n\t\tconst response = await this.client.execute('provideCallHierarchyIncomingCalls', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn response.body.map(fromProtocolCallHierarchyIncomingCall);\n\t}\n\n\tpublic async provideCallHierarchyOutgoingCalls(item: vscode.CallHierarchyItem, token: vscode.CancellationToken): Promise<vscode.CallHierarchyOutgoingCall[] | undefined> {\n\t\tconst filepath = this.client.toPath(item.uri);\n\t\tif (!filepath) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(filepath, item.selectionRange.start);\n\t\tconst response = await this.client.execute('provideCallHierarchyOutgoingCalls', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn response.body.map(fromProtocolCallHierarchyOutgoingCall);\n\t}\n}\n\nfunction isSourceFileItem(item: Proto.CallHierarchyItem) {\n\treturn item.kind === PConst.Kind.script || item.kind === PConst.Kind.module && item.selectionSpan.start.line === 1 && item.selectionSpan.start.offset === 1;\n}\n\nfunction fromProtocolCallHierarchyItem(item: Proto.CallHierarchyItem): vscode.CallHierarchyItem {\n\tconst useFileName = isSourceFileItem(item);\n\tconst name = useFileName ? path.basename(item.file) : item.name;\n\tconst detail = useFileName ? vscode.workspace.asRelativePath(path.dirname(item.file)) : item.containerName ?? '';\n\tconst result = new vscode.CallHierarchyItem(\n\t\ttypeConverters.SymbolKind.fromProtocolScriptElementKind(item.kind),\n\t\tname,\n\t\tdetail,\n\t\tvscode.Uri.file(item.file),\n\t\ttypeConverters.Range.fromTextSpan(item.span),\n\t\ttypeConverters.Range.fromTextSpan(item.selectionSpan)\n\t);\n\n\tconst kindModifiers = item.kindModifiers ? parseKindModifier(item.kindModifiers) : undefined;\n\tif (kindModifiers?.has(PConst.KindModifiers.deprecated)) {\n\t\tresult.tags = [vscode.SymbolTag.Deprecated];\n\t}\n\treturn result;\n}\n\nfunction fromProtocolCallHierarchyIncomingCall(item: Proto.CallHierarchyIncomingCall): vscode.CallHierarchyIncomingCall {\n\treturn new vscode.CallHierarchyIncomingCall(\n\t\tfromProtocolCallHierarchyItem(item.from),\n\t\titem.fromSpans.map(typeConverters.Range.fromTextSpan)\n\t);\n}\n\nfunction fromProtocolCallHierarchyOutgoingCall(item: Proto.CallHierarchyOutgoingCall): vscode.CallHierarchyOutgoingCall {\n\treturn new vscode.CallHierarchyOutgoingCall(\n\t\tfromProtocolCallHierarchyItem(item.to),\n\t\titem.fromSpans.map(typeConverters.Range.fromTextSpan)\n\t);\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient\n) {\n\treturn conditionalRegistration([\n\t\trequireMinVersion(client, TypeScriptCallHierarchySupport.minVersion),\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerCallHierarchyProvider(selector.semantic,\n\t\t\tnew TypeScriptCallHierarchySupport(client));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport class Kind {\n\tpublic static readonly alias = 'alias';\n\tpublic static readonly callSignature = 'call';\n\tpublic static readonly class = 'class';\n\tpublic static readonly const = 'const';\n\tpublic static readonly constructorImplementation = 'constructor';\n\tpublic static readonly constructSignature = 'construct';\n\tpublic static readonly directory = 'directory';\n\tpublic static readonly enum = 'enum';\n\tpublic static readonly enumMember = 'enum member';\n\tpublic static readonly externalModuleName = 'external module name';\n\tpublic static readonly function = 'function';\n\tpublic static readonly indexSignature = 'index';\n\tpublic static readonly interface = 'interface';\n\tpublic static readonly keyword = 'keyword';\n\tpublic static readonly let = 'let';\n\tpublic static readonly localFunction = 'local function';\n\tpublic static readonly localVariable = 'local var';\n\tpublic static readonly method = 'method';\n\tpublic static readonly memberGetAccessor = 'getter';\n\tpublic static readonly memberSetAccessor = 'setter';\n\tpublic static readonly memberVariable = 'property';\n\tpublic static readonly module = 'module';\n\tpublic static readonly primitiveType = 'primitive type';\n\tpublic static readonly script = 'script';\n\tpublic static readonly type = 'type';\n\tpublic static readonly variable = 'var';\n\tpublic static readonly warning = 'warning';\n\tpublic static readonly string = 'string';\n\tpublic static readonly parameter = 'parameter';\n\tpublic static readonly typeParameter = 'type parameter';\n}\n\n\nexport class DiagnosticCategory {\n\tpublic static readonly error = 'error';\n\tpublic static readonly warning = 'warning';\n\tpublic static readonly suggestion = 'suggestion';\n}\n\nexport class KindModifiers {\n\tpublic static readonly optional = 'optional';\n\tpublic static readonly deprecated = 'deprecated';\n\tpublic static readonly color = 'color';\n\n\tpublic static readonly dtsFile = '.d.ts';\n\tpublic static readonly tsFile = '.ts';\n\tpublic static readonly tsxFile = '.tsx';\n\tpublic static readonly jsFile = '.js';\n\tpublic static readonly jsxFile = '.jsx';\n\tpublic static readonly jsonFile = '.json';\n\n\tpublic static readonly fileExtensionKindModifiers = [\n\t\tKindModifiers.dtsFile,\n\t\tKindModifiers.tsFile,\n\t\tKindModifiers.tsxFile,\n\t\tKindModifiers.jsFile,\n\t\tKindModifiers.jsxFile,\n\t\tKindModifiers.jsonFile,\n\t];\n}\n\nexport class DisplayPartKind {\n\tpublic static readonly functionName = 'functionName';\n\tpublic static readonly methodName = 'methodName';\n\tpublic static readonly parameterName = 'parameterName';\n\tpublic static readonly propertyName = 'propertyName';\n\tpublic static readonly punctuation = 'punctuation';\n\tpublic static readonly text = 'text';\n}\n\nexport enum EventName {\n\tsyntaxDiag = 'syntaxDiag',\n\tsemanticDiag = 'semanticDiag',\n\tsuggestionDiag = 'suggestionDiag',\n\tconfigFileDiag = 'configFileDiag',\n\ttelemetry = 'telemetry',\n\tprojectLanguageServiceState = 'projectLanguageServiceState',\n\tprojectsUpdatedInBackground = 'projectsUpdatedInBackground',\n\tbeginInstallTypes = 'beginInstallTypes',\n\tendInstallTypes = 'endInstallTypes',\n\ttypesInstallerInitializationFailed = 'typesInstallerInitializationFailed',\n\tsurveyReady = 'surveyReady',\n\tprojectLoadingStart = 'projectLoadingStart',\n\tprojectLoadingFinish = 'projectLoadingFinish',\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport API from './api';\nimport { Disposable } from './dispose';\n\nexport class Condition extends Disposable {\n\tprivate _value: boolean;\n\n\tconstructor(\n\t\tprivate readonly getValue: () => boolean,\n\t\tonUpdate: (handler: () => void) => void,\n\t) {\n\t\tsuper();\n\t\tthis._value = this.getValue();\n\n\t\tonUpdate(() => {\n\t\t\tconst newValue = this.getValue();\n\t\t\tif (newValue !== this._value) {\n\t\t\t\tthis._value = newValue;\n\t\t\t\tthis._onDidChange.fire();\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic get value(): boolean { return this._value; }\n\n\tprivate readonly _onDidChange = this._register(new vscode.EventEmitter<void>());\n\tpublic readonly onDidChange = this._onDidChange.event;\n}\n\nclass ConditionalRegistration {\n\tprivate registration: vscode.Disposable | undefined = undefined;\n\n\tpublic constructor(\n\t\tprivate readonly conditions: readonly Condition[],\n\t\tprivate readonly doRegister: () => vscode.Disposable\n\t) {\n\t\tfor (const condition of conditions) {\n\t\t\tcondition.onDidChange(() => this.update());\n\t\t}\n\t\tthis.update();\n\t}\n\n\tpublic dispose() {\n\t\tthis.registration?.dispose();\n\t\tthis.registration = undefined;\n\t}\n\n\tprivate update() {\n\t\tconst enabled = this.conditions.every(condition => condition.value);\n\t\tif (enabled) {\n\t\t\tif (!this.registration) {\n\t\t\t\tthis.registration = this.doRegister();\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.registration) {\n\t\t\t\tthis.registration.dispose();\n\t\t\t\tthis.registration = undefined;\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function conditionalRegistration(\n\tconditions: readonly Condition[],\n\tdoRegister: () => vscode.Disposable,\n): vscode.Disposable {\n\treturn new ConditionalRegistration(conditions, doRegister);\n}\n\nexport function requireMinVersion(\n\tclient: ITypeScriptServiceClient,\n\tminVersion: API,\n) {\n\treturn new Condition(\n\t\t() => client.apiVersion.gte(minVersion),\n\t\tclient.onTsServerStarted\n\t);\n}\n\nexport function requireConfiguration(\n\tlanguage: string,\n\tconfigValue: string,\n) {\n\treturn new Condition(\n\t\t() => {\n\t\t\tconst config = vscode.workspace.getConfiguration(language, null);\n\t\t\treturn !!config.get<boolean>(configValue);\n\t\t},\n\t\tvscode.workspace.onDidChangeConfiguration\n\t);\n}\n\nexport function requireSomeCapability(\n\tclient: ITypeScriptServiceClient,\n\t...capabilities: readonly ClientCapability[]\n) {\n\treturn new Condition(\n\t\t() => capabilities.some(requiredCapability => client.capabilities.has(requiredCapability)),\n\t\tclient.onDidChangeCapabilities\n\t);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport function parseKindModifier(kindModifiers: string): Set<string> {\n\treturn new Set(kindModifiers.split(/,|\\s+/g));\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n/**\n * Helpers for converting FROM vscode types TO ts types\n */\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../protocol';\nimport * as PConst from '../protocol.const';\nimport { ITypeScriptServiceClient } from '../typescriptService';\n\nexport namespace Range {\n\texport const fromTextSpan = (span: Proto.TextSpan): vscode.Range =>\n\t\tfromLocations(span.start, span.end);\n\n\texport const toTextSpan = (range: vscode.Range): Proto.TextSpan => ({\n\t\tstart: Position.toLocation(range.start),\n\t\tend: Position.toLocation(range.end)\n\t});\n\n\texport const fromLocations = (start: Proto.Location, end: Proto.Location): vscode.Range =>\n\t\tnew vscode.Range(\n\t\t\tMath.max(0, start.line - 1), Math.max(start.offset - 1, 0),\n\t\t\tMath.max(0, end.line - 1), Math.max(0, end.offset - 1));\n\n\texport const toFileRangeRequestArgs = (file: string, range: vscode.Range): Proto.FileRangeRequestArgs => ({\n\t\tfile,\n\t\tstartLine: range.start.line + 1,\n\t\tstartOffset: range.start.character + 1,\n\t\tendLine: range.end.line + 1,\n\t\tendOffset: range.end.character + 1\n\t});\n\n\texport const toFormattingRequestArgs = (file: string, range: vscode.Range): Proto.FormatRequestArgs => ({\n\t\tfile,\n\t\tline: range.start.line + 1,\n\t\toffset: range.start.character + 1,\n\t\tendLine: range.end.line + 1,\n\t\tendOffset: range.end.character + 1\n\t});\n}\n\nexport namespace Position {\n\texport const fromLocation = (tslocation: Proto.Location): vscode.Position =>\n\t\tnew vscode.Position(tslocation.line - 1, tslocation.offset - 1);\n\n\texport const toLocation = (vsPosition: vscode.Position): Proto.Location => ({\n\t\tline: vsPosition.line + 1,\n\t\toffset: vsPosition.character + 1,\n\t});\n\n\texport const toFileLocationRequestArgs = (file: string, position: vscode.Position): Proto.FileLocationRequestArgs => ({\n\t\tfile,\n\t\tline: position.line + 1,\n\t\toffset: position.character + 1,\n\t});\n}\n\nexport namespace Location {\n\texport const fromTextSpan = (resource: vscode.Uri, tsTextSpan: Proto.TextSpan): vscode.Location =>\n\t\tnew vscode.Location(resource, Range.fromTextSpan(tsTextSpan));\n}\n\nexport namespace TextEdit {\n\texport const fromCodeEdit = (edit: Proto.CodeEdit): vscode.TextEdit =>\n\t\tnew vscode.TextEdit(\n\t\t\tRange.fromTextSpan(edit),\n\t\t\tedit.newText);\n}\n\nexport namespace WorkspaceEdit {\n\texport function fromFileCodeEdits(\n\t\tclient: ITypeScriptServiceClient,\n\t\tedits: Iterable<Proto.FileCodeEdits>\n\t): vscode.WorkspaceEdit {\n\t\treturn withFileCodeEdits(new vscode.WorkspaceEdit(), client, edits);\n\t}\n\n\texport function withFileCodeEdits(\n\t\tworkspaceEdit: vscode.WorkspaceEdit,\n\t\tclient: ITypeScriptServiceClient,\n\t\tedits: Iterable<Proto.FileCodeEdits>\n\t): vscode.WorkspaceEdit {\n\t\tfor (const edit of edits) {\n\t\t\tconst resource = client.toResource(edit.fileName);\n\t\t\tfor (const textChange of edit.textChanges) {\n\t\t\t\tworkspaceEdit.replace(resource,\n\t\t\t\t\tRange.fromTextSpan(textChange),\n\t\t\t\t\ttextChange.newText);\n\t\t\t}\n\t\t}\n\n\t\treturn workspaceEdit;\n\t}\n}\n\nexport namespace SymbolKind {\n\texport function fromProtocolScriptElementKind(kind: Proto.ScriptElementKind) {\n\t\tswitch (kind) {\n\t\t\tcase PConst.Kind.module: return vscode.SymbolKind.Module;\n\t\t\tcase PConst.Kind.class: return vscode.SymbolKind.Class;\n\t\t\tcase PConst.Kind.enum: return vscode.SymbolKind.Enum;\n\t\t\tcase PConst.Kind.enumMember: return vscode.SymbolKind.EnumMember;\n\t\t\tcase PConst.Kind.interface: return vscode.SymbolKind.Interface;\n\t\t\tcase PConst.Kind.indexSignature: return vscode.SymbolKind.Method;\n\t\t\tcase PConst.Kind.callSignature: return vscode.SymbolKind.Method;\n\t\t\tcase PConst.Kind.method: return vscode.SymbolKind.Method;\n\t\t\tcase PConst.Kind.memberVariable: return vscode.SymbolKind.Property;\n\t\t\tcase PConst.Kind.memberGetAccessor: return vscode.SymbolKind.Property;\n\t\t\tcase PConst.Kind.memberSetAccessor: return vscode.SymbolKind.Property;\n\t\t\tcase PConst.Kind.variable: return vscode.SymbolKind.Variable;\n\t\t\tcase PConst.Kind.let: return vscode.SymbolKind.Variable;\n\t\t\tcase PConst.Kind.const: return vscode.SymbolKind.Variable;\n\t\t\tcase PConst.Kind.localVariable: return vscode.SymbolKind.Variable;\n\t\t\tcase PConst.Kind.alias: return vscode.SymbolKind.Variable;\n\t\t\tcase PConst.Kind.function: return vscode.SymbolKind.Function;\n\t\t\tcase PConst.Kind.localFunction: return vscode.SymbolKind.Function;\n\t\t\tcase PConst.Kind.constructSignature: return vscode.SymbolKind.Constructor;\n\t\t\tcase PConst.Kind.constructorImplementation: return vscode.SymbolKind.Constructor;\n\t\t\tcase PConst.Kind.typeParameter: return vscode.SymbolKind.TypeParameter;\n\t\t\tcase PConst.Kind.string: return vscode.SymbolKind.String;\n\t\t\tdefault: return vscode.SymbolKind.Variable;\n\t\t}\n\t}\n}\n\nexport namespace CompletionTriggerKind {\n\texport function toProtocolCompletionTriggerKind(kind: vscode.CompletionTriggerKind): Proto.CompletionTriggerKind {\n\t\tswitch (kind) {\n\t\t\tcase vscode.CompletionTriggerKind.Invoke: return 1;\n\t\t\tcase vscode.CompletionTriggerKind.TriggerCharacter: return 2;\n\t\t\tcase vscode.CompletionTriggerKind.TriggerForIncompleteCompletions: return 3;\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as nls from 'vscode-nls';\nimport type * as Proto from '../../protocol';\nimport * as PConst from '../../protocol.const';\nimport { CachedResponse } from '../../tsServer/cachedResponse';\nimport { ClientCapability, ITypeScriptServiceClient } from '../../typescriptService';\nimport { conditionalRegistration, requireConfiguration, requireSomeCapability } from '../../utils/dependentRegistration';\nimport { DocumentSelector } from '../../utils/documentSelector';\nimport * as typeConverters from '../../utils/typeConverters';\nimport { getSymbolRange, ReferencesCodeLens, TypeScriptBaseCodeLensProvider } from './baseCodeLensProvider';\n\nconst localize = nls.loadMessageBundle();\n\nexport default class TypeScriptImplementationsCodeLensProvider extends TypeScriptBaseCodeLensProvider {\n\n\tpublic async resolveCodeLens(\n\t\tcodeLens: ReferencesCodeLens,\n\t\ttoken: vscode.CancellationToken,\n\t): Promise<vscode.CodeLens> {\n\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(codeLens.file, codeLens.range.start);\n\t\tconst response = await this.client.execute('implementation', args, token, { lowPriority: true, cancelOnResourceChange: codeLens.document });\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\tcodeLens.command = response.type === 'cancelled'\n\t\t\t\t? TypeScriptBaseCodeLensProvider.cancelledCommand\n\t\t\t\t: TypeScriptBaseCodeLensProvider.errorCommand;\n\t\t\treturn codeLens;\n\t\t}\n\n\t\tconst locations = response.body\n\t\t\t.map(reference =>\n\t\t\t\t// Only take first line on implementation: https://github.com/microsoft/vscode/issues/23924\n\t\t\t\tnew vscode.Location(this.client.toResource(reference.file),\n\t\t\t\t\treference.start.line === reference.end.line\n\t\t\t\t\t\t? typeConverters.Range.fromTextSpan(reference)\n\t\t\t\t\t\t: new vscode.Range(\n\t\t\t\t\t\t\ttypeConverters.Position.fromLocation(reference.start),\n\t\t\t\t\t\t\tnew vscode.Position(reference.start.line, 0))))\n\t\t\t// Exclude original from implementations\n\t\t\t.filter(location =>\n\t\t\t\t!(location.uri.toString() === codeLens.document.toString() &&\n\t\t\t\t\tlocation.range.start.line === codeLens.range.start.line &&\n\t\t\t\t\tlocation.range.start.character === codeLens.range.start.character));\n\n\t\tcodeLens.command = this.getCommand(locations, codeLens);\n\t\treturn codeLens;\n\t}\n\n\tprivate getCommand(locations: vscode.Location[], codeLens: ReferencesCodeLens): vscode.Command | undefined {\n\t\treturn {\n\t\t\ttitle: this.getTitle(locations),\n\t\t\tcommand: locations.length ? 'editor.action.showReferences' : '',\n\t\t\targuments: [codeLens.document, codeLens.range.start, locations]\n\t\t};\n\t}\n\n\tprivate getTitle(locations: vscode.Location[]): string {\n\t\treturn locations.length === 1\n\t\t\t? localize('oneImplementationLabel', '1 implementation')\n\t\t\t: localize('manyImplementationLabel', '{0} implementations', locations.length);\n\t}\n\n\tprotected extractSymbol(\n\t\tdocument: vscode.TextDocument,\n\t\titem: Proto.NavigationTree,\n\t\t_parent: Proto.NavigationTree | null\n\t): vscode.Range | null {\n\t\tswitch (item.kind) {\n\t\t\tcase PConst.Kind.interface:\n\t\t\t\treturn getSymbolRange(document, item);\n\n\t\t\tcase PConst.Kind.class:\n\t\t\tcase PConst.Kind.method:\n\t\t\tcase PConst.Kind.memberVariable:\n\t\t\tcase PConst.Kind.memberGetAccessor:\n\t\t\tcase PConst.Kind.memberSetAccessor:\n\t\t\t\tif (item.kindModifiers.match(/\\babstract\\b/g)) {\n\t\t\t\t\treturn getSymbolRange(document, item);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t\treturn null;\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tmodeId: string,\n\tclient: ITypeScriptServiceClient,\n\tcachedResponse: CachedResponse<Proto.NavTreeResponse>,\n) {\n\treturn conditionalRegistration([\n\t\trequireConfiguration(modeId, 'implementationsCodeLens.enabled'),\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerCodeLensProvider(selector.semantic,\n\t\t\tnew TypeScriptImplementationsCodeLensProvider(client, cachedResponse));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as nls from 'vscode-nls';\nimport type * as Proto from '../../protocol';\nimport { CachedResponse } from '../../tsServer/cachedResponse';\nimport { ITypeScriptServiceClient } from '../../typescriptService';\nimport { escapeRegExp } from '../../utils/regexp';\nimport * as typeConverters from '../../utils/typeConverters';\n\nconst localize = nls.loadMessageBundle();\n\nexport class ReferencesCodeLens extends vscode.CodeLens {\n\tconstructor(\n\t\tpublic document: vscode.Uri,\n\t\tpublic file: string,\n\t\trange: vscode.Range\n\t) {\n\t\tsuper(range);\n\t}\n}\n\nexport abstract class TypeScriptBaseCodeLensProvider implements vscode.CodeLensProvider<ReferencesCodeLens> {\n\n\tpublic static readonly cancelledCommand: vscode.Command = {\n\t\t// Cancellation is not an error. Just show nothing until we can properly re-compute the code lens\n\t\ttitle: '',\n\t\tcommand: ''\n\t};\n\n\tpublic static readonly errorCommand: vscode.Command = {\n\t\ttitle: localize('referenceErrorLabel', 'Could not determine references'),\n\t\tcommand: ''\n\t};\n\n\tprivate onDidChangeCodeLensesEmitter = new vscode.EventEmitter<void>();\n\n\tpublic constructor(\n\t\tprotected client: ITypeScriptServiceClient,\n\t\tprivate cachedResponse: CachedResponse<Proto.NavTreeResponse>\n\t) { }\n\n\tpublic get onDidChangeCodeLenses(): vscode.Event<void> {\n\t\treturn this.onDidChangeCodeLensesEmitter.event;\n\t}\n\n\tasync provideCodeLenses(document: vscode.TextDocument, token: vscode.CancellationToken): Promise<ReferencesCodeLens[]> {\n\t\tconst filepath = this.client.toOpenedFilePath(document);\n\t\tif (!filepath) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst response = await this.cachedResponse.execute(document, () => this.client.execute('navtree', { file: filepath }, token));\n\t\tif (response.type !== 'response') {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst tree = response.body;\n\t\tconst referenceableSpans: vscode.Range[] = [];\n\t\tif (tree && tree.childItems) {\n\t\t\ttree.childItems.forEach(item => this.walkNavTree(document, item, null, referenceableSpans));\n\t\t}\n\t\treturn referenceableSpans.map(span => new ReferencesCodeLens(document.uri, filepath, span));\n\t}\n\n\tprotected abstract extractSymbol(\n\t\tdocument: vscode.TextDocument,\n\t\titem: Proto.NavigationTree,\n\t\tparent: Proto.NavigationTree | null\n\t): vscode.Range | null;\n\n\tprivate walkNavTree(\n\t\tdocument: vscode.TextDocument,\n\t\titem: Proto.NavigationTree,\n\t\tparent: Proto.NavigationTree | null,\n\t\tresults: vscode.Range[]\n\t): void {\n\t\tif (!item) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst range = this.extractSymbol(document, item, parent);\n\t\tif (range) {\n\t\t\tresults.push(range);\n\t\t}\n\n\t\t(item.childItems || []).forEach(child => this.walkNavTree(document, child, item, results));\n\t}\n}\n\nexport function getSymbolRange(\n\tdocument: vscode.TextDocument,\n\titem: Proto.NavigationTree\n): vscode.Range | null {\n\tif (item.nameSpan) {\n\t\treturn typeConverters.Range.fromTextSpan(item.nameSpan);\n\t}\n\n\t// In older versions, we have to calculate this manually. See #23924\n\tconst span = item.spans && item.spans[0];\n\tif (!span) {\n\t\treturn null;\n\t}\n\n\tconst range = typeConverters.Range.fromTextSpan(span);\n\tconst text = document.getText(range);\n\n\tconst identifierMatch = new RegExp(`^(.*?(\\\\b|\\\\W))${escapeRegExp(item.text || '')}(\\\\b|\\\\W)`, 'gm');\n\tconst match = identifierMatch.exec(text);\n\tconst prefixLength = match ? match.index + match[1].length : 0;\n\tconst startOffset = document.offsetAt(new vscode.Position(range.start.line, range.start.character)) + prefixLength;\n\treturn new vscode.Range(\n\t\tdocument.positionAt(startOffset),\n\t\tdocument.positionAt(startOffset + item.text.length));\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport function escapeRegExp(text: string) {\n\treturn text.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&');\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as nls from 'vscode-nls';\nimport type * as Proto from '../../protocol';\nimport * as PConst from '../../protocol.const';\nimport { CachedResponse } from '../../tsServer/cachedResponse';\nimport { ExecutionTarget } from '../../tsServer/server';\nimport { ClientCapability, ITypeScriptServiceClient } from '../../typescriptService';\nimport { conditionalRegistration, requireConfiguration, requireSomeCapability } from '../../utils/dependentRegistration';\nimport { DocumentSelector } from '../../utils/documentSelector';\nimport * as typeConverters from '../../utils/typeConverters';\nimport { getSymbolRange, ReferencesCodeLens, TypeScriptBaseCodeLensProvider } from './baseCodeLensProvider';\n\nconst localize = nls.loadMessageBundle();\n\nexport class TypeScriptReferencesCodeLensProvider extends TypeScriptBaseCodeLensProvider {\n\tpublic constructor(\n\t\tclient: ITypeScriptServiceClient,\n\t\tprotected _cachedResponse: CachedResponse<Proto.NavTreeResponse>,\n\t\tprivate modeId: string\n\t) {\n\t\tsuper(client, _cachedResponse);\n\t}\n\n\tpublic async resolveCodeLens(codeLens: ReferencesCodeLens, token: vscode.CancellationToken): Promise<vscode.CodeLens> {\n\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(codeLens.file, codeLens.range.start);\n\t\tconst response = await this.client.execute('references', args, token, {\n\t\t\tlowPriority: true,\n\t\t\texecutionTarget: ExecutionTarget.Semantic,\n\t\t\tcancelOnResourceChange: codeLens.document,\n\t\t});\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\tcodeLens.command = response.type === 'cancelled'\n\t\t\t\t? TypeScriptBaseCodeLensProvider.cancelledCommand\n\t\t\t\t: TypeScriptBaseCodeLensProvider.errorCommand;\n\t\t\treturn codeLens;\n\t\t}\n\n\t\tconst locations = response.body.refs\n\t\t\t.filter(reference => !reference.isDefinition)\n\t\t\t.map(reference =>\n\t\t\t\ttypeConverters.Location.fromTextSpan(this.client.toResource(reference.file), reference));\n\n\t\tcodeLens.command = {\n\t\t\ttitle: this.getCodeLensLabel(locations),\n\t\t\tcommand: locations.length ? 'editor.action.showReferences' : '',\n\t\t\targuments: [codeLens.document, codeLens.range.start, locations]\n\t\t};\n\t\treturn codeLens;\n\t}\n\n\tprivate getCodeLensLabel(locations: ReadonlyArray<vscode.Location>): string {\n\t\treturn locations.length === 1\n\t\t\t? localize('oneReferenceLabel', '1 reference')\n\t\t\t: localize('manyReferenceLabel', '{0} references', locations.length);\n\t}\n\n\tprotected extractSymbol(\n\t\tdocument: vscode.TextDocument,\n\t\titem: Proto.NavigationTree,\n\t\tparent: Proto.NavigationTree | null\n\t): vscode.Range | null {\n\t\tif (parent && parent.kind === PConst.Kind.enum) {\n\t\t\treturn getSymbolRange(document, item);\n\t\t}\n\n\t\tswitch (item.kind) {\n\t\t\tcase PConst.Kind.function:\n\t\t\t\tconst showOnAllFunctions = vscode.workspace.getConfiguration(this.modeId).get<boolean>('referencesCodeLens.showOnAllFunctions');\n\t\t\t\tif (showOnAllFunctions) {\n\t\t\t\t\treturn getSymbolRange(document, item);\n\t\t\t\t}\n\t\t\t// fallthrough\n\n\t\t\tcase PConst.Kind.const:\n\t\t\tcase PConst.Kind.let:\n\t\t\tcase PConst.Kind.variable:\n\t\t\t\t// Only show references for exported variables\n\t\t\t\tif (/\\bexport\\b/.test(item.kindModifiers)) {\n\t\t\t\t\treturn getSymbolRange(document, item);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase PConst.Kind.class:\n\t\t\t\tif (item.text === '<class>') {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\treturn getSymbolRange(document, item);\n\n\t\t\tcase PConst.Kind.interface:\n\t\t\tcase PConst.Kind.type:\n\t\t\tcase PConst.Kind.enum:\n\t\t\t\treturn getSymbolRange(document, item);\n\n\t\t\tcase PConst.Kind.method:\n\t\t\tcase PConst.Kind.memberGetAccessor:\n\t\t\tcase PConst.Kind.memberSetAccessor:\n\t\t\tcase PConst.Kind.constructorImplementation:\n\t\t\tcase PConst.Kind.memberVariable:\n\t\t\t\t// Don't show if child and parent have same start\n\t\t\t\t// For https://github.com/microsoft/vscode/issues/90396\n\t\t\t\tif (parent &&\n\t\t\t\t\ttypeConverters.Position.fromLocation(parent.spans[0].start).isEqual(typeConverters.Position.fromLocation(item.spans[0].start))\n\t\t\t\t) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\t// Only show if parent is a class type object (not a literal)\n\t\t\t\tswitch (parent?.kind) {\n\t\t\t\t\tcase PConst.Kind.class:\n\t\t\t\t\tcase PConst.Kind.interface:\n\t\t\t\t\tcase PConst.Kind.type:\n\t\t\t\t\t\treturn getSymbolRange(document, item);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn null;\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tmodeId: string,\n\tclient: ITypeScriptServiceClient,\n\tcachedResponse: CachedResponse<Proto.NavTreeResponse>,\n) {\n\treturn conditionalRegistration([\n\t\trequireConfiguration(modeId, 'referencesCodeLens.enabled'),\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerCodeLensProvider(selector.semantic,\n\t\t\tnew TypeScriptReferencesCodeLensProvider(client, cachedResponse, modeId));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../protocol';\nimport { EventName } from '../protocol.const';\nimport { CallbackMap } from '../tsServer/callbackMap';\nimport { RequestItem, RequestQueue, RequestQueueingType } from '../tsServer/requestQueue';\nimport { TypeScriptServerError } from '../tsServer/serverError';\nimport { ServerResponse, ServerType, TypeScriptRequests } from '../typescriptService';\nimport { TypeScriptServiceConfiguration } from '../utils/configuration';\nimport { Disposable } from '../utils/dispose';\nimport { TelemetryReporter } from '../utils/telemetry';\nimport Tracer from '../utils/tracer';\nimport { OngoingRequestCanceller } from './cancellation';\nimport { TypeScriptVersionManager } from './versionManager';\nimport { TypeScriptVersion } from './versionProvider';\n\nexport enum ExecutionTarget {\n\tSemantic,\n\tSyntax\n}\n\nexport interface TypeScriptServerExitEvent {\n\treadonly code: number | null;\n\treadonly signal: string | null;\n}\n\nexport interface ITypeScriptServer {\n\treadonly onEvent: vscode.Event<Proto.Event>;\n\treadonly onExit: vscode.Event<TypeScriptServerExitEvent>;\n\treadonly onError: vscode.Event<any>;\n\n\treadonly tsServerLogFile: string | undefined;\n\n\tkill(): void;\n\n\t/**\n\t * @return A list of all execute requests. If there are multiple entries, the first item is the primary\n\t * request while the rest are secondary ones.\n\t */\n\texecuteImpl(command: keyof TypeScriptRequests, args: any, executeInfo: { isAsync: boolean, token?: vscode.CancellationToken, expectsResult: boolean, lowPriority?: boolean, executionTarget?: ExecutionTarget }): Array<Promise<ServerResponse.Response<Proto.Response>> | undefined>;\n\n\tdispose(): void;\n}\n\nexport interface TsServerDelegate {\n\tonFatalError(command: string, error: Error): void;\n}\n\nexport const enum TsServerProcessKind {\n\tMain = 'main',\n\tSyntax = 'syntax',\n\tSemantic = 'semantic',\n\tDiagnostics = 'diagnostics'\n}\n\nexport interface TsServerProcessFactory {\n\tfork(\n\t\ttsServerPath: string,\n\t\targs: readonly string[],\n\t\tkind: TsServerProcessKind,\n\t\tconfiguration: TypeScriptServiceConfiguration,\n\t\tversionManager: TypeScriptVersionManager,\n\t): TsServerProcess;\n}\n\nexport interface TsServerProcess {\n\twrite(serverRequest: Proto.Request): void;\n\n\tonData(handler: (data: Proto.Response) => void): void;\n\tonExit(handler: (code: number | null, signal: string | null) => void): void;\n\tonError(handler: (error: Error) => void): void;\n\n\tkill(): void;\n}\n\nexport class ProcessBasedTsServer extends Disposable implements ITypeScriptServer {\n\tprivate readonly _requestQueue = new RequestQueue();\n\tprivate readonly _callbacks = new CallbackMap<Proto.Response>();\n\tprivate readonly _pendingResponses = new Set<number>();\n\n\tconstructor(\n\t\tprivate readonly _serverId: string,\n\t\tprivate readonly _serverSource: ServerType,\n\t\tprivate readonly _process: TsServerProcess,\n\t\tprivate readonly _tsServerLogFile: string | undefined,\n\t\tprivate readonly _requestCanceller: OngoingRequestCanceller,\n\t\tprivate readonly _version: TypeScriptVersion,\n\t\tprivate readonly _telemetryReporter: TelemetryReporter,\n\t\tprivate readonly _tracer: Tracer,\n\t) {\n\t\tsuper();\n\n\t\tthis._process.onData(msg => {\n\t\t\tthis.dispatchMessage(msg);\n\t\t});\n\n\t\tthis._process.onExit((code, signal) => {\n\t\t\tthis._onExit.fire({ code, signal });\n\t\t\tthis._callbacks.destroy('server exited');\n\t\t});\n\n\t\tthis._process.onError(error => {\n\t\t\tthis._onError.fire(error);\n\t\t\tthis._callbacks.destroy('server errored');\n\t\t});\n\t}\n\n\tprivate readonly _onEvent = this._register(new vscode.EventEmitter<Proto.Event>());\n\tpublic readonly onEvent = this._onEvent.event;\n\n\tprivate readonly _onExit = this._register(new vscode.EventEmitter<TypeScriptServerExitEvent>());\n\tpublic readonly onExit = this._onExit.event;\n\n\tprivate readonly _onError = this._register(new vscode.EventEmitter<any>());\n\tpublic readonly onError = this._onError.event;\n\n\tpublic get tsServerLogFile() { return this._tsServerLogFile; }\n\n\tprivate write(serverRequest: Proto.Request) {\n\t\tthis._process.write(serverRequest);\n\t}\n\n\tpublic override dispose() {\n\t\tsuper.dispose();\n\t\tthis._callbacks.destroy('server disposed');\n\t\tthis._pendingResponses.clear();\n\t}\n\n\tpublic kill() {\n\t\tthis._process.kill();\n\t}\n\n\tprivate dispatchMessage(message: Proto.Message) {\n\t\ttry {\n\t\t\tswitch (message.type) {\n\t\t\t\tcase 'response':\n\t\t\t\t\tif (this._serverSource) {\n\t\t\t\t\t\tthis.dispatchResponse({\n\t\t\t\t\t\t\t...(message as Proto.Response),\n\t\t\t\t\t\t\t_serverType: this._serverSource\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.dispatchResponse(message as Proto.Response);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'event':\n\t\t\t\t\tconst event = message as Proto.Event;\n\t\t\t\t\tif (event.event === 'requestCompleted') {\n\t\t\t\t\t\tconst seq = (event as Proto.RequestCompletedEvent).body.request_seq;\n\t\t\t\t\t\tconst callback = this._callbacks.fetch(seq);\n\t\t\t\t\t\tif (callback) {\n\t\t\t\t\t\t\tthis._tracer.traceRequestCompleted(this._serverId, 'requestCompleted', seq, callback);\n\t\t\t\t\t\t\tcallback.onSuccess(undefined);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._tracer.traceEvent(this._serverId, event);\n\t\t\t\t\t\tthis._onEvent.fire(event);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error(`Unknown message type ${message.type} received`);\n\t\t\t}\n\t\t} finally {\n\t\t\tthis.sendNextRequests();\n\t\t}\n\t}\n\n\tprivate tryCancelRequest(seq: number, command: string): boolean {\n\t\ttry {\n\t\t\tif (this._requestQueue.tryDeletePendingRequest(seq)) {\n\t\t\t\tthis.logTrace(`Canceled request with sequence number ${seq}`);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (this._requestCanceller.tryCancelOngoingRequest(seq)) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.logTrace(`Tried to cancel request with sequence number ${seq}. But request got already delivered.`);\n\t\t\treturn false;\n\t\t} finally {\n\t\t\tconst callback = this.fetchCallback(seq);\n\t\t\tif (callback) {\n\t\t\t\tcallback.onSuccess(new ServerResponse.Cancelled(`Cancelled request ${seq} - ${command}`));\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate dispatchResponse(response: Proto.Response) {\n\t\tconst callback = this.fetchCallback(response.request_seq);\n\t\tif (!callback) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._tracer.traceResponse(this._serverId, response, callback);\n\t\tif (response.success) {\n\t\t\tcallback.onSuccess(response);\n\t\t} else if (response.message === 'No content available.') {\n\t\t\t// Special case where response itself is successful but there is not any data to return.\n\t\t\tcallback.onSuccess(ServerResponse.NoContent);\n\t\t} else {\n\t\t\tcallback.onError(TypeScriptServerError.create(this._serverId, this._version, response));\n\t\t}\n\t}\n\n\tpublic executeImpl(command: keyof TypeScriptRequests, args: any, executeInfo: { isAsync: boolean, token?: vscode.CancellationToken, expectsResult: boolean, lowPriority?: boolean, executionTarget?: ExecutionTarget }): Array<Promise<ServerResponse.Response<Proto.Response>> | undefined> {\n\t\tconst request = this._requestQueue.createRequest(command, args);\n\t\tconst requestInfo: RequestItem = {\n\t\t\trequest,\n\t\t\texpectsResponse: executeInfo.expectsResult,\n\t\t\tisAsync: executeInfo.isAsync,\n\t\t\tqueueingType: ProcessBasedTsServer.getQueueingType(command, executeInfo.lowPriority)\n\t\t};\n\t\tlet result: Promise<ServerResponse.Response<Proto.Response>> | undefined;\n\t\tif (executeInfo.expectsResult) {\n\t\t\tresult = new Promise<ServerResponse.Response<Proto.Response>>((resolve, reject) => {\n\t\t\t\tthis._callbacks.add(request.seq, { onSuccess: resolve as () => ServerResponse.Response<Proto.Response> | undefined, onError: reject, queuingStartTime: Date.now(), isAsync: executeInfo.isAsync }, executeInfo.isAsync);\n\n\t\t\t\tif (executeInfo.token) {\n\t\t\t\t\texecuteInfo.token.onCancellationRequested(() => {\n\t\t\t\t\t\tthis.tryCancelRequest(request.seq, command);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}).catch((err: Error) => {\n\t\t\t\tif (err instanceof TypeScriptServerError) {\n\t\t\t\t\tif (!executeInfo.token || !executeInfo.token.isCancellationRequested) {\n\t\t\t\t\t\t/* __GDPR__\n\t\t\t\t\t\t\t\"languageServiceErrorResponse\" : {\n\t\t\t\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\t\t\t\"${TypeScriptCommonProperties}\",\n\t\t\t\t\t\t\t\t\t\"${TypeScriptRequestErrorProperties}\"\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tthis._telemetryReporter.logTelemetry('languageServiceErrorResponse', err.telemetry);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthrow err;\n\t\t\t});\n\t\t}\n\n\t\tthis._requestQueue.enqueue(requestInfo);\n\t\tthis.sendNextRequests();\n\n\t\treturn [result];\n\t}\n\n\tprivate sendNextRequests(): void {\n\t\twhile (this._pendingResponses.size === 0 && this._requestQueue.length > 0) {\n\t\t\tconst item = this._requestQueue.dequeue();\n\t\t\tif (item) {\n\t\t\t\tthis.sendRequest(item);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate sendRequest(requestItem: RequestItem): void {\n\t\tconst serverRequest = requestItem.request;\n\t\tthis._tracer.traceRequest(this._serverId, serverRequest, requestItem.expectsResponse, this._requestQueue.length);\n\n\t\tif (requestItem.expectsResponse && !requestItem.isAsync) {\n\t\t\tthis._pendingResponses.add(requestItem.request.seq);\n\t\t}\n\n\t\ttry {\n\t\t\tthis.write(serverRequest);\n\t\t} catch (err) {\n\t\t\tconst callback = this.fetchCallback(serverRequest.seq);\n\t\t\tif (callback) {\n\t\t\t\tcallback.onError(err);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate fetchCallback(seq: number) {\n\t\tconst callback = this._callbacks.fetch(seq);\n\t\tif (!callback) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tthis._pendingResponses.delete(seq);\n\t\treturn callback;\n\t}\n\n\tprivate logTrace(message: string) {\n\t\tthis._tracer.logTrace(this._serverId, message);\n\t}\n\n\tprivate static readonly fenceCommands = new Set(['change', 'close', 'open', 'updateOpen']);\n\n\tprivate static getQueueingType(\n\t\tcommand: string,\n\t\tlowPriority?: boolean\n\t): RequestQueueingType {\n\t\tif (ProcessBasedTsServer.fenceCommands.has(command)) {\n\t\t\treturn RequestQueueingType.Fence;\n\t\t}\n\t\treturn lowPriority ? RequestQueueingType.LowPriority : RequestQueueingType.Normal;\n\t}\n}\n\n\ninterface ExecuteInfo {\n\treadonly isAsync: boolean;\n\treadonly token?: vscode.CancellationToken;\n\treadonly expectsResult: boolean;\n\treadonly lowPriority?: boolean;\n\treadonly executionTarget?: ExecutionTarget;\n}\n\nclass RequestRouter {\n\n\tprivate static readonly sharedCommands = new Set<keyof TypeScriptRequests>([\n\t\t'change',\n\t\t'close',\n\t\t'open',\n\t\t'updateOpen',\n\t\t'configure',\n\t]);\n\n\tconstructor(\n\t\tprivate readonly servers: ReadonlyArray<{\n\t\t\treadonly server: ITypeScriptServer;\n\t\t\tcanRun?(command: keyof TypeScriptRequests, executeInfo: ExecuteInfo): void;\n\t\t}>,\n\t\tprivate readonly delegate: TsServerDelegate,\n\t) { }\n\n\tpublic execute(\n\t\tcommand: keyof TypeScriptRequests,\n\t\targs: any,\n\t\texecuteInfo: ExecuteInfo,\n\t): Array<Promise<ServerResponse.Response<Proto.Response>> | undefined> {\n\t\tif (RequestRouter.sharedCommands.has(command) && typeof executeInfo.executionTarget === 'undefined') {\n\t\t\t// Dispatch shared commands to all servers but use first one as the primary response\n\n\t\t\tconst requestStates: RequestState.State[] = this.servers.map(() => RequestState.Unresolved);\n\n\t\t\t// Also make sure we never cancel requests to just one server\n\t\t\tlet token: vscode.CancellationToken | undefined = undefined;\n\t\t\tif (executeInfo.token) {\n\t\t\t\tconst source = new vscode.CancellationTokenSource();\n\t\t\t\texecuteInfo.token.onCancellationRequested(() => {\n\t\t\t\t\tif (requestStates.some(state => state === RequestState.Resolved)) {\n\t\t\t\t\t\t// Don't cancel.\n\t\t\t\t\t\t// One of the servers completed this request so we don't want to leave the other\n\t\t\t\t\t\t// in a different state.\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tsource.cancel();\n\t\t\t\t});\n\t\t\t\ttoken = source.token;\n\t\t\t}\n\n\t\t\tconst allRequests: Array<Promise<ServerResponse.Response<Proto.Response>> | undefined> = [];\n\n\t\t\tfor (let serverIndex = 0; serverIndex < this.servers.length; ++serverIndex) {\n\t\t\t\tconst server = this.servers[serverIndex].server;\n\n\t\t\t\tconst request = server.executeImpl(command, args, { ...executeInfo, token })[0];\n\t\t\t\tallRequests.push(request);\n\t\t\t\tif (request) {\n\t\t\t\t\trequest\n\t\t\t\t\t\t.then(result => {\n\t\t\t\t\t\t\trequestStates[serverIndex] = RequestState.Resolved;\n\t\t\t\t\t\t\tconst erroredRequest = requestStates.find(state => state.type === RequestState.Type.Errored) as RequestState.Errored | undefined;\n\t\t\t\t\t\t\tif (erroredRequest) {\n\t\t\t\t\t\t\t\t// We've gone out of sync\n\t\t\t\t\t\t\t\tthis.delegate.onFatalError(command, erroredRequest.err);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn result;\n\t\t\t\t\t\t}, err => {\n\t\t\t\t\t\t\trequestStates[serverIndex] = new RequestState.Errored(err);\n\t\t\t\t\t\t\tif (requestStates.some(state => state === RequestState.Resolved)) {\n\t\t\t\t\t\t\t\t// We've gone out of sync\n\t\t\t\t\t\t\t\tthis.delegate.onFatalError(command, err);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthrow err;\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn allRequests;\n\t\t}\n\n\t\tfor (const { canRun, server } of this.servers) {\n\t\t\tif (!canRun || canRun(command, executeInfo)) {\n\t\t\t\treturn server.executeImpl(command, args, executeInfo);\n\t\t\t}\n\t\t}\n\n\t\tthrow new Error(`Could not find server for command: '${command}'`);\n\t}\n}\n\nexport class GetErrRoutingTsServer extends Disposable implements ITypeScriptServer {\n\n\tprivate static readonly diagnosticEvents = new Set<string>([\n\t\tEventName.configFileDiag,\n\t\tEventName.syntaxDiag,\n\t\tEventName.semanticDiag,\n\t\tEventName.suggestionDiag\n\t]);\n\n\tprivate readonly getErrServer: ITypeScriptServer;\n\tprivate readonly mainServer: ITypeScriptServer;\n\tprivate readonly router: RequestRouter;\n\n\tpublic constructor(\n\t\tservers: { getErr: ITypeScriptServer, primary: ITypeScriptServer },\n\t\tdelegate: TsServerDelegate,\n\t) {\n\t\tsuper();\n\n\t\tthis.getErrServer = servers.getErr;\n\t\tthis.mainServer = servers.primary;\n\n\t\tthis.router = new RequestRouter(\n\t\t\t[\n\t\t\t\t{ server: this.getErrServer, canRun: (command) => ['geterr', 'geterrForProject'].includes(command) },\n\t\t\t\t{ server: this.mainServer, canRun: undefined /* gets all other commands */ }\n\t\t\t],\n\t\t\tdelegate);\n\n\t\tthis._register(this.getErrServer.onEvent(e => {\n\t\t\tif (GetErrRoutingTsServer.diagnosticEvents.has(e.event)) {\n\t\t\t\tthis._onEvent.fire(e);\n\t\t\t}\n\t\t\t// Ignore all other events\n\t\t}));\n\t\tthis._register(this.mainServer.onEvent(e => {\n\t\t\tif (!GetErrRoutingTsServer.diagnosticEvents.has(e.event)) {\n\t\t\t\tthis._onEvent.fire(e);\n\t\t\t}\n\t\t\t// Ignore all other events\n\t\t}));\n\n\t\tthis._register(this.getErrServer.onError(e => this._onError.fire(e)));\n\t\tthis._register(this.mainServer.onError(e => this._onError.fire(e)));\n\n\t\tthis._register(this.mainServer.onExit(e => {\n\t\t\tthis._onExit.fire(e);\n\t\t\tthis.getErrServer.kill();\n\t\t}));\n\t}\n\n\tprivate readonly _onEvent = this._register(new vscode.EventEmitter<Proto.Event>());\n\tpublic readonly onEvent = this._onEvent.event;\n\n\tprivate readonly _onExit = this._register(new vscode.EventEmitter<TypeScriptServerExitEvent>());\n\tpublic readonly onExit = this._onExit.event;\n\n\tprivate readonly _onError = this._register(new vscode.EventEmitter<any>());\n\tpublic readonly onError = this._onError.event;\n\n\tpublic get tsServerLogFile() { return this.mainServer.tsServerLogFile; }\n\n\tpublic kill(): void {\n\t\tthis.getErrServer.kill();\n\t\tthis.mainServer.kill();\n\t}\n\n\tpublic executeImpl(command: keyof TypeScriptRequests, args: any, executeInfo: { isAsync: boolean, token?: vscode.CancellationToken, expectsResult: boolean, lowPriority?: boolean, executionTarget?: ExecutionTarget }): Array<Promise<ServerResponse.Response<Proto.Response>> | undefined> {\n\t\treturn this.router.execute(command, args, executeInfo);\n\t}\n}\n\n\nexport class SyntaxRoutingTsServer extends Disposable implements ITypeScriptServer {\n\n\t/**\n\t * Commands that should always be run on the syntax server.\n\t */\n\tprivate static readonly syntaxAlwaysCommands = new Set<keyof TypeScriptRequests>([\n\t\t'navtree',\n\t\t'getOutliningSpans',\n\t\t'jsxClosingTag',\n\t\t'selectionRange',\n\t\t'format',\n\t\t'formatonkey',\n\t\t'docCommentTemplate',\n\t]);\n\n\t/**\n\t * Commands that should always be run on the semantic server.\n\t */\n\tprivate static readonly semanticCommands = new Set<keyof TypeScriptRequests>([\n\t\t'geterr',\n\t\t'geterrForProject',\n\t\t'projectInfo',\n\t\t'configurePlugin',\n\t]);\n\n\t/**\n\t * Commands that can be run on the syntax server but would benefit from being upgraded to the semantic server.\n\t */\n\tprivate static readonly syntaxAllowedCommands = new Set<keyof TypeScriptRequests>([\n\t\t'completions',\n\t\t'completionEntryDetails',\n\t\t'completionInfo',\n\t\t'definition',\n\t\t'definitionAndBoundSpan',\n\t\t'documentHighlights',\n\t\t'implementation',\n\t\t'navto',\n\t\t'quickinfo',\n\t\t'references',\n\t\t'rename',\n\t\t'signatureHelp',\n\t]);\n\n\tprivate readonly syntaxServer: ITypeScriptServer;\n\tprivate readonly semanticServer: ITypeScriptServer;\n\tprivate readonly router: RequestRouter;\n\n\tprivate _projectLoading = true;\n\n\tpublic constructor(\n\t\tservers: { syntax: ITypeScriptServer, semantic: ITypeScriptServer },\n\t\tdelegate: TsServerDelegate,\n\t\tenableDynamicRouting: boolean,\n\t) {\n\t\tsuper();\n\n\t\tthis.syntaxServer = servers.syntax;\n\t\tthis.semanticServer = servers.semantic;\n\n\t\tthis.router = new RequestRouter(\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tserver: this.syntaxServer,\n\t\t\t\t\tcanRun: (command, execInfo) => {\n\t\t\t\t\t\tswitch (execInfo.executionTarget) {\n\t\t\t\t\t\t\tcase ExecutionTarget.Semantic: return false;\n\t\t\t\t\t\t\tcase ExecutionTarget.Syntax: return true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (SyntaxRoutingTsServer.syntaxAlwaysCommands.has(command)) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (SyntaxRoutingTsServer.semanticCommands.has(command)) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (enableDynamicRouting && this.projectLoading && SyntaxRoutingTsServer.syntaxAllowedCommands.has(command)) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}, {\n\t\t\t\t\tserver: this.semanticServer,\n\t\t\t\t\tcanRun: undefined /* gets all other commands */\n\t\t\t\t}\n\t\t\t],\n\t\t\tdelegate);\n\n\t\tthis._register(this.syntaxServer.onEvent(e => {\n\t\t\treturn this._onEvent.fire(e);\n\t\t}));\n\n\t\tthis._register(this.semanticServer.onEvent(e => {\n\t\t\tswitch (e.event) {\n\t\t\t\tcase EventName.projectLoadingStart:\n\t\t\t\t\tthis._projectLoading = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase EventName.projectLoadingFinish:\n\t\t\t\tcase EventName.semanticDiag:\n\t\t\t\tcase EventName.syntaxDiag:\n\t\t\t\tcase EventName.suggestionDiag:\n\t\t\t\tcase EventName.configFileDiag:\n\t\t\t\t\tthis._projectLoading = false;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn this._onEvent.fire(e);\n\t\t}));\n\n\t\tthis._register(this.semanticServer.onExit(e => {\n\t\t\tthis._onExit.fire(e);\n\t\t\tthis.syntaxServer.kill();\n\t\t}));\n\n\t\tthis._register(this.semanticServer.onError(e => this._onError.fire(e)));\n\t}\n\n\tprivate get projectLoading() { return this._projectLoading; }\n\n\tprivate readonly _onEvent = this._register(new vscode.EventEmitter<Proto.Event>());\n\tpublic readonly onEvent = this._onEvent.event;\n\n\tprivate readonly _onExit = this._register(new vscode.EventEmitter<any>());\n\tpublic readonly onExit = this._onExit.event;\n\n\tprivate readonly _onError = this._register(new vscode.EventEmitter<any>());\n\tpublic readonly onError = this._onError.event;\n\n\tpublic get tsServerLogFile() { return this.semanticServer.tsServerLogFile; }\n\n\tpublic kill(): void {\n\t\tthis.syntaxServer.kill();\n\t\tthis.semanticServer.kill();\n\t}\n\n\tpublic executeImpl(command: keyof TypeScriptRequests, args: any, executeInfo: { isAsync: boolean, token?: vscode.CancellationToken, expectsResult: boolean, lowPriority?: boolean, executionTarget?: ExecutionTarget }): Array<Promise<ServerResponse.Response<Proto.Response>> | undefined> {\n\t\treturn this.router.execute(command, args, executeInfo);\n\t}\n}\n\nnamespace RequestState {\n\texport const enum Type { Unresolved, Resolved, Errored }\n\n\texport const Unresolved = { type: Type.Unresolved } as const;\n\n\texport const Resolved = { type: Type.Resolved } as const;\n\n\texport class Errored {\n\t\treadonly type = Type.Errored;\n\n\t\tconstructor(\n\t\t\tpublic readonly err: Error\n\t\t) { }\n\t}\n\n\texport type State = typeof Unresolved | typeof Resolved | Errored;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type * as Proto from '../protocol';\nimport { ServerResponse } from '../typescriptService';\n\nexport interface CallbackItem<R> {\n\treadonly onSuccess: (value: R) => void;\n\treadonly onError: (err: Error) => void;\n\treadonly queuingStartTime: number;\n\treadonly isAsync: boolean;\n}\n\nexport class CallbackMap<R extends Proto.Response> {\n\tprivate readonly _callbacks = new Map<number, CallbackItem<ServerResponse.Response<R> | undefined>>();\n\tprivate readonly _asyncCallbacks = new Map<number, CallbackItem<ServerResponse.Response<R> | undefined>>();\n\n\tpublic destroy(cause: string): void {\n\t\tconst cancellation = new ServerResponse.Cancelled(cause);\n\t\tfor (const callback of this._callbacks.values()) {\n\t\t\tcallback.onSuccess(cancellation);\n\t\t}\n\t\tthis._callbacks.clear();\n\t\tfor (const callback of this._asyncCallbacks.values()) {\n\t\t\tcallback.onSuccess(cancellation);\n\t\t}\n\t\tthis._asyncCallbacks.clear();\n\t}\n\n\tpublic add(seq: number, callback: CallbackItem<ServerResponse.Response<R> | undefined>, isAsync: boolean) {\n\t\tif (isAsync) {\n\t\t\tthis._asyncCallbacks.set(seq, callback);\n\t\t} else {\n\t\t\tthis._callbacks.set(seq, callback);\n\t\t}\n\t}\n\n\tpublic fetch(seq: number): CallbackItem<ServerResponse.Response<R> | undefined> | undefined {\n\t\tconst callback = this._callbacks.get(seq) || this._asyncCallbacks.get(seq);\n\t\tthis.delete(seq);\n\t\treturn callback;\n\t}\n\n\tprivate delete(seq: number) {\n\t\tif (!this._callbacks.delete(seq)) {\n\t\t\tthis._asyncCallbacks.delete(seq);\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type * as Proto from '../protocol';\n\nexport enum RequestQueueingType {\n\t/**\n\t * Normal request that is executed in order.\n\t */\n\tNormal = 1,\n\n\t/**\n\t * Request that normal requests jump in front of in the queue.\n\t */\n\tLowPriority = 2,\n\n\t/**\n\t * A fence that blocks request reordering.\n\t *\n\t * Fences are not reordered. Unlike a normal request, a fence will never jump in front of a low priority request\n\t * in the request queue.\n\t */\n\tFence = 3,\n}\n\nexport interface RequestItem {\n\treadonly request: Proto.Request;\n\treadonly expectsResponse: boolean;\n\treadonly isAsync: boolean;\n\treadonly queueingType: RequestQueueingType;\n}\n\nexport class RequestQueue {\n\tprivate readonly queue: RequestItem[] = [];\n\tprivate sequenceNumber: number = 0;\n\n\tpublic get length(): number {\n\t\treturn this.queue.length;\n\t}\n\n\tpublic enqueue(item: RequestItem): void {\n\t\tif (item.queueingType === RequestQueueingType.Normal) {\n\t\t\tlet index = this.queue.length - 1;\n\t\t\twhile (index >= 0) {\n\t\t\t\tif (this.queue[index].queueingType !== RequestQueueingType.LowPriority) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t--index;\n\t\t\t}\n\t\t\tthis.queue.splice(index + 1, 0, item);\n\t\t} else {\n\t\t\t// Only normal priority requests can be reordered. All other requests just go to the end.\n\t\t\tthis.queue.push(item);\n\t\t}\n\t}\n\n\tpublic dequeue(): RequestItem | undefined {\n\t\treturn this.queue.shift();\n\t}\n\n\tpublic tryDeletePendingRequest(seq: number): boolean {\n\t\tfor (let i = 0; i < this.queue.length; i++) {\n\t\t\tif (this.queue[i].request.seq === seq) {\n\t\t\t\tthis.queue.splice(i, 1);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic createRequest(command: string, args: any): Proto.Request {\n\t\treturn {\n\t\t\tseq: this.sequenceNumber++,\n\t\t\ttype: 'request',\n\t\t\tcommand: command,\n\t\t\targuments: args\n\t\t};\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type * as Proto from '../protocol';\nimport { TypeScriptVersion } from './versionProvider';\n\n\nexport class TypeScriptServerError extends Error {\n\tpublic static create(\n\t\tserverId: string,\n\t\tversion: TypeScriptVersion,\n\t\tresponse: Proto.Response\n\t): TypeScriptServerError {\n\t\tconst parsedResult = TypeScriptServerError.parseErrorText(response);\n\t\treturn new TypeScriptServerError(serverId, version, response, parsedResult?.message, parsedResult?.stack, parsedResult?.sanitizedStack);\n\t}\n\n\tprivate constructor(\n\t\tpublic readonly serverId: string,\n\t\tpublic readonly version: TypeScriptVersion,\n\t\tprivate readonly response: Proto.Response,\n\t\tpublic readonly serverMessage: string | undefined,\n\t\tpublic readonly serverStack: string | undefined,\n\t\tprivate readonly sanitizedStack: string | undefined\n\t) {\n\t\tsuper(`<${serverId}> TypeScript Server Error (${version.displayName})\\n${serverMessage}\\n${serverStack}`);\n\t}\n\n\tpublic get serverErrorText() { return this.response.message; }\n\n\tpublic get serverCommand() { return this.response.command; }\n\n\tpublic get telemetry() {\n\t\t// The \"sanitizedstack\" has been purged of error messages, paths, and file names (other than tsserver)\n\t\t// and, thus, can be classified as SystemMetaData, rather than CallstackOrException.\n\t\t/* __GDPR__FRAGMENT__\n\t\t\t\"TypeScriptRequestErrorProperties\" : {\n\t\t\t\t\"command\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"serverid\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\t\t\"sanitizedstack\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\t\t\"badclient\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" }\n\t\t\t}\n\t\t*/\n\t\treturn {\n\t\t\tcommand: this.serverCommand,\n\t\t\tserverid: this.serverId,\n\t\t\tsanitizedstack: this.sanitizedStack || '',\n\t\t\tbadclient: /\\bBADCLIENT\\b/.test(this.stack || ''),\n\t\t} as const;\n\t}\n\n\t/**\n\t * Given a `errorText` from a tsserver request indicating failure in handling a request,\n\t * prepares a payload for telemetry-logging.\n\t */\n\tprivate static parseErrorText(response: Proto.Response) {\n\t\tconst errorText = response.message;\n\t\tif (errorText) {\n\t\t\tconst errorPrefix = 'Error processing request. ';\n\t\t\tif (errorText.startsWith(errorPrefix)) {\n\t\t\t\tconst prefixFreeErrorText = errorText.substr(errorPrefix.length);\n\t\t\t\tconst newlineIndex = prefixFreeErrorText.indexOf('\\n');\n\t\t\t\tif (newlineIndex >= 0) {\n\t\t\t\t\t// Newline expected between message and stack.\n\t\t\t\t\tconst stack = prefixFreeErrorText.substring(newlineIndex + 1);\n\t\t\t\t\treturn {\n\t\t\t\t\t\tmessage: prefixFreeErrorText.substring(0, newlineIndex),\n\t\t\t\t\t\tstack,\n\t\t\t\t\t\tsanitizedStack: TypeScriptServerError.sanitizeStack(stack)\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\t/**\n\t * Drop everything but \".js\" and line/column numbers (though retain \"tsserver\" if that's the filename).\n\t */\n\tprivate static sanitizeStack(message: string | undefined) {\n\t\tif (!message) {\n\t\t\treturn '';\n\t\t}\n\t\tconst regex = /(\\btsserver)?(\\.(?:ts|tsx|js|jsx)(?::\\d+(?::\\d+)?)?)\\)?$/igm;\n\t\tlet serverStack = '';\n\t\twhile (true) {\n\t\t\tconst match = regex.exec(message);\n\t\t\tif (!match) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t// [1] is 'tsserver' or undefined\n\t\t\t// [2] is '.js:{line_number}:{column_number}'\n\t\t\tserverStack += `${match[1] || 'suppressed'}${match[2]}\\n`;\n\t\t}\n\t\treturn serverStack;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as nls from 'vscode-nls';\nimport { Command, CommandManager } from '../commands/commandManager';\nimport type * as Proto from '../protocol';\nimport * as PConst from '../protocol.const';\nimport { ClientCapability, ITypeScriptServiceClient, ServerResponse } from '../typescriptService';\nimport API from '../utils/api';\nimport { nulToken } from '../utils/cancellation';\nimport { applyCodeAction } from '../utils/codeAction';\nimport { conditionalRegistration, requireConfiguration, requireSomeCapability } from '../utils/dependentRegistration';\nimport { DocumentSelector } from '../utils/documentSelector';\nimport { parseKindModifier } from '../utils/modifiers';\nimport * as Previewer from '../utils/previewer';\nimport { snippetForFunctionCall } from '../utils/snippetForFunctionCall';\nimport { TelemetryReporter } from '../utils/telemetry';\nimport * as typeConverters from '../utils/typeConverters';\nimport TypingsStatus from '../utils/typingsStatus';\nimport FileConfigurationManager from './fileConfigurationManager';\n\nconst localize = nls.loadMessageBundle();\n\ninterface DotAccessorContext {\n\treadonly range: vscode.Range;\n\treadonly text: string;\n}\n\ninterface CompletionContext {\n\treadonly isNewIdentifierLocation: boolean;\n\treadonly isMemberCompletion: boolean;\n\treadonly isInValidCommitCharacterContext: boolean;\n\n\treadonly dotAccessorContext?: DotAccessorContext;\n\n\treadonly enableCallCompletions: boolean;\n\treadonly useCodeSnippetsOnMethodSuggest: boolean,\n\n\treadonly wordRange: vscode.Range | undefined;\n\treadonly line: string;\n\n\treadonly useFuzzyWordRangeLogic: boolean,\n}\n\ntype ResolvedCompletionItem = {\n\treadonly edits?: readonly vscode.TextEdit[];\n\treadonly commands: readonly vscode.Command[];\n};\n\nclass MyCompletionItem extends vscode.CompletionItem {\n\n\tpublic readonly useCodeSnippet: boolean;\n\n\tconstructor(\n\t\tpublic readonly position: vscode.Position,\n\t\tpublic readonly document: vscode.TextDocument,\n\t\tpublic readonly tsEntry: Proto.CompletionEntry,\n\t\tprivate readonly completionContext: CompletionContext,\n\t\tpublic readonly metadata: any | undefined,\n\t\tclient: ITypeScriptServiceClient,\n\t) {\n\t\tsuper(tsEntry.name, MyCompletionItem.convertKind(tsEntry.kind));\n\n\t\tif (tsEntry.source && tsEntry.hasAction) {\n\t\t\t// De-prioritze auto-imports\n\t\t\t// https://github.com/microsoft/vscode/issues/40311\n\t\t\tthis.sortText = '\\uffff' + tsEntry.sortText;\n\n\t\t\t// Render \"fancy\" when source is a workspace path\n\t\t\tconst qualifierCandidate = vscode.workspace.asRelativePath(tsEntry.source);\n\t\t\tif (qualifierCandidate !== tsEntry.source) {\n\t\t\t\tthis.label = { label: tsEntry.name, description: qualifierCandidate };\n\t\t\t}\n\n\t\t} else {\n\t\t\tthis.sortText = tsEntry.sortText;\n\t\t}\n\n\t\tconst { sourceDisplay, isSnippet } = tsEntry;\n\t\tif (sourceDisplay) {\n\t\t\tthis.label = { label: tsEntry.name, description: Previewer.plainWithLinks(sourceDisplay, client) };\n\t\t}\n\n\t\tthis.preselect = tsEntry.isRecommended;\n\t\tthis.position = position;\n\t\tthis.useCodeSnippet = completionContext.useCodeSnippetsOnMethodSuggest && (this.kind === vscode.CompletionItemKind.Function || this.kind === vscode.CompletionItemKind.Method);\n\n\t\tthis.range = this.getRangeFromReplacementSpan(tsEntry, completionContext);\n\t\tthis.commitCharacters = MyCompletionItem.getCommitCharacters(completionContext, tsEntry);\n\t\tthis.insertText = isSnippet && tsEntry.insertText ? new vscode.SnippetString(tsEntry.insertText) : tsEntry.insertText;\n\t\tthis.filterText = this.getFilterText(completionContext.line, tsEntry.insertText);\n\n\t\tif (completionContext.isMemberCompletion && completionContext.dotAccessorContext && !(this.insertText instanceof vscode.SnippetString)) {\n\t\t\tthis.filterText = completionContext.dotAccessorContext.text + (this.insertText || this.label);\n\t\t\tif (!this.range) {\n\t\t\t\tconst replacementRange = this.getFuzzyWordRange();\n\t\t\t\tif (replacementRange) {\n\t\t\t\t\tthis.range = {\n\t\t\t\t\t\tinserting: completionContext.dotAccessorContext.range,\n\t\t\t\t\t\treplacing: completionContext.dotAccessorContext.range.union(replacementRange),\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\tthis.range = completionContext.dotAccessorContext.range;\n\t\t\t\t}\n\t\t\t\tthis.insertText = this.filterText;\n\t\t\t}\n\t\t}\n\n\t\tif (tsEntry.kindModifiers) {\n\t\t\tconst kindModifiers = parseKindModifier(tsEntry.kindModifiers);\n\t\t\tif (kindModifiers.has(PConst.KindModifiers.optional)) {\n\t\t\t\tif (!this.insertText) {\n\t\t\t\t\tthis.insertText = this.textLabel;\n\t\t\t\t}\n\n\t\t\t\tif (!this.filterText) {\n\t\t\t\t\tthis.filterText = this.textLabel;\n\t\t\t\t}\n\t\t\t\tif (typeof this.label === 'string') {\n\t\t\t\t\tthis.label += '?';\n\t\t\t\t} else {\n\t\t\t\t\tthis.label.label += '?';\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (kindModifiers.has(PConst.KindModifiers.deprecated)) {\n\t\t\t\tthis.tags = [vscode.CompletionItemTag.Deprecated];\n\t\t\t}\n\n\t\t\tif (kindModifiers.has(PConst.KindModifiers.color)) {\n\t\t\t\tthis.kind = vscode.CompletionItemKind.Color;\n\t\t\t}\n\n\t\t\tif (tsEntry.kind === PConst.Kind.script) {\n\t\t\t\tfor (const extModifier of PConst.KindModifiers.fileExtensionKindModifiers) {\n\t\t\t\t\tif (kindModifiers.has(extModifier)) {\n\t\t\t\t\t\tif (tsEntry.name.toLowerCase().endsWith(extModifier)) {\n\t\t\t\t\t\t\tthis.detail = tsEntry.name;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.detail = tsEntry.name + extModifier;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.resolveRange();\n\t}\n\n\tprivate get textLabel() {\n\t\treturn typeof this.label === 'string' ? this.label : this.label.label;\n\t}\n\n\tprivate _resolvedPromise?: {\n\t\treadonly requestToken: vscode.CancellationTokenSource;\n\t\treadonly promise: Promise<ResolvedCompletionItem | undefined>;\n\t\twaiting: number;\n\t};\n\n\tpublic async resolveCompletionItem(\n\t\tclient: ITypeScriptServiceClient,\n\t\ttoken: vscode.CancellationToken,\n\t): Promise<ResolvedCompletionItem | undefined> {\n\t\ttoken.onCancellationRequested(() => {\n\t\t\tif (this._resolvedPromise && --this._resolvedPromise.waiting <= 0) {\n\t\t\t\t// Give a little extra time for another caller to come in\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tif (this._resolvedPromise && this._resolvedPromise.waiting <= 0) {\n\t\t\t\t\t\tthis._resolvedPromise.requestToken.cancel();\n\t\t\t\t\t}\n\t\t\t\t}, 300);\n\t\t\t}\n\t\t});\n\n\t\tif (this._resolvedPromise) {\n\t\t\t++this._resolvedPromise.waiting;\n\t\t\treturn this._resolvedPromise.promise;\n\t\t}\n\n\t\tconst requestToken = new vscode.CancellationTokenSource();\n\n\t\tconst promise = (async (): Promise<ResolvedCompletionItem | undefined> => {\n\t\t\tconst filepath = client.toOpenedFilePath(this.document);\n\t\t\tif (!filepath) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tconst args: Proto.CompletionDetailsRequestArgs = {\n\t\t\t\t...typeConverters.Position.toFileLocationRequestArgs(filepath, this.position),\n\t\t\t\tentryNames: [\n\t\t\t\t\tthis.tsEntry.source || this.tsEntry.data ? {\n\t\t\t\t\t\tname: this.tsEntry.name,\n\t\t\t\t\t\tsource: this.tsEntry.source,\n\t\t\t\t\t\tdata: this.tsEntry.data,\n\t\t\t\t\t} : this.tsEntry.name\n\t\t\t\t]\n\t\t\t};\n\t\t\tconst response = await client.interruptGetErr(() => client.execute('completionEntryDetails', args, requestToken.token));\n\t\t\tif (response.type !== 'response' || !response.body || !response.body.length) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tconst detail = response.body[0];\n\n\t\t\tif (!this.detail && detail.displayParts.length) {\n\t\t\t\tthis.detail = Previewer.plainWithLinks(detail.displayParts, client);\n\t\t\t}\n\t\t\tthis.documentation = this.getDocumentation(client, detail, this);\n\n\t\t\tconst codeAction = this.getCodeActions(detail, filepath);\n\t\t\tconst commands: vscode.Command[] = [{\n\t\t\t\tcommand: CompletionAcceptedCommand.ID,\n\t\t\t\ttitle: '',\n\t\t\t\targuments: [this]\n\t\t\t}];\n\t\t\tif (codeAction.command) {\n\t\t\t\tcommands.push(codeAction.command);\n\t\t\t}\n\t\t\tconst additionalTextEdits = codeAction.additionalTextEdits;\n\n\t\t\tif (this.useCodeSnippet) {\n\t\t\t\tconst shouldCompleteFunction = await this.isValidFunctionCompletionContext(client, filepath, this.position, this.document, token);\n\t\t\t\tif (shouldCompleteFunction) {\n\t\t\t\t\tconst { snippet, parameterCount } = snippetForFunctionCall({ ...this, label: this.textLabel }, detail.displayParts);\n\t\t\t\t\tthis.insertText = snippet;\n\t\t\t\t\tif (parameterCount > 0) {\n\t\t\t\t\t\t//Fix for https://github.com/microsoft/vscode/issues/104059\n\t\t\t\t\t\t//Don't show parameter hints if \"editor.parameterHints.enabled\": false\n\t\t\t\t\t\tif (vscode.workspace.getConfiguration('editor.parameterHints').get('enabled')) {\n\t\t\t\t\t\t\tcommands.push({ title: 'triggerParameterHints', command: 'editor.action.triggerParameterHints' });\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn { commands, edits: additionalTextEdits };\n\t\t})();\n\n\t\tthis._resolvedPromise = {\n\t\t\tpromise,\n\t\t\trequestToken,\n\t\t\twaiting: 1,\n\t\t};\n\n\t\treturn this._resolvedPromise.promise;\n\t}\n\n\tprivate getDocumentation(\n\t\tclient: ITypeScriptServiceClient,\n\t\tdetail: Proto.CompletionEntryDetails,\n\t\titem: MyCompletionItem\n\t): vscode.MarkdownString | undefined {\n\t\tconst documentation = new vscode.MarkdownString();\n\t\tif (detail.source) {\n\t\t\tconst importPath = `'${Previewer.plainWithLinks(detail.source, client)}'`;\n\t\t\tconst autoImportLabel = localize('autoImportLabel', 'Auto import from {0}', importPath);\n\t\t\titem.detail = `${autoImportLabel}\\n${item.detail}`;\n\t\t}\n\t\tPreviewer.addMarkdownDocumentation(documentation, detail.documentation, detail.tags, client);\n\n\t\treturn documentation.value.length ? documentation : undefined;\n\t}\n\n\tprivate async isValidFunctionCompletionContext(\n\t\tclient: ITypeScriptServiceClient,\n\t\tfilepath: string,\n\t\tposition: vscode.Position,\n\t\tdocument: vscode.TextDocument,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<boolean> {\n\t\t// Workaround for https://github.com/microsoft/TypeScript/issues/12677\n\t\t// Don't complete function calls inside of destructive assignments or imports\n\t\ttry {\n\t\t\tconst args: Proto.FileLocationRequestArgs = typeConverters.Position.toFileLocationRequestArgs(filepath, position);\n\t\t\tconst response = await client.execute('quickinfo', args, token);\n\t\t\tif (response.type === 'response' && response.body) {\n\t\t\t\tswitch (response.body.kind) {\n\t\t\t\t\tcase 'var':\n\t\t\t\t\tcase 'let':\n\t\t\t\t\tcase 'const':\n\t\t\t\t\tcase 'alias':\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t} catch {\n\t\t\t// Noop\n\t\t}\n\n\t\t// Don't complete function call if there is already something that looks like a function call\n\t\t// https://github.com/microsoft/vscode/issues/18131\n\t\tconst after = document.lineAt(position.line).text.slice(position.character);\n\t\treturn after.match(/^[a-z_$0-9]*\\s*\\(/gi) === null;\n\t}\n\n\tprivate getCodeActions(\n\t\tdetail: Proto.CompletionEntryDetails,\n\t\tfilepath: string\n\t): { command?: vscode.Command, additionalTextEdits?: vscode.TextEdit[] } {\n\t\tif (!detail.codeActions || !detail.codeActions.length) {\n\t\t\treturn {};\n\t\t}\n\n\t\t// Try to extract out the additionalTextEdits for the current file.\n\t\t// Also check if we still have to apply other workspace edits and commands\n\t\t// using a vscode command\n\t\tconst additionalTextEdits: vscode.TextEdit[] = [];\n\t\tlet hasRemainingCommandsOrEdits = false;\n\t\tfor (const tsAction of detail.codeActions) {\n\t\t\tif (tsAction.commands) {\n\t\t\t\thasRemainingCommandsOrEdits = true;\n\t\t\t}\n\n\t\t\t// Apply all edits in the current file using `additionalTextEdits`\n\t\t\tif (tsAction.changes) {\n\t\t\t\tfor (const change of tsAction.changes) {\n\t\t\t\t\tif (change.fileName === filepath) {\n\t\t\t\t\t\tadditionalTextEdits.push(...change.textChanges.map(typeConverters.TextEdit.fromCodeEdit));\n\t\t\t\t\t} else {\n\t\t\t\t\t\thasRemainingCommandsOrEdits = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet command: vscode.Command | undefined = undefined;\n\t\tif (hasRemainingCommandsOrEdits) {\n\t\t\t// Create command that applies all edits not in the current file.\n\t\t\tcommand = {\n\t\t\t\ttitle: '',\n\t\t\t\tcommand: ApplyCompletionCodeActionCommand.ID,\n\t\t\t\targuments: [filepath, detail.codeActions.map((x): Proto.CodeAction => ({\n\t\t\t\t\tcommands: x.commands,\n\t\t\t\t\tdescription: x.description,\n\t\t\t\t\tchanges: x.changes.filter(x => x.fileName !== filepath)\n\t\t\t\t}))]\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tcommand,\n\t\t\tadditionalTextEdits: additionalTextEdits.length ? additionalTextEdits : undefined\n\t\t};\n\t}\n\n\tprivate getRangeFromReplacementSpan(tsEntry: Proto.CompletionEntry, completionContext: CompletionContext) {\n\t\tif (!tsEntry.replacementSpan) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet replaceRange = typeConverters.Range.fromTextSpan(tsEntry.replacementSpan);\n\t\t// Make sure we only replace a single line at most\n\t\tif (!replaceRange.isSingleLine) {\n\t\t\treplaceRange = new vscode.Range(replaceRange.start.line, replaceRange.start.character, replaceRange.start.line, completionContext.line.length);\n\t\t}\n\n\t\t// If TS returns an explicit replacement range, we should use it for both types of completion\n\t\treturn {\n\t\t\tinserting: replaceRange,\n\t\t\treplacing: replaceRange,\n\t\t};\n\t}\n\n\tprivate getFilterText(line: string, insertText: string | undefined): string | undefined {\n\t\t// Handle private field completions\n\t\tif (this.tsEntry.name.startsWith('#')) {\n\t\t\tconst wordRange = this.completionContext.wordRange;\n\t\t\tconst wordStart = wordRange ? line.charAt(wordRange.start.character) : undefined;\n\t\t\tif (insertText) {\n\t\t\t\tif (insertText.startsWith('this.#')) {\n\t\t\t\t\treturn wordStart === '#' ? insertText : insertText.replace(/^this\\.#/, '');\n\t\t\t\t} else {\n\t\t\t\t\treturn insertText;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn wordStart === '#' ? undefined : this.tsEntry.name.replace(/^#/, '');\n\t\t\t}\n\t\t}\n\n\t\t// For `this.` completions, generally don't set the filter text since we don't want them to be overly prioritized. #74164\n\t\tif (insertText?.startsWith('this.')) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Handle the case:\n\t\t// ```\n\t\t// const xyz = { 'ab c': 1 };\n\t\t// xyz.ab|\n\t\t// ```\n\t\t// In which case we want to insert a bracket accessor but should use `.abc` as the filter text instead of\n\t\t// the bracketed insert text.\n\t\telse if (insertText?.startsWith('[')) {\n\t\t\treturn insertText.replace(/^\\[['\"](.+)[['\"]\\]$/, '.$1');\n\t\t}\n\n\t\t// In all other cases, fallback to using the insertText\n\t\treturn insertText;\n\t}\n\n\tprivate resolveRange(): void {\n\t\tif (this.range) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst replaceRange = this.getFuzzyWordRange();\n\t\tif (replaceRange) {\n\t\t\tthis.range = {\n\t\t\t\tinserting: new vscode.Range(replaceRange.start, this.position),\n\t\t\t\treplacing: replaceRange\n\t\t\t};\n\t\t}\n\t}\n\n\tprivate getFuzzyWordRange() {\n\t\tif (this.completionContext.useFuzzyWordRangeLogic) {\n\t\t\t// Try getting longer, prefix based range for completions that span words\n\t\t\tconst text = this.completionContext.line.slice(Math.max(0, this.position.character - this.textLabel.length), this.position.character).toLowerCase();\n\t\t\tconst entryName = this.textLabel.toLowerCase();\n\t\t\tfor (let i = entryName.length; i >= 0; --i) {\n\t\t\t\tif (text.endsWith(entryName.substr(0, i)) && (!this.completionContext.wordRange || this.completionContext.wordRange.start.character > this.position.character - i)) {\n\t\t\t\t\treturn new vscode.Range(\n\t\t\t\t\t\tnew vscode.Position(this.position.line, Math.max(0, this.position.character - i)),\n\t\t\t\t\t\tthis.position);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this.completionContext.wordRange;\n\t}\n\n\tprivate static convertKind(kind: string): vscode.CompletionItemKind {\n\t\tswitch (kind) {\n\t\t\tcase PConst.Kind.primitiveType:\n\t\t\tcase PConst.Kind.keyword:\n\t\t\t\treturn vscode.CompletionItemKind.Keyword;\n\n\t\t\tcase PConst.Kind.const:\n\t\t\tcase PConst.Kind.let:\n\t\t\tcase PConst.Kind.variable:\n\t\t\tcase PConst.Kind.localVariable:\n\t\t\tcase PConst.Kind.alias:\n\t\t\tcase PConst.Kind.parameter:\n\t\t\t\treturn vscode.CompletionItemKind.Variable;\n\n\t\t\tcase PConst.Kind.memberVariable:\n\t\t\tcase PConst.Kind.memberGetAccessor:\n\t\t\tcase PConst.Kind.memberSetAccessor:\n\t\t\t\treturn vscode.CompletionItemKind.Field;\n\n\t\t\tcase PConst.Kind.function:\n\t\t\tcase PConst.Kind.localFunction:\n\t\t\t\treturn vscode.CompletionItemKind.Function;\n\n\t\t\tcase PConst.Kind.method:\n\t\t\tcase PConst.Kind.constructSignature:\n\t\t\tcase PConst.Kind.callSignature:\n\t\t\tcase PConst.Kind.indexSignature:\n\t\t\t\treturn vscode.CompletionItemKind.Method;\n\n\t\t\tcase PConst.Kind.enum:\n\t\t\t\treturn vscode.CompletionItemKind.Enum;\n\n\t\t\tcase PConst.Kind.enumMember:\n\t\t\t\treturn vscode.CompletionItemKind.EnumMember;\n\n\t\t\tcase PConst.Kind.module:\n\t\t\tcase PConst.Kind.externalModuleName:\n\t\t\t\treturn vscode.CompletionItemKind.Module;\n\n\t\t\tcase PConst.Kind.class:\n\t\t\tcase PConst.Kind.type:\n\t\t\t\treturn vscode.CompletionItemKind.Class;\n\n\t\t\tcase PConst.Kind.interface:\n\t\t\t\treturn vscode.CompletionItemKind.Interface;\n\n\t\t\tcase PConst.Kind.warning:\n\t\t\t\treturn vscode.CompletionItemKind.Text;\n\n\t\t\tcase PConst.Kind.script:\n\t\t\t\treturn vscode.CompletionItemKind.File;\n\n\t\t\tcase PConst.Kind.directory:\n\t\t\t\treturn vscode.CompletionItemKind.Folder;\n\n\t\t\tcase PConst.Kind.string:\n\t\t\t\treturn vscode.CompletionItemKind.Constant;\n\n\t\t\tdefault:\n\t\t\t\treturn vscode.CompletionItemKind.Property;\n\t\t}\n\t}\n\n\tprivate static getCommitCharacters(context: CompletionContext, entry: Proto.CompletionEntry): string[] | undefined {\n\t\tif (entry.kind === PConst.Kind.warning) { // Ambient JS word based suggestion\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (context.isNewIdentifierLocation || !context.isInValidCommitCharacterContext) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst commitCharacters: string[] = ['.', ',', ';'];\n\t\tif (context.enableCallCompletions) {\n\t\t\tcommitCharacters.push('(');\n\t\t}\n\n\t\treturn commitCharacters;\n\t}\n}\n\n\nclass CompletionAcceptedCommand implements Command {\n\tpublic static readonly ID = '_typescript.onCompletionAccepted';\n\tpublic readonly id = CompletionAcceptedCommand.ID;\n\n\tpublic constructor(\n\t\tprivate readonly onCompletionAccepted: (item: vscode.CompletionItem) => void,\n\t\tprivate readonly telemetryReporter: TelemetryReporter,\n\t) { }\n\n\tpublic execute(item: vscode.CompletionItem) {\n\t\tthis.onCompletionAccepted(item);\n\t\tif (item instanceof MyCompletionItem) {\n\t\t\t/* __GDPR__\n\t\t\t\t\"completions.accept\" : {\n\t\t\t\t\t\"isPackageJsonImport\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\t\"isImportStatementCompletion\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t*/\n\t\t\tthis.telemetryReporter.logTelemetry('completions.accept', {\n\t\t\t\tisPackageJsonImport: item.tsEntry.isPackageJsonImport ? 'true' : undefined,\n\t\t\t\tisImportStatementCompletion: item.tsEntry.isImportStatementCompletion ? 'true' : undefined,\n\t\t\t});\n\t\t}\n\t}\n}\n\n/**\n * Command fired when an completion item needs to be applied\n */\nclass ApplyCompletionCommand implements Command {\n\tpublic static readonly ID = '_typescript.applyCompletionCommand';\n\tpublic readonly id = ApplyCompletionCommand.ID;\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t) { }\n\n\tpublic async execute(item: MyCompletionItem) {\n\t\tconst resolved = await item.resolveCompletionItem(this.client, nulToken);\n\t\tif (!resolved) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { edits, commands } = resolved;\n\n\t\tif (edits) {\n\t\t\tconst workspaceEdit = new vscode.WorkspaceEdit();\n\t\t\tfor (const edit of edits) {\n\t\t\t\tworkspaceEdit.replace(item.document.uri, edit.range, edit.newText);\n\t\t\t}\n\t\t\tawait vscode.workspace.applyEdit(workspaceEdit);\n\t\t}\n\n\t\tfor (const command of commands) {\n\t\t\tawait vscode.commands.executeCommand(command.command, ...(command.arguments ?? []));\n\t\t}\n\t}\n}\n\nclass ApplyCompletionCodeActionCommand implements Command {\n\tpublic static readonly ID = '_typescript.applyCompletionCodeAction';\n\tpublic readonly id = ApplyCompletionCodeActionCommand.ID;\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient\n\t) { }\n\n\tpublic async execute(_file: string, codeActions: Proto.CodeAction[]): Promise<boolean> {\n\t\tif (codeActions.length === 0) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (codeActions.length === 1) {\n\t\t\treturn applyCodeAction(this.client, codeActions[0], nulToken);\n\t\t}\n\n\t\tconst selection = await vscode.window.showQuickPick(\n\t\t\tcodeActions.map(action => ({\n\t\t\t\tlabel: action.description,\n\t\t\t\tdescription: '',\n\t\t\t\taction,\n\t\t\t})), {\n\t\t\tplaceHolder: localize('selectCodeAction', 'Select code action to apply')\n\t\t});\n\n\t\tif (selection) {\n\t\t\treturn applyCodeAction(this.client, selection.action, nulToken);\n\t\t}\n\t\treturn false;\n\t}\n}\n\ninterface CompletionConfiguration {\n\treadonly useCodeSnippetsOnMethodSuggest: boolean;\n\treadonly nameSuggestions: boolean;\n\treadonly pathSuggestions: boolean;\n\treadonly autoImportSuggestions: boolean;\n\treadonly importStatementSuggestions: boolean;\n}\n\nnamespace CompletionConfiguration {\n\texport const useCodeSnippetsOnMethodSuggest = 'suggest.completeFunctionCalls';\n\texport const nameSuggestions = 'suggest.names';\n\texport const pathSuggestions = 'suggest.paths';\n\texport const autoImportSuggestions = 'suggest.autoImports';\n\texport const importStatementSuggestions = 'suggest.importStatements';\n\n\texport function getConfigurationForResource(\n\t\tmodeId: string,\n\t\tresource: vscode.Uri\n\t): CompletionConfiguration {\n\t\tconst config = vscode.workspace.getConfiguration(modeId, resource);\n\t\treturn {\n\t\t\tuseCodeSnippetsOnMethodSuggest: config.get<boolean>(CompletionConfiguration.useCodeSnippetsOnMethodSuggest, false),\n\t\t\tpathSuggestions: config.get<boolean>(CompletionConfiguration.pathSuggestions, true),\n\t\t\tautoImportSuggestions: config.get<boolean>(CompletionConfiguration.autoImportSuggestions, true),\n\t\t\tnameSuggestions: config.get<boolean>(CompletionConfiguration.nameSuggestions, true),\n\t\t\timportStatementSuggestions: config.get<boolean>(CompletionConfiguration.importStatementSuggestions, true),\n\t\t};\n\t}\n}\n\nclass TypeScriptCompletionItemProvider implements vscode.CompletionItemProvider<MyCompletionItem> {\n\n\tpublic static readonly triggerCharacters = ['.', '\"', '\\'', '`', '/', '@', '<', '#', ' '];\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly modeId: string,\n\t\tprivate readonly typingsStatus: TypingsStatus,\n\t\tprivate readonly fileConfigurationManager: FileConfigurationManager,\n\t\tcommandManager: CommandManager,\n\t\tprivate readonly telemetryReporter: TelemetryReporter,\n\t\tonCompletionAccepted: (item: vscode.CompletionItem) => void\n\t) {\n\t\tcommandManager.register(new ApplyCompletionCodeActionCommand(this.client));\n\t\tcommandManager.register(new CompletionAcceptedCommand(onCompletionAccepted, this.telemetryReporter));\n\t\tcommandManager.register(new ApplyCompletionCommand(this.client));\n\t}\n\n\tpublic async provideCompletionItems(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\ttoken: vscode.CancellationToken,\n\t\tcontext: vscode.CompletionContext\n\t): Promise<vscode.CompletionList<MyCompletionItem> | undefined> {\n\t\tif (this.typingsStatus.isAcquiringTypings) {\n\t\t\treturn Promise.reject<vscode.CompletionList<MyCompletionItem>>({\n\t\t\t\tlabel: localize(\n\t\t\t\t\t{ key: 'acquiringTypingsLabel', comment: ['Typings refers to the *.d.ts typings files that power our IntelliSense. It should not be localized'] },\n\t\t\t\t\t'Acquiring typings...'),\n\t\t\t\tdetail: localize(\n\t\t\t\t\t{ key: 'acquiringTypingsDetail', comment: ['Typings refers to the *.d.ts typings files that power our IntelliSense. It should not be localized'] },\n\t\t\t\t\t'Acquiring typings definitions for IntelliSense.')\n\t\t\t});\n\t\t}\n\n\t\tconst file = this.client.toOpenedFilePath(document);\n\t\tif (!file) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst line = document.lineAt(position.line);\n\t\tconst completionConfiguration = CompletionConfiguration.getConfigurationForResource(this.modeId, document.uri);\n\n\t\tif (!this.shouldTrigger(context, line, position, completionConfiguration)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst wordRange = document.getWordRangeAtPosition(position);\n\n\t\tawait this.client.interruptGetErr(() => this.fileConfigurationManager.ensureConfigurationForDocument(document, token));\n\n\t\tconst args: Proto.CompletionsRequestArgs = {\n\t\t\t...typeConverters.Position.toFileLocationRequestArgs(file, position),\n\t\t\tincludeExternalModuleExports: completionConfiguration.autoImportSuggestions,\n\t\t\tincludeInsertTextCompletions: true,\n\t\t\ttriggerCharacter: this.getTsTriggerCharacter(context),\n\t\t\ttriggerKind: typeConverters.CompletionTriggerKind.toProtocolCompletionTriggerKind(context.triggerKind),\n\t\t};\n\n\t\tlet isNewIdentifierLocation = true;\n\t\tlet isIncomplete = false;\n\t\tlet isMemberCompletion = false;\n\t\tlet dotAccessorContext: DotAccessorContext | undefined;\n\t\tlet entries: ReadonlyArray<Proto.CompletionEntry>;\n\t\tlet metadata: any | undefined;\n\t\tlet response: ServerResponse.Response<Proto.CompletionInfoResponse> | undefined;\n\t\tlet duration: number | undefined;\n\t\tif (this.client.apiVersion.gte(API.v300)) {\n\t\t\tconst startTime = Date.now();\n\t\t\ttry {\n\t\t\t\tresponse = await this.client.interruptGetErr(() => this.client.execute('completionInfo', args, token));\n\t\t\t} finally {\n\t\t\t\tduration = Date.now() - startTime;\n\t\t\t}\n\n\t\t\tif (response.type !== 'response' || !response.body) {\n\t\t\t\tthis.logCompletionsTelemetry(duration, response);\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tisNewIdentifierLocation = response.body.isNewIdentifierLocation;\n\t\t\tisMemberCompletion = response.body.isMemberCompletion;\n\t\t\tif (isMemberCompletion) {\n\t\t\t\tconst dotMatch = line.text.slice(0, position.character).match(/\\??\\.\\s*$/) || undefined;\n\t\t\t\tif (dotMatch) {\n\t\t\t\t\tconst range = new vscode.Range(position.translate({ characterDelta: -dotMatch[0].length }), position);\n\t\t\t\t\tconst text = document.getText(range);\n\t\t\t\t\tdotAccessorContext = { range, text };\n\t\t\t\t}\n\t\t\t}\n\t\t\tisIncomplete = !!response.body.isIncomplete || (response as any).metadata && (response as any).metadata.isIncomplete;\n\t\t\tentries = response.body.entries;\n\t\t\tmetadata = response.metadata;\n\t\t} else {\n\t\t\tconst response = await this.client.interruptGetErr(() => this.client.execute('completions', args, token));\n\t\t\tif (response.type !== 'response' || !response.body) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tentries = response.body;\n\t\t\tmetadata = response.metadata;\n\t\t}\n\n\t\tconst completionContext = {\n\t\t\tisNewIdentifierLocation,\n\t\t\tisMemberCompletion,\n\t\t\tdotAccessorContext,\n\t\t\tisInValidCommitCharacterContext: this.isInValidCommitCharacterContext(document, position),\n\t\t\tenableCallCompletions: !completionConfiguration.useCodeSnippetsOnMethodSuggest,\n\t\t\twordRange,\n\t\t\tline: line.text,\n\t\t\tuseCodeSnippetsOnMethodSuggest: completionConfiguration.useCodeSnippetsOnMethodSuggest,\n\t\t\tuseFuzzyWordRangeLogic: this.client.apiVersion.lt(API.v390),\n\t\t};\n\n\t\tlet includesPackageJsonImport = false;\n\t\tlet includesImportStatementCompletion = false;\n\t\tconst items: MyCompletionItem[] = [];\n\t\tfor (const entry of entries) {\n\t\t\tif (!shouldExcludeCompletionEntry(entry, completionConfiguration)) {\n\t\t\t\tconst item = new MyCompletionItem(position, document, entry, completionContext, metadata, this.client);\n\t\t\t\titem.command = {\n\t\t\t\t\tcommand: ApplyCompletionCommand.ID,\n\t\t\t\t\ttitle: '',\n\t\t\t\t\targuments: [item]\n\t\t\t\t};\n\t\t\t\titems.push(item);\n\t\t\t\tincludesPackageJsonImport = includesPackageJsonImport || !!entry.isPackageJsonImport;\n\t\t\t\tincludesImportStatementCompletion = includesImportStatementCompletion || !!entry.isImportStatementCompletion;\n\t\t\t}\n\t\t}\n\t\tif (duration !== undefined) {\n\t\t\tthis.logCompletionsTelemetry(duration, response, includesPackageJsonImport, includesImportStatementCompletion);\n\t\t}\n\t\treturn new vscode.CompletionList(items, isIncomplete);\n\t}\n\n\tprivate logCompletionsTelemetry(\n\t\tduration: number,\n\t\tresponse: ServerResponse.Response<Proto.CompletionInfoResponse> | undefined,\n\t\tincludesPackageJsonImport?: boolean,\n\t\tincludesImportStatementCompletion?: boolean,\n\t) {\n\t\t/* __GDPR__\n\t\t\t\"completions.execute\" : {\n\t\t\t\t\"duration\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"type\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"count\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"updateGraphDurationMs\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"createAutoImportProviderProgramDurationMs\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"includesPackageJsonImport\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"includesImportStatementCompletion\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t]\n\t\t\t}\n\t\t*/\n\t\tthis.telemetryReporter.logTelemetry('completions.execute', {\n\t\t\tduration: String(duration),\n\t\t\ttype: response?.type ?? 'unknown',\n\t\t\tcount: String(response?.type === 'response' && response.body ? response.body.entries.length : 0),\n\t\t\tupdateGraphDurationMs: response?.type === 'response' && typeof response.performanceData?.updateGraphDurationMs === 'number'\n\t\t\t\t? String(response.performanceData.updateGraphDurationMs)\n\t\t\t\t: undefined,\n\t\t\tcreateAutoImportProviderProgramDurationMs: response?.type === 'response' && typeof response.performanceData?.createAutoImportProviderProgramDurationMs === 'number'\n\t\t\t\t? String(response.performanceData.createAutoImportProviderProgramDurationMs)\n\t\t\t\t: undefined,\n\t\t\tincludesPackageJsonImport: includesPackageJsonImport ? 'true' : undefined,\n\t\t\tincludesImportStatementCompletion: includesImportStatementCompletion ? 'true' : undefined,\n\t\t});\n\t}\n\n\tprivate getTsTriggerCharacter(context: vscode.CompletionContext): Proto.CompletionsTriggerCharacter | undefined {\n\t\tswitch (context.triggerCharacter) {\n\t\t\tcase '@': // Workaround for https://github.com/microsoft/TypeScript/issues/27321\n\t\t\t\treturn this.client.apiVersion.gte(API.v310) && this.client.apiVersion.lt(API.v320) ? undefined : '@';\n\n\t\t\tcase '#': // Workaround for https://github.com/microsoft/TypeScript/issues/36367\n\t\t\t\treturn this.client.apiVersion.lt(API.v381) ? undefined : '#';\n\n\t\t\tcase ' ':\n\t\t\t\tconst space: Proto.CompletionsTriggerCharacter = ' ';\n\t\t\t\treturn this.client.apiVersion.gte(API.v430) ? space : undefined;\n\n\t\t\tcase '.':\n\t\t\tcase '\"':\n\t\t\tcase '\\'':\n\t\t\tcase '`':\n\t\t\tcase '/':\n\t\t\tcase '<':\n\t\t\t\treturn context.triggerCharacter;\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tpublic async resolveCompletionItem(\n\t\titem: MyCompletionItem,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<MyCompletionItem | undefined> {\n\t\tawait item.resolveCompletionItem(this.client, token);\n\t\treturn item;\n\t}\n\n\tprivate isInValidCommitCharacterContext(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position\n\t): boolean {\n\t\tif (this.client.apiVersion.lt(API.v320)) {\n\t\t\t// Workaround for https://github.com/microsoft/TypeScript/issues/27742\n\t\t\t// Only enable dot completions when previous character not a dot preceded by whitespace.\n\t\t\t// Prevents incorrectly completing while typing spread operators.\n\t\t\tif (position.character > 1) {\n\t\t\t\tconst preText = document.getText(new vscode.Range(\n\t\t\t\t\tposition.line, 0,\n\t\t\t\t\tposition.line, position.character));\n\t\t\t\treturn preText.match(/(\\s|^)\\.$/ig) === null;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tprivate shouldTrigger(\n\t\tcontext: vscode.CompletionContext,\n\t\tline: vscode.TextLine,\n\t\tposition: vscode.Position,\n\t\tconfiguration: CompletionConfiguration,\n\t): boolean {\n\t\tif (context.triggerCharacter && this.client.apiVersion.lt(API.v290)) {\n\t\t\tif ((context.triggerCharacter === '\"' || context.triggerCharacter === '\\'')) {\n\t\t\t\t// make sure we are in something that looks like the start of an import\n\t\t\t\tconst pre = line.text.slice(0, position.character);\n\t\t\t\tif (!/\\b(from|import)\\s*[\"']$/.test(pre) && !/\\b(import|require)\\(['\"]$/.test(pre)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (context.triggerCharacter === '/') {\n\t\t\t\t// make sure we are in something that looks like an import path\n\t\t\t\tconst pre = line.text.slice(0, position.character);\n\t\t\t\tif (!/\\b(from|import)\\s*[\"'][^'\"]*$/.test(pre) && !/\\b(import|require)\\(['\"][^'\"]*$/.test(pre)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (context.triggerCharacter === '@') {\n\t\t\t\t// make sure we are in something that looks like the start of a jsdoc comment\n\t\t\t\tconst pre = line.text.slice(0, position.character);\n\t\t\t\tif (!/^\\s*\\*[ ]?@/.test(pre) && !/\\/\\*\\*+[ ]?@/.test(pre)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (context.triggerCharacter === '<') {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\tif (context.triggerCharacter === ' ') {\n\t\t\tif (!configuration.importStatementSuggestions || this.client.apiVersion.lt(API.v430)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst pre = line.text.slice(0, position.character);\n\t\t\treturn pre === 'import';\n\t\t}\n\t\treturn true;\n\t}\n}\n\nfunction shouldExcludeCompletionEntry(\n\telement: Proto.CompletionEntry,\n\tcompletionConfiguration: CompletionConfiguration\n) {\n\treturn (\n\t\t(!completionConfiguration.nameSuggestions && element.kind === PConst.Kind.warning)\n\t\t|| (!completionConfiguration.pathSuggestions &&\n\t\t\t(element.kind === PConst.Kind.directory || element.kind === PConst.Kind.script || element.kind === PConst.Kind.externalModuleName))\n\t\t|| (!completionConfiguration.autoImportSuggestions && element.hasAction)\n\t);\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tmodeId: string,\n\tclient: ITypeScriptServiceClient,\n\ttypingsStatus: TypingsStatus,\n\tfileConfigurationManager: FileConfigurationManager,\n\tcommandManager: CommandManager,\n\ttelemetryReporter: TelemetryReporter,\n\tonCompletionAccepted: (item: vscode.CompletionItem) => void\n) {\n\treturn conditionalRegistration([\n\t\trequireConfiguration(modeId, 'suggest.enabled'),\n\t\trequireSomeCapability(client, ClientCapability.EnhancedSyntax, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerCompletionItemProvider(selector.syntax,\n\t\t\tnew TypeScriptCompletionItemProvider(client, modeId, typingsStatus, fileConfigurationManager, commandManager, telemetryReporter, onCompletionAccepted),\n\t\t\t...TypeScriptCompletionItemProvider.triggerCharacters);\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../protocol';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport * as typeConverters from './typeConverters';\n\nexport function getEditForCodeAction(\n\tclient: ITypeScriptServiceClient,\n\taction: Proto.CodeAction\n): vscode.WorkspaceEdit | undefined {\n\treturn action.changes && action.changes.length\n\t\t? typeConverters.WorkspaceEdit.fromFileCodeEdits(client, action.changes)\n\t\t: undefined;\n}\n\nexport async function applyCodeAction(\n\tclient: ITypeScriptServiceClient,\n\taction: Proto.CodeAction,\n\ttoken: vscode.CancellationToken\n): Promise<boolean> {\n\tconst workspaceEdit = getEditForCodeAction(client, action);\n\tif (workspaceEdit) {\n\t\tif (!(await vscode.workspace.applyEdit(workspaceEdit))) {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn applyCodeActionCommands(client, action.commands, token);\n}\n\nexport async function applyCodeActionCommands(\n\tclient: ITypeScriptServiceClient,\n\tcommands: ReadonlyArray<{}> | undefined,\n\ttoken: vscode.CancellationToken,\n): Promise<boolean> {\n\tif (commands && commands.length) {\n\t\tfor (const command of commands) {\n\t\t\tawait client.execute('applyCodeActionCommand', { command }, token);\n\t\t}\n\t}\n\treturn true;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../protocol';\n\nexport interface IFilePathToResourceConverter {\n\t/**\n\t * Convert a typescript filepath to a VS Code resource.\n\t */\n\ttoResource(filepath: string): vscode.Uri;\n}\n\nfunction replaceLinks(text: string): string {\n\treturn text\n\t\t// Http(s) links\n\t\t.replace(/\\{@(link|linkplain|linkcode) (https?:\\/\\/[^ |}]+?)(?:[| ]([^{}\\n]+?))?\\}/gi, (_, tag: string, link: string, text?: string) => {\n\t\t\tswitch (tag) {\n\t\t\t\tcase 'linkcode':\n\t\t\t\t\treturn `[\\`${text ? text.trim() : link}\\`](${link})`;\n\n\t\t\t\tdefault:\n\t\t\t\t\treturn `[${text ? text.trim() : link}](${link})`;\n\t\t\t}\n\t\t});\n}\n\nfunction processInlineTags(text: string): string {\n\treturn replaceLinks(text);\n}\n\nfunction getTagBodyText(\n\ttag: Proto.JSDocTagInfo,\n\tfilePathConverter: IFilePathToResourceConverter,\n): string | undefined {\n\tif (!tag.text) {\n\t\treturn undefined;\n\t}\n\n\t// Convert to markdown code block if it does not already contain one\n\tfunction makeCodeblock(text: string): string {\n\t\tif (text.match(/^\\s*[~`]{3}/m)) {\n\t\t\treturn text;\n\t\t}\n\t\treturn '```\\n' + text + '\\n```';\n\t}\n\n\tconst text = convertLinkTags(tag.text, filePathConverter);\n\tswitch (tag.name) {\n\t\tcase 'example':\n\t\t\t// check for caption tags, fix for #79704\n\t\t\tconst captionTagMatches = text.match(/<caption>(.*?)<\\/caption>\\s*(\\r\\n|\\n)/);\n\t\t\tif (captionTagMatches && captionTagMatches.index === 0) {\n\t\t\t\treturn captionTagMatches[1] + '\\n' + makeCodeblock(text.substr(captionTagMatches[0].length));\n\t\t\t} else {\n\t\t\t\treturn makeCodeblock(text);\n\t\t\t}\n\t\tcase 'author':\n\t\t\t// fix obsucated email address, #80898\n\t\t\tconst emailMatch = text.match(/(.+)\\s<([-.\\w]+@[-.\\w]+)>/);\n\n\t\t\tif (emailMatch === null) {\n\t\t\t\treturn text;\n\t\t\t} else {\n\t\t\t\treturn `${emailMatch[1]} ${emailMatch[2]}`;\n\t\t\t}\n\t\tcase 'default':\n\t\t\treturn makeCodeblock(text);\n\t}\n\n\treturn processInlineTags(text);\n}\n\nfunction getTagDocumentation(\n\ttag: Proto.JSDocTagInfo,\n\tfilePathConverter: IFilePathToResourceConverter,\n): string | undefined {\n\tswitch (tag.name) {\n\t\tcase 'augments':\n\t\tcase 'extends':\n\t\tcase 'param':\n\t\tcase 'template':\n\t\t\tconst body = (convertLinkTags(tag.text, filePathConverter)).split(/^(\\S+)\\s*-?\\s*/);\n\t\t\tif (body?.length === 3) {\n\t\t\t\tconst param = body[1];\n\t\t\t\tconst doc = body[2];\n\t\t\t\tconst label = `*@${tag.name}* \\`${param}\\``;\n\t\t\t\tif (!doc) {\n\t\t\t\t\treturn label;\n\t\t\t\t}\n\t\t\t\treturn label + (doc.match(/\\r\\n|\\n/g) ? '  \\n' + processInlineTags(doc) : `  ${processInlineTags(doc)}`);\n\t\t\t}\n\t}\n\n\t// Generic tag\n\tconst label = `*@${tag.name}*`;\n\tconst text = getTagBodyText(tag, filePathConverter);\n\tif (!text) {\n\t\treturn label;\n\t}\n\treturn label + (text.match(/\\r\\n|\\n/g) ? '  \\n' + text : `  ${text}`);\n}\n\nexport function plainWithLinks(\n\tparts: readonly Proto.SymbolDisplayPart[] | string,\n\tfilePathConverter: IFilePathToResourceConverter,\n): string {\n\treturn processInlineTags(convertLinkTags(parts, filePathConverter));\n}\n\n/**\n * Convert `@link` inline tags to markdown links\n */\nfunction convertLinkTags(\n\tparts: readonly Proto.SymbolDisplayPart[] | string | undefined,\n\tfilePathConverter: IFilePathToResourceConverter,\n): string {\n\tif (!parts) {\n\t\treturn '';\n\t}\n\n\tif (typeof parts === 'string') {\n\t\treturn parts;\n\t}\n\n\tconst out: string[] = [];\n\n\tlet currentLink: { name?: string, target?: Proto.FileSpan, text?: string, readonly linkcode: boolean } | undefined;\n\tfor (const part of parts) {\n\t\tswitch (part.kind) {\n\t\t\tcase 'link':\n\t\t\t\tif (currentLink) {\n\t\t\t\t\tif (currentLink.target) {\n\t\t\t\t\t\tconst link = filePathConverter.toResource(currentLink.target.file)\n\t\t\t\t\t\t\t.with({\n\t\t\t\t\t\t\t\tfragment: `L${currentLink.target.start.line},${currentLink.target.start.offset}`\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\tconst linkText = currentLink.text ? currentLink.text : escapeMarkdownSyntaxTokensForCode(currentLink.name ?? '');\n\t\t\t\t\t\tout.push(`[${currentLink.linkcode ? '`' + linkText + '`' : linkText}](${link.toString()})`);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst text = currentLink.text ?? currentLink.name;\n\t\t\t\t\t\tif (text) {\n\t\t\t\t\t\t\tif (/^https?:/.test(text)) {\n\t\t\t\t\t\t\t\tconst parts = text.split(' ');\n\t\t\t\t\t\t\t\tif (parts.length === 1) {\n\t\t\t\t\t\t\t\t\tout.push(parts[0]);\n\t\t\t\t\t\t\t\t} else if (parts.length > 1) {\n\t\t\t\t\t\t\t\t\tconst linkText = escapeMarkdownSyntaxTokensForCode(parts.slice(1).join(' '));\n\t\t\t\t\t\t\t\t\tout.push(`[${currentLink.linkcode ? '`' + linkText + '`' : linkText}](${parts[0]})`);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tout.push(escapeMarkdownSyntaxTokensForCode(text));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcurrentLink = undefined;\n\t\t\t\t} else {\n\t\t\t\t\tcurrentLink = {\n\t\t\t\t\t\tlinkcode: part.text === '{@linkcode '\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'linkName':\n\t\t\t\tif (currentLink) {\n\t\t\t\t\tcurrentLink.name = part.text;\n\t\t\t\t\tcurrentLink.target = (part as Proto.JSDocLinkDisplayPart).target;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'linkText':\n\t\t\t\tif (currentLink) {\n\t\t\t\t\tcurrentLink.text = part.text;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tout.push(part.text);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\treturn processInlineTags(out.join(''));\n}\n\nexport function tagsMarkdownPreview(\n\ttags: readonly Proto.JSDocTagInfo[],\n\tfilePathConverter: IFilePathToResourceConverter,\n): string {\n\treturn tags.map(tag => getTagDocumentation(tag, filePathConverter)).join('  \\n\\n');\n}\n\nexport function markdownDocumentation(\n\tdocumentation: Proto.SymbolDisplayPart[] | string,\n\ttags: Proto.JSDocTagInfo[],\n\tfilePathConverter: IFilePathToResourceConverter,\n): vscode.MarkdownString {\n\tconst out = new vscode.MarkdownString();\n\taddMarkdownDocumentation(out, documentation, tags, filePathConverter);\n\treturn out;\n}\n\nexport function addMarkdownDocumentation(\n\tout: vscode.MarkdownString,\n\tdocumentation: Proto.SymbolDisplayPart[] | string | undefined,\n\ttags: Proto.JSDocTagInfo[] | undefined,\n\tconverter: IFilePathToResourceConverter,\n): vscode.MarkdownString {\n\tif (documentation) {\n\t\tout.appendMarkdown(plainWithLinks(documentation, converter));\n\t}\n\n\tif (tags) {\n\t\tconst tagsPreview = tagsMarkdownPreview(tags, converter);\n\t\tif (tagsPreview) {\n\t\t\tout.appendMarkdown('\\n\\n' + tagsPreview);\n\t\t}\n\t}\n\treturn out;\n}\n\nfunction escapeMarkdownSyntaxTokensForCode(text: string): string {\n\treturn text.replace(/`/g, '\\\\$&');\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../protocol';\nimport * as PConst from '../protocol.const';\n\nexport function snippetForFunctionCall(\n\titem: { insertText?: string | vscode.SnippetString; label: string; },\n\tdisplayParts: ReadonlyArray<Proto.SymbolDisplayPart>\n): { snippet: vscode.SnippetString, parameterCount: number } {\n\tif (item.insertText && typeof item.insertText !== 'string') {\n\t\treturn { snippet: item.insertText, parameterCount: 0 };\n\t}\n\n\tconst parameterListParts = getParameterListParts(displayParts);\n\tconst snippet = new vscode.SnippetString();\n\tsnippet.appendText(`${item.insertText || item.label}(`);\n\tappendJoinedPlaceholders(snippet, parameterListParts.parts, ', ');\n\tif (parameterListParts.hasOptionalParameters) {\n\t\tsnippet.appendTabstop();\n\t}\n\tsnippet.appendText(')');\n\tsnippet.appendTabstop(0);\n\treturn { snippet, parameterCount: parameterListParts.parts.length + (parameterListParts.hasOptionalParameters ? 1 : 0) };\n}\n\nfunction appendJoinedPlaceholders(\n\tsnippet: vscode.SnippetString,\n\tparts: ReadonlyArray<Proto.SymbolDisplayPart>,\n\tjoiner: string\n) {\n\tfor (let i = 0; i < parts.length; ++i) {\n\t\tconst paramterPart = parts[i];\n\t\tsnippet.appendPlaceholder(paramterPart.text);\n\t\tif (i !== parts.length - 1) {\n\t\t\tsnippet.appendText(joiner);\n\t\t}\n\t}\n}\n\ninterface ParamterListParts {\n\treadonly parts: ReadonlyArray<Proto.SymbolDisplayPart>;\n\treadonly hasOptionalParameters: boolean;\n}\n\nfunction getParameterListParts(\n\tdisplayParts: ReadonlyArray<Proto.SymbolDisplayPart>\n): ParamterListParts {\n\tconst parts: Proto.SymbolDisplayPart[] = [];\n\tlet isInMethod = false;\n\tlet hasOptionalParameters = false;\n\tlet parenCount = 0;\n\tlet braceCount = 0;\n\n\touter: for (let i = 0; i < displayParts.length; ++i) {\n\t\tconst part = displayParts[i];\n\t\tswitch (part.kind) {\n\t\t\tcase PConst.DisplayPartKind.methodName:\n\t\t\tcase PConst.DisplayPartKind.functionName:\n\t\t\tcase PConst.DisplayPartKind.text:\n\t\t\tcase PConst.DisplayPartKind.propertyName:\n\t\t\t\tif (parenCount === 0 && braceCount === 0) {\n\t\t\t\t\tisInMethod = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase PConst.DisplayPartKind.parameterName:\n\t\t\t\tif (parenCount === 1 && braceCount === 0 && isInMethod) {\n\t\t\t\t\t// Only take top level paren names\n\t\t\t\t\tconst next = displayParts[i + 1];\n\t\t\t\t\t// Skip optional parameters\n\t\t\t\t\tconst nameIsFollowedByOptionalIndicator = next && next.text === '?';\n\t\t\t\t\t// Skip this parameter\n\t\t\t\t\tconst nameIsThis = part.text === 'this';\n\t\t\t\t\tif (!nameIsFollowedByOptionalIndicator && !nameIsThis) {\n\t\t\t\t\t\tparts.push(part);\n\t\t\t\t\t}\n\t\t\t\t\thasOptionalParameters = hasOptionalParameters || nameIsFollowedByOptionalIndicator;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase PConst.DisplayPartKind.punctuation:\n\t\t\t\tif (part.text === '(') {\n\t\t\t\t\t++parenCount;\n\t\t\t\t} else if (part.text === ')') {\n\t\t\t\t\t--parenCount;\n\t\t\t\t\tif (parenCount <= 0 && isInMethod) {\n\t\t\t\t\t\tbreak outer;\n\t\t\t\t\t}\n\t\t\t\t} else if (part.text === '...' && parenCount === 1) {\n\t\t\t\t\t// Found rest parmeter. Do not fill in any further arguments\n\t\t\t\t\thasOptionalParameters = true;\n\t\t\t\t\tbreak outer;\n\t\t\t\t} else if (part.text === '{') {\n\t\t\t\t\t++braceCount;\n\t\t\t\t} else if (part.text === '}') {\n\t\t\t\t\t--braceCount;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn { hasOptionalParameters, parts };\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport API from '../utils/api';\nimport { conditionalRegistration, requireSomeCapability } from '../utils/dependentRegistration';\nimport { DocumentSelector } from '../utils/documentSelector';\nimport * as typeConverters from '../utils/typeConverters';\nimport DefinitionProviderBase from './definitionProviderBase';\n\nexport default class TypeScriptDefinitionProvider extends DefinitionProviderBase implements vscode.DefinitionProvider {\n\tconstructor(\n\t\tclient: ITypeScriptServiceClient\n\t) {\n\t\tsuper(client);\n\t}\n\n\tpublic async provideDefinition(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.DefinitionLink[] | vscode.Definition | undefined> {\n\t\tif (this.client.apiVersion.gte(API.v270)) {\n\t\t\tconst filepath = this.client.toOpenedFilePath(document);\n\t\t\tif (!filepath) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(filepath, position);\n\t\t\tconst response = await this.client.execute('definitionAndBoundSpan', args, token);\n\t\t\tif (response.type !== 'response' || !response.body) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tconst span = response.body.textSpan ? typeConverters.Range.fromTextSpan(response.body.textSpan) : undefined;\n\t\t\treturn response.body.definitions\n\t\t\t\t.map((location): vscode.DefinitionLink => {\n\t\t\t\t\tconst target = typeConverters.Location.fromTextSpan(this.client.toResource(location.file), location);\n\t\t\t\t\tif (location.contextStart && location.contextEnd) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\toriginSelectionRange: span,\n\t\t\t\t\t\t\ttargetRange: typeConverters.Range.fromLocations(location.contextStart, location.contextEnd),\n\t\t\t\t\t\t\ttargetUri: target.uri,\n\t\t\t\t\t\t\ttargetSelectionRange: target.range,\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\treturn {\n\t\t\t\t\t\toriginSelectionRange: span,\n\t\t\t\t\t\ttargetRange: target.range,\n\t\t\t\t\t\ttargetUri: target.uri\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t}\n\n\t\treturn this.getSymbolLocations('definition', document, position, token);\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n) {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.EnhancedSyntax, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerDefinitionProvider(selector.syntax,\n\t\t\tnew TypeScriptDefinitionProvider(client));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport * as typeConverters from '../utils/typeConverters';\n\n\nexport default class TypeScriptDefinitionProviderBase {\n\tconstructor(\n\t\tprotected readonly client: ITypeScriptServiceClient\n\t) { }\n\n\tprotected async getSymbolLocations(\n\t\tdefinitionType: 'definition' | 'implementation' | 'typeDefinition',\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.Location[] | undefined> {\n\t\tconst file = this.client.toOpenedFilePath(document);\n\t\tif (!file) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(file, position);\n\t\tconst response = await this.client.execute(definitionType, args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn response.body.map(location =>\n\t\t\ttypeConverters.Location.fromTextSpan(this.client.toResource(location.file), location));\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as nls from 'vscode-nls';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport API from '../utils/api';\nimport { DocumentSelector } from '../utils/documentSelector';\n\nconst localize = nls.loadMessageBundle();\n\ninterface Directive {\n\treadonly value: string;\n\treadonly description: string;\n}\n\nconst tsDirectives: Directive[] = [\n\t{\n\t\tvalue: '@ts-check',\n\t\tdescription: localize(\n\t\t\t'ts-check',\n\t\t\t\"Enables semantic checking in a JavaScript file. Must be at the top of a file.\")\n\t}, {\n\t\tvalue: '@ts-nocheck',\n\t\tdescription: localize(\n\t\t\t'ts-nocheck',\n\t\t\t\"Disables semantic checking in a JavaScript file. Must be at the top of a file.\")\n\t}, {\n\t\tvalue: '@ts-ignore',\n\t\tdescription: localize(\n\t\t\t'ts-ignore',\n\t\t\t\"Suppresses @ts-check errors on the next line of a file.\")\n\t}\n];\n\nconst tsDirectives390: Directive[] = [\n\t...tsDirectives,\n\t{\n\t\tvalue: '@ts-expect-error',\n\t\tdescription: localize(\n\t\t\t'ts-expect-error',\n\t\t\t\"Suppresses @ts-check errors on the next line of a file, expecting at least one to exist.\")\n\t}\n];\n\nclass DirectiveCommentCompletionProvider implements vscode.CompletionItemProvider {\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t) { }\n\n\tpublic provideCompletionItems(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\t_token: vscode.CancellationToken\n\t): vscode.CompletionItem[] {\n\t\tconst file = this.client.toOpenedFilePath(document);\n\t\tif (!file) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst line = document.lineAt(position.line).text;\n\t\tconst prefix = line.slice(0, position.character);\n\t\tconst match = prefix.match(/^\\s*\\/\\/+\\s?(@[a-zA-Z\\-]*)?$/);\n\t\tif (match) {\n\t\t\tconst directives = this.client.apiVersion.gte(API.v390)\n\t\t\t\t? tsDirectives390\n\t\t\t\t: tsDirectives;\n\n\t\t\treturn directives.map(directive => {\n\t\t\t\tconst item = new vscode.CompletionItem(directive.value, vscode.CompletionItemKind.Snippet);\n\t\t\t\titem.detail = directive.description;\n\t\t\t\titem.range = new vscode.Range(position.line, Math.max(0, position.character - (match[1] ? match[1].length : 0)), position.line, position.character);\n\t\t\t\treturn item;\n\t\t\t});\n\t\t}\n\t\treturn [];\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n) {\n\treturn vscode.languages.registerCompletionItemProvider(selector.syntax,\n\t\tnew DirectiveCommentCompletionProvider(client),\n\t\t'@');\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../protocol';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport { flatten } from '../utils/arrays';\nimport { DocumentSelector } from '../utils/documentSelector';\nimport * as typeConverters from '../utils/typeConverters';\n\nclass TypeScriptDocumentHighlightProvider implements vscode.DocumentHighlightProvider {\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient\n\t) { }\n\n\tpublic async provideDocumentHighlights(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.DocumentHighlight[]> {\n\t\tconst file = this.client.toOpenedFilePath(document);\n\t\tif (!file) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst args = {\n\t\t\t...typeConverters.Position.toFileLocationRequestArgs(file, position),\n\t\t\tfilesToSearch: [file]\n\t\t};\n\t\tconst response = await this.client.execute('documentHighlights', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn [];\n\t\t}\n\n\t\treturn flatten(\n\t\t\tresponse.body\n\t\t\t\t.filter(highlight => highlight.file === file)\n\t\t\t\t.map(convertDocumentHighlight));\n\t}\n}\n\nfunction convertDocumentHighlight(highlight: Proto.DocumentHighlightsItem): ReadonlyArray<vscode.DocumentHighlight> {\n\treturn highlight.highlightSpans.map(span =>\n\t\tnew vscode.DocumentHighlight(\n\t\t\ttypeConverters.Range.fromTextSpan(span),\n\t\t\tspan.kind === 'writtenReference' ? vscode.DocumentHighlightKind.Write : vscode.DocumentHighlightKind.Read));\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n) {\n\treturn vscode.languages.registerDocumentHighlightProvider(selector.syntax,\n\t\tnew TypeScriptDocumentHighlightProvider(client));\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../protocol';\nimport * as PConst from '../protocol.const';\nimport { CachedResponse } from '../tsServer/cachedResponse';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport { DocumentSelector } from '../utils/documentSelector';\nimport { parseKindModifier } from '../utils/modifiers';\nimport * as typeConverters from '../utils/typeConverters';\n\nconst getSymbolKind = (kind: string): vscode.SymbolKind => {\n\tswitch (kind) {\n\t\tcase PConst.Kind.module: return vscode.SymbolKind.Module;\n\t\tcase PConst.Kind.class: return vscode.SymbolKind.Class;\n\t\tcase PConst.Kind.enum: return vscode.SymbolKind.Enum;\n\t\tcase PConst.Kind.interface: return vscode.SymbolKind.Interface;\n\t\tcase PConst.Kind.method: return vscode.SymbolKind.Method;\n\t\tcase PConst.Kind.memberVariable: return vscode.SymbolKind.Property;\n\t\tcase PConst.Kind.memberGetAccessor: return vscode.SymbolKind.Property;\n\t\tcase PConst.Kind.memberSetAccessor: return vscode.SymbolKind.Property;\n\t\tcase PConst.Kind.variable: return vscode.SymbolKind.Variable;\n\t\tcase PConst.Kind.const: return vscode.SymbolKind.Variable;\n\t\tcase PConst.Kind.localVariable: return vscode.SymbolKind.Variable;\n\t\tcase PConst.Kind.function: return vscode.SymbolKind.Function;\n\t\tcase PConst.Kind.localFunction: return vscode.SymbolKind.Function;\n\t\tcase PConst.Kind.constructSignature: return vscode.SymbolKind.Constructor;\n\t\tcase PConst.Kind.constructorImplementation: return vscode.SymbolKind.Constructor;\n\t}\n\treturn vscode.SymbolKind.Variable;\n};\n\nclass TypeScriptDocumentSymbolProvider implements vscode.DocumentSymbolProvider {\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate cachedResponse: CachedResponse<Proto.NavTreeResponse>,\n\t) { }\n\n\tpublic async provideDocumentSymbols(document: vscode.TextDocument, token: vscode.CancellationToken): Promise<vscode.DocumentSymbol[] | undefined> {\n\t\tconst file = this.client.toOpenedFilePath(document);\n\t\tif (!file) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst args: Proto.FileRequestArgs = { file };\n\t\tconst response = await this.cachedResponse.execute(document, () => this.client.execute('navtree', args, token));\n\t\tif (response.type !== 'response' || !response.body?.childItems) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// The root represents the file. Ignore this when showing in the UI\n\t\tconst result: vscode.DocumentSymbol[] = [];\n\t\tfor (const item of response.body.childItems) {\n\t\t\tTypeScriptDocumentSymbolProvider.convertNavTree(document.uri, result, item);\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate static convertNavTree(\n\t\tresource: vscode.Uri,\n\t\toutput: vscode.DocumentSymbol[],\n\t\titem: Proto.NavigationTree,\n\t): boolean {\n\t\tlet shouldInclude = TypeScriptDocumentSymbolProvider.shouldInclueEntry(item);\n\t\tif (!shouldInclude && !item.childItems?.length) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst children = new Set(item.childItems || []);\n\t\tfor (const span of item.spans) {\n\t\t\tconst range = typeConverters.Range.fromTextSpan(span);\n\t\t\tconst symbolInfo = TypeScriptDocumentSymbolProvider.convertSymbol(item, range);\n\n\t\t\tfor (const child of children) {\n\t\t\t\tif (child.spans.some(span => !!range.intersection(typeConverters.Range.fromTextSpan(span)))) {\n\t\t\t\t\tconst includedChild = TypeScriptDocumentSymbolProvider.convertNavTree(resource, symbolInfo.children, child);\n\t\t\t\t\tshouldInclude = shouldInclude || includedChild;\n\t\t\t\t\tchildren.delete(child);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (shouldInclude) {\n\t\t\t\toutput.push(symbolInfo);\n\t\t\t}\n\t\t}\n\n\t\treturn shouldInclude;\n\t}\n\n\tprivate static convertSymbol(item: Proto.NavigationTree, range: vscode.Range): vscode.DocumentSymbol {\n\t\tconst selectionRange = item.nameSpan ? typeConverters.Range.fromTextSpan(item.nameSpan) : range;\n\t\tlet label = item.text;\n\n\t\tswitch (item.kind) {\n\t\t\tcase PConst.Kind.memberGetAccessor: label = `(get) ${label}`; break;\n\t\t\tcase PConst.Kind.memberSetAccessor: label = `(set) ${label}`; break;\n\t\t}\n\n\t\tconst symbolInfo = new vscode.DocumentSymbol(\n\t\t\tlabel,\n\t\t\t'',\n\t\t\tgetSymbolKind(item.kind),\n\t\t\trange,\n\t\t\trange.contains(selectionRange) ? selectionRange : range);\n\n\n\t\tconst kindModifiers = parseKindModifier(item.kindModifiers);\n\t\tif (kindModifiers.has(PConst.KindModifiers.deprecated)) {\n\t\t\tsymbolInfo.tags = [vscode.SymbolTag.Deprecated];\n\t\t}\n\n\t\treturn symbolInfo;\n\t}\n\n\tprivate static shouldInclueEntry(item: Proto.NavigationTree | Proto.NavigationBarItem): boolean {\n\t\tif (item.kind === PConst.Kind.alias) {\n\t\t\treturn false;\n\t\t}\n\t\treturn !!(item.text && item.text !== '<function>' && item.text !== '<class>');\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n\tcachedResponse: CachedResponse<Proto.NavTreeResponse>,\n) {\n\treturn vscode.languages.registerDocumentSymbolProvider(selector.syntax,\n\t\tnew TypeScriptDocumentSymbolProvider(client, cachedResponse), { label: 'TypeScript' });\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as nls from 'vscode-nls';\nimport { Command, CommandManager } from '../commands/commandManager';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport API from '../utils/api';\nimport { isSupportedLanguageMode } from '../utils/languageModeIds';\nimport * as typeConverters from '../utils/typeConverters';\n\nconst localize = nls.loadMessageBundle();\n\nclass FileReferencesCommand implements Command {\n\n\tpublic static readonly context = 'tsSupportsFileReferences';\n\tpublic static readonly minVersion = API.v420;\n\n\tpublic readonly id = 'typescript.findAllFileReferences';\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient\n\t) { }\n\n\tpublic async execute(resource?: vscode.Uri) {\n\t\tif (this.client.apiVersion.lt(FileReferencesCommand.minVersion)) {\n\t\t\tvscode.window.showErrorMessage(localize('error.unsupportedVersion', \"Find file references failed. Requires TypeScript 4.2+.\"));\n\t\t\treturn;\n\t\t}\n\n\t\tif (!resource) {\n\t\t\tresource = vscode.window.activeTextEditor?.document.uri;\n\t\t}\n\n\t\tif (!resource) {\n\t\t\tvscode.window.showErrorMessage(localize('error.noResource', \"Find file references failed. No resource provided.\"));\n\t\t\treturn;\n\t\t}\n\n\t\tconst document = await vscode.workspace.openTextDocument(resource);\n\t\tif (!isSupportedLanguageMode(document)) {\n\t\t\tvscode.window.showErrorMessage(localize('error.unsupportedLanguage', \"Find file references failed. Unsupported file type.\"));\n\t\t\treturn;\n\t\t}\n\n\t\tconst openedFiledPath = this.client.toOpenedFilePath(document);\n\t\tif (!openedFiledPath) {\n\t\t\tvscode.window.showErrorMessage(localize('error.unknownFile', \"Find file references failed. Unknown file type.\"));\n\t\t\treturn;\n\t\t}\n\n\t\tawait vscode.window.withProgress({\n\t\t\tlocation: vscode.ProgressLocation.Window,\n\t\t\ttitle: localize('progress.title', \"Finding file references\")\n\t\t}, async (_progress, token) => {\n\n\t\t\tconst response = await this.client.execute('fileReferences', {\n\t\t\t\tfile: openedFiledPath\n\t\t\t}, token);\n\t\t\tif (response.type !== 'response' || !response.body) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst locations: vscode.Location[] = response.body.refs.map(reference =>\n\t\t\t\ttypeConverters.Location.fromTextSpan(this.client.toResource(reference.file), reference));\n\n\t\t\tconst config = vscode.workspace.getConfiguration('references');\n\t\t\tconst existingSetting = config.inspect<string>('preferredLocation');\n\n\t\t\tawait config.update('preferredLocation', 'view');\n\t\t\ttry {\n\t\t\t\tawait vscode.commands.executeCommand('editor.action.showReferences', resource, new vscode.Position(0, 0), locations);\n\t\t\t} finally {\n\t\t\t\tawait config.update('preferredLocation', existingSetting?.workspaceFolderValue ?? existingSetting?.workspaceValue);\n\t\t\t}\n\t\t});\n\t}\n}\n\n\nexport function register(\n\tclient: ITypeScriptServiceClient,\n\tcommandManager: CommandManager\n) {\n\tfunction updateContext() {\n\t\tvscode.commands.executeCommand('setContext', FileReferencesCommand.context, client.apiVersion.gte(FileReferencesCommand.minVersion));\n\t}\n\tupdateContext();\n\n\tcommandManager.register(new FileReferencesCommand(client));\n\treturn client.onTsServerStarted(() => updateContext());\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as nls from 'vscode-nls';\nimport type * as Proto from '../protocol';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport API from '../utils/api';\nimport { conditionalRegistration, requireMinVersion, requireSomeCapability } from '../utils/dependentRegistration';\nimport { DocumentSelector } from '../utils/documentSelector';\nimport * as errorCodes from '../utils/errorCodes';\nimport * as fixNames from '../utils/fixNames';\nimport * as typeConverters from '../utils/typeConverters';\nimport { DiagnosticsManager } from './diagnostics';\nimport FileConfigurationManager from './fileConfigurationManager';\n\nconst localize = nls.loadMessageBundle();\n\ninterface AutoFix {\n\treadonly codes: Set<number>;\n\treadonly fixName: string;\n}\n\nasync function buildIndividualFixes(\n\tfixes: readonly AutoFix[],\n\tedit: vscode.WorkspaceEdit,\n\tclient: ITypeScriptServiceClient,\n\tfile: string,\n\tdiagnostics: readonly vscode.Diagnostic[],\n\ttoken: vscode.CancellationToken,\n): Promise<void> {\n\tfor (const diagnostic of diagnostics) {\n\t\tfor (const { codes, fixName } of fixes) {\n\t\t\tif (token.isCancellationRequested) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!codes.has(diagnostic.code as number)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst args: Proto.CodeFixRequestArgs = {\n\t\t\t\t...typeConverters.Range.toFileRangeRequestArgs(file, diagnostic.range),\n\t\t\t\terrorCodes: [+(diagnostic.code!)]\n\t\t\t};\n\n\t\t\tconst response = await client.execute('getCodeFixes', args, token);\n\t\t\tif (response.type !== 'response') {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst fix = response.body?.find(fix => fix.fixName === fixName);\n\t\t\tif (fix) {\n\t\t\t\ttypeConverters.WorkspaceEdit.withFileCodeEdits(edit, client, fix.changes);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n\nasync function buildCombinedFix(\n\tfixes: readonly AutoFix[],\n\tedit: vscode.WorkspaceEdit,\n\tclient: ITypeScriptServiceClient,\n\tfile: string,\n\tdiagnostics: readonly vscode.Diagnostic[],\n\ttoken: vscode.CancellationToken,\n): Promise<void> {\n\tfor (const diagnostic of diagnostics) {\n\t\tfor (const { codes, fixName } of fixes) {\n\t\t\tif (token.isCancellationRequested) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!codes.has(diagnostic.code as number)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst args: Proto.CodeFixRequestArgs = {\n\t\t\t\t...typeConverters.Range.toFileRangeRequestArgs(file, diagnostic.range),\n\t\t\t\terrorCodes: [+(diagnostic.code!)]\n\t\t\t};\n\n\t\t\tconst response = await client.execute('getCodeFixes', args, token);\n\t\t\tif (response.type !== 'response' || !response.body?.length) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst fix = response.body?.find(fix => fix.fixName === fixName);\n\t\t\tif (!fix) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (!fix.fixId) {\n\t\t\t\ttypeConverters.WorkspaceEdit.withFileCodeEdits(edit, client, fix.changes);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst combinedArgs: Proto.GetCombinedCodeFixRequestArgs = {\n\t\t\t\tscope: {\n\t\t\t\t\ttype: 'file',\n\t\t\t\t\targs: { file }\n\t\t\t\t},\n\t\t\t\tfixId: fix.fixId,\n\t\t\t};\n\n\t\t\tconst combinedResponse = await client.execute('getCombinedCodeFix', combinedArgs, token);\n\t\t\tif (combinedResponse.type !== 'response' || !combinedResponse.body) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttypeConverters.WorkspaceEdit.withFileCodeEdits(edit, client, combinedResponse.body.changes);\n\t\t\treturn;\n\t\t}\n\t}\n}\n\n// #region Source Actions\n\nabstract class SourceAction extends vscode.CodeAction {\n\tabstract build(\n\t\tclient: ITypeScriptServiceClient,\n\t\tfile: string,\n\t\tdiagnostics: readonly vscode.Diagnostic[],\n\t\ttoken: vscode.CancellationToken,\n\t): Promise<void>;\n}\n\nclass SourceFixAll extends SourceAction {\n\n\tstatic readonly kind = vscode.CodeActionKind.SourceFixAll.append('ts');\n\n\tconstructor() {\n\t\tsuper(localize('autoFix.label', 'Fix All'), SourceFixAll.kind);\n\t}\n\n\tasync build(client: ITypeScriptServiceClient, file: string, diagnostics: readonly vscode.Diagnostic[], token: vscode.CancellationToken): Promise<void> {\n\t\tthis.edit = new vscode.WorkspaceEdit();\n\n\t\tawait buildIndividualFixes([\n\t\t\t{ codes: errorCodes.incorrectlyImplementsInterface, fixName: fixNames.classIncorrectlyImplementsInterface },\n\t\t\t{ codes: errorCodes.asyncOnlyAllowedInAsyncFunctions, fixName: fixNames.awaitInSyncFunction },\n\t\t], this.edit, client, file, diagnostics, token);\n\n\t\tawait buildCombinedFix([\n\t\t\t{ codes: errorCodes.unreachableCode, fixName: fixNames.unreachableCode }\n\t\t], this.edit, client, file, diagnostics, token);\n\t}\n}\n\nclass SourceRemoveUnused extends SourceAction {\n\n\tstatic readonly kind = vscode.CodeActionKind.Source.append('removeUnused').append('ts');\n\n\tconstructor() {\n\t\tsuper(localize('autoFix.unused.label', 'Remove all unused code'), SourceRemoveUnused.kind);\n\t}\n\n\tasync build(client: ITypeScriptServiceClient, file: string, diagnostics: readonly vscode.Diagnostic[], token: vscode.CancellationToken): Promise<void> {\n\t\tthis.edit = new vscode.WorkspaceEdit();\n\t\tawait buildCombinedFix([\n\t\t\t{ codes: errorCodes.variableDeclaredButNeverUsed, fixName: fixNames.unusedIdentifier },\n\t\t], this.edit, client, file, diagnostics, token);\n\t}\n}\n\nclass SourceAddMissingImports extends SourceAction {\n\n\tstatic readonly kind = vscode.CodeActionKind.Source.append('addMissingImports').append('ts');\n\n\tconstructor() {\n\t\tsuper(localize('autoFix.missingImports.label', 'Add all missing imports'), SourceAddMissingImports.kind);\n\t}\n\n\tasync build(client: ITypeScriptServiceClient, file: string, diagnostics: readonly vscode.Diagnostic[], token: vscode.CancellationToken): Promise<void> {\n\t\tthis.edit = new vscode.WorkspaceEdit();\n\t\tawait buildCombinedFix([\n\t\t\t{ codes: errorCodes.cannotFindName, fixName: fixNames.fixImport }\n\t\t],\n\t\t\tthis.edit, client, file, diagnostics, token);\n\t}\n}\n\n//#endregion\n\nclass TypeScriptAutoFixProvider implements vscode.CodeActionProvider {\n\n\tprivate static kindProviders = [\n\t\tSourceFixAll,\n\t\tSourceRemoveUnused,\n\t\tSourceAddMissingImports,\n\t];\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly fileConfigurationManager: FileConfigurationManager,\n\t\tprivate readonly diagnosticsManager: DiagnosticsManager,\n\t) { }\n\n\tpublic get metadata(): vscode.CodeActionProviderMetadata {\n\t\treturn {\n\t\t\tprovidedCodeActionKinds: TypeScriptAutoFixProvider.kindProviders.map(x => x.kind),\n\t\t};\n\t}\n\n\tpublic async provideCodeActions(\n\t\tdocument: vscode.TextDocument,\n\t\t_range: vscode.Range,\n\t\tcontext: vscode.CodeActionContext,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.CodeAction[] | undefined> {\n\t\tif (!context.only || !vscode.CodeActionKind.Source.intersects(context.only)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst file = this.client.toOpenedFilePath(document);\n\t\tif (!file) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst actions = this.getFixAllActions(context.only);\n\t\tif (this.client.bufferSyncSupport.hasPendingDiagnostics(document.uri)) {\n\t\t\treturn actions;\n\t\t}\n\n\t\tconst diagnostics = this.diagnosticsManager.getDiagnostics(document.uri);\n\t\tif (!diagnostics.length) {\n\t\t\t// Actions are a no-op in this case but we still want to return them\n\t\t\treturn actions;\n\t\t}\n\n\t\tawait this.fileConfigurationManager.ensureConfigurationForDocument(document, token);\n\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tawait Promise.all(actions.map(action => action.build(this.client, file, diagnostics, token)));\n\n\t\treturn actions;\n\t}\n\n\tprivate getFixAllActions(only: vscode.CodeActionKind): SourceAction[] {\n\t\treturn TypeScriptAutoFixProvider.kindProviders\n\t\t\t.filter(provider => only.intersects(provider.kind))\n\t\t\t.map(provider => new provider());\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n\tfileConfigurationManager: FileConfigurationManager,\n\tdiagnosticsManager: DiagnosticsManager,\n) {\n\treturn conditionalRegistration([\n\t\trequireMinVersion(client, API.v300),\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\tconst provider = new TypeScriptAutoFixProvider(client, fileConfigurationManager, diagnosticsManager);\n\t\treturn vscode.languages.registerCodeActionsProvider(selector.semantic, provider, provider.metadata);\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport const variableDeclaredButNeverUsed = new Set([6196, 6133]);\nexport const propertyDeclaretedButNeverUsed = new Set([6138]);\nexport const allImportsAreUnused = new Set([6192]);\nexport const unreachableCode = new Set([7027]);\nexport const unusedLabel = new Set([7028]);\nexport const fallThroughCaseInSwitch = new Set([7029]);\nexport const notAllCodePathsReturnAValue = new Set([7030]);\nexport const incorrectlyImplementsInterface = new Set([2420]);\nexport const cannotFindName = new Set([2552, 2304]);\nexport const extendsShouldBeImplements = new Set([2689]);\nexport const asyncOnlyAllowedInAsyncFunctions = new Set([1308]);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport const annotateWithTypeFromJSDoc = 'annotateWithTypeFromJSDoc';\nexport const constructorForDerivedNeedSuperCall = 'constructorForDerivedNeedSuperCall';\nexport const extendsInterfaceBecomesImplements = 'extendsInterfaceBecomesImplements';\nexport const awaitInSyncFunction = 'fixAwaitInSyncFunction';\nexport const classIncorrectlyImplementsInterface = 'fixClassIncorrectlyImplementsInterface';\nexport const classDoesntImplementInheritedAbstractMember = 'fixClassDoesntImplementInheritedAbstractMember';\nexport const unreachableCode = 'fixUnreachableCode';\nexport const unusedIdentifier = 'unusedIdentifier';\nexport const forgottenThisPropertyAccess = 'forgottenThisPropertyAccess';\nexport const spelling = 'spelling';\nexport const fixImport = 'import';\nexport const addMissingAwait = 'addMissingAwait';\nexport const addMissingOverride = 'fixOverrideModifier';\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../protocol';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport API from '../utils/api';\nimport { coalesce } from '../utils/arrays';\nimport { conditionalRegistration, requireMinVersion } from '../utils/dependentRegistration';\nimport { DocumentSelector } from '../utils/documentSelector';\nimport * as typeConverters from '../utils/typeConverters';\n\nclass TypeScriptFoldingProvider implements vscode.FoldingRangeProvider {\n\tpublic static readonly minVersion = API.v280;\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient\n\t) { }\n\n\tasync provideFoldingRanges(\n\t\tdocument: vscode.TextDocument,\n\t\t_context: vscode.FoldingContext,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.FoldingRange[] | undefined> {\n\t\tconst file = this.client.toOpenedFilePath(document);\n\t\tif (!file) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst args: Proto.FileRequestArgs = { file };\n\t\tconst response = await this.client.execute('getOutliningSpans', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn coalesce(response.body.map(span => this.convertOutliningSpan(span, document)));\n\t}\n\n\tprivate convertOutliningSpan(\n\t\tspan: Proto.OutliningSpan,\n\t\tdocument: vscode.TextDocument\n\t): vscode.FoldingRange | undefined {\n\t\tconst range = typeConverters.Range.fromTextSpan(span.textSpan);\n\t\tconst kind = TypeScriptFoldingProvider.getFoldingRangeKind(span);\n\n\t\t// Workaround for #49904\n\t\tif (span.kind === 'comment') {\n\t\t\tconst line = document.lineAt(range.start.line).text;\n\t\t\tif (line.match(/\\/\\/\\s*#endregion/gi)) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}\n\n\t\tconst start = range.start.line;\n\t\tconst end = this.adjustFoldingEnd(range, document);\n\t\treturn new vscode.FoldingRange(start, end, kind);\n\t}\n\n\tprivate static readonly foldEndPairCharacters = ['}', ']', ')', '`', '>'];\n\n\tprivate adjustFoldingEnd(range: vscode.Range, document: vscode.TextDocument) {\n\t\t// workaround for #47240\n\t\tif (range.end.character > 0) {\n\t\t\tconst foldEndCharacter = document.getText(new vscode.Range(range.end.translate(0, -1), range.end));\n\t\t\tif (TypeScriptFoldingProvider.foldEndPairCharacters.includes(foldEndCharacter)) {\n\t\t\t\treturn Math.max(range.end.line - 1, range.start.line);\n\t\t\t}\n\t\t}\n\n\t\treturn range.end.line;\n\t}\n\n\tprivate static getFoldingRangeKind(span: Proto.OutliningSpan): vscode.FoldingRangeKind | undefined {\n\t\tswitch (span.kind) {\n\t\t\tcase 'comment': return vscode.FoldingRangeKind.Comment;\n\t\t\tcase 'region': return vscode.FoldingRangeKind.Region;\n\t\t\tcase 'imports': return vscode.FoldingRangeKind.Imports;\n\t\t\tcase 'code':\n\t\t\tdefault: return undefined;\n\t\t}\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n): vscode.Disposable {\n\treturn conditionalRegistration([\n\t\trequireMinVersion(client, TypeScriptFoldingProvider.minVersion),\n\t], () => {\n\t\treturn vscode.languages.registerFoldingRangeProvider(selector.syntax,\n\t\t\tnew TypeScriptFoldingProvider(client));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../protocol';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport { conditionalRegistration, requireConfiguration } from '../utils/dependentRegistration';\nimport { DocumentSelector } from '../utils/documentSelector';\nimport * as typeConverters from '../utils/typeConverters';\nimport FileConfigurationManager from './fileConfigurationManager';\n\nclass TypeScriptFormattingProvider implements vscode.DocumentRangeFormattingEditProvider, vscode.OnTypeFormattingEditProvider {\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly formattingOptionsManager: FileConfigurationManager\n\t) { }\n\n\tpublic async provideDocumentRangeFormattingEdits(\n\t\tdocument: vscode.TextDocument,\n\t\trange: vscode.Range,\n\t\toptions: vscode.FormattingOptions,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.TextEdit[] | undefined> {\n\t\tconst file = this.client.toOpenedFilePath(document);\n\t\tif (!file) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tawait this.formattingOptionsManager.ensureConfigurationOptions(document, options, token);\n\n\t\tconst args = typeConverters.Range.toFormattingRequestArgs(file, range);\n\t\tconst response = await this.client.execute('format', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn response.body.map(typeConverters.TextEdit.fromCodeEdit);\n\t}\n\n\tpublic async provideOnTypeFormattingEdits(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\tch: string,\n\t\toptions: vscode.FormattingOptions,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.TextEdit[]> {\n\t\tconst file = this.client.toOpenedFilePath(document);\n\t\tif (!file) {\n\t\t\treturn [];\n\t\t}\n\n\t\tawait this.formattingOptionsManager.ensureConfigurationOptions(document, options, token);\n\n\t\tconst args: Proto.FormatOnKeyRequestArgs = {\n\t\t\t...typeConverters.Position.toFileLocationRequestArgs(file, position),\n\t\t\tkey: ch\n\t\t};\n\t\tconst response = await this.client.execute('formatonkey', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst result: vscode.TextEdit[] = [];\n\t\tfor (const edit of response.body) {\n\t\t\tconst textEdit = typeConverters.TextEdit.fromCodeEdit(edit);\n\t\t\tconst range = textEdit.range;\n\t\t\t// Work around for https://github.com/microsoft/TypeScript/issues/6700.\n\t\t\t// Check if we have an edit at the beginning of the line which only removes white spaces and leaves\n\t\t\t// an empty line. Drop those edits\n\t\t\tif (range.start.character === 0 && range.start.line === range.end.line && textEdit.newText === '') {\n\t\t\t\tconst lText = document.lineAt(range.start.line).text;\n\t\t\t\t// If the edit leaves something on the line keep the edit (note that the end character is exclusive).\n\t\t\t\t// Keep it also if it removes something else than whitespace\n\t\t\t\tif (lText.trim().length > 0 || lText.length > range.end.character) {\n\t\t\t\t\tresult.push(textEdit);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresult.push(textEdit);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tmodeId: string,\n\tclient: ITypeScriptServiceClient,\n\tfileConfigurationManager: FileConfigurationManager\n) {\n\treturn conditionalRegistration([\n\t\trequireConfiguration(modeId, 'format.enable'),\n\t], () => {\n\t\tconst formattingProvider = new TypeScriptFormattingProvider(client, fileConfigurationManager);\n\t\treturn vscode.Disposable.from(\n\t\t\tvscode.languages.registerOnTypeFormattingEditProvider(selector.syntax, formattingProvider, ';', '}', '\\n'),\n\t\t\tvscode.languages.registerDocumentRangeFormattingEditProvider(selector.syntax, formattingProvider),\n\t\t);\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../protocol';\nimport { localize } from '../tsServer/versionProvider';\nimport { ClientCapability, ITypeScriptServiceClient, ServerType } from '../typescriptService';\nimport { conditionalRegistration, requireSomeCapability } from '../utils/dependentRegistration';\nimport { DocumentSelector } from '../utils/documentSelector';\nimport { markdownDocumentation } from '../utils/previewer';\nimport * as typeConverters from '../utils/typeConverters';\nimport FileConfigurationManager from './fileConfigurationManager';\n\n\nclass TypeScriptHoverProvider implements vscode.HoverProvider {\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly fileConfigurationManager: FileConfigurationManager,\n\t) { }\n\n\tpublic async provideHover(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.Hover | undefined> {\n\t\tconst filepath = this.client.toOpenedFilePath(document);\n\t\tif (!filepath) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst response = await this.client.interruptGetErr(async () => {\n\t\t\tawait this.fileConfigurationManager.ensureConfigurationForDocument(document, token);\n\n\t\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(filepath, position);\n\t\t\treturn this.client.execute('quickinfo', args, token);\n\t\t});\n\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn new vscode.Hover(\n\t\t\tthis.getContents(document.uri, response.body, response._serverType),\n\t\t\ttypeConverters.Range.fromTextSpan(response.body));\n\t}\n\n\tprivate getContents(\n\t\tresource: vscode.Uri,\n\t\tdata: Proto.QuickInfoResponseBody,\n\t\tsource: ServerType | undefined,\n\t) {\n\t\tconst parts: vscode.MarkdownString[] = [];\n\n\t\tif (data.displayString) {\n\t\t\tconst displayParts: string[] = [];\n\n\t\t\tif (source === ServerType.Syntax && this.client.hasCapabilityForResource(resource, ClientCapability.Semantic)) {\n\t\t\t\tdisplayParts.push(\n\t\t\t\t\tlocalize({\n\t\t\t\t\t\tkey: 'loadingPrefix',\n\t\t\t\t\t\tcomment: ['Prefix displayed for hover entries while the server is still loading']\n\t\t\t\t\t}, \"(loading...)\"));\n\t\t\t}\n\n\t\t\tdisplayParts.push(data.displayString);\n\t\t\tparts.push(new vscode.MarkdownString().appendCodeblock(displayParts.join(' '), 'typescript'));\n\t\t}\n\t\tparts.push(markdownDocumentation(data.documentation, data.tags, this.client));\n\t\treturn parts;\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n\tfileConfigurationManager: FileConfigurationManager,\n): vscode.Disposable {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.EnhancedSyntax, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerHoverProvider(selector.syntax,\n\t\t\tnew TypeScriptHoverProvider(client, fileConfigurationManager));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from 'vscode-nls';\nimport API from '../utils/api';\nimport { TypeScriptServiceConfiguration } from '../utils/configuration';\n\nexport const localize = nls.loadMessageBundle();\n\nexport const enum TypeScriptVersionSource {\n\tBundled = 'bundled',\n\tTsNightlyExtension = 'ts-nightly-extension',\n\tNodeModules = 'node-modules',\n\tUserSetting = 'user-setting',\n\tWorkspaceSetting = 'workspace-setting',\n}\n\nexport class TypeScriptVersion {\n\n\tconstructor(\n\t\tpublic readonly source: TypeScriptVersionSource,\n\t\tpublic readonly path: string,\n\t\tpublic readonly apiVersion: API | undefined,\n\t\tprivate readonly _pathLabel?: string,\n\t) { }\n\n\tpublic get tsServerPath(): string {\n\t\treturn this.path;\n\t}\n\n\tpublic get pathLabel(): string {\n\t\treturn this._pathLabel ?? this.path;\n\t}\n\n\tpublic get isValid(): boolean {\n\t\treturn this.apiVersion !== undefined;\n\t}\n\n\tpublic eq(other: TypeScriptVersion): boolean {\n\t\tif (this.path !== other.path) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.apiVersion === other.apiVersion) {\n\t\t\treturn true;\n\t\t}\n\t\tif (!this.apiVersion || !other.apiVersion) {\n\t\t\treturn false;\n\t\t}\n\t\treturn this.apiVersion.eq(other.apiVersion);\n\t}\n\n\tpublic get displayName(): string {\n\t\tconst version = this.apiVersion;\n\t\treturn version ? version.displayName : localize(\n\t\t\t'couldNotLoadTsVersion', 'Could not load the TypeScript version at this path');\n\t}\n}\n\nexport interface ITypeScriptVersionProvider {\n\tupdateConfiguration(configuration: TypeScriptServiceConfiguration): void;\n\n\treadonly defaultVersion: TypeScriptVersion;\n\treadonly globalVersion: TypeScriptVersion | undefined;\n\treadonly localVersion: TypeScriptVersion | undefined;\n\treadonly localVersions: readonly TypeScriptVersion[];\n\treadonly bundledVersion: TypeScriptVersion;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport { conditionalRegistration, requireSomeCapability } from '../utils/dependentRegistration';\nimport { DocumentSelector } from '../utils/documentSelector';\nimport DefinitionProviderBase from './definitionProviderBase';\n\nclass TypeScriptImplementationProvider extends DefinitionProviderBase implements vscode.ImplementationProvider {\n\tpublic provideImplementation(document: vscode.TextDocument, position: vscode.Position, token: vscode.CancellationToken): Promise<vscode.Definition | undefined> {\n\t\treturn this.getSymbolLocations('implementation', document, position, token);\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n) {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerImplementationProvider(selector.semantic,\n\t\t\tnew TypeScriptImplementationProvider(client));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as nls from 'vscode-nls';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport { conditionalRegistration, requireConfiguration } from '../utils/dependentRegistration';\nimport { DocumentSelector } from '../utils/documentSelector';\nimport * as typeConverters from '../utils/typeConverters';\nimport FileConfigurationManager from './fileConfigurationManager';\n\n\nconst localize = nls.loadMessageBundle();\n\nconst defaultJsDoc = new vscode.SnippetString(`/**\\n * $0\\n */`);\n\nclass JsDocCompletionItem extends vscode.CompletionItem {\n\tconstructor(\n\t\tpublic readonly document: vscode.TextDocument,\n\t\tpublic readonly position: vscode.Position\n\t) {\n\t\tsuper('/** */', vscode.CompletionItemKind.Text);\n\t\tthis.detail = localize('typescript.jsDocCompletionItem.documentation', 'JSDoc comment');\n\t\tthis.sortText = '\\0';\n\n\t\tconst line = document.lineAt(position.line).text;\n\t\tconst prefix = line.slice(0, position.character).match(/\\/\\**\\s*$/);\n\t\tconst suffix = line.slice(position.character).match(/^\\s*\\**\\//);\n\t\tconst start = position.translate(0, prefix ? -prefix[0].length : 0);\n\t\tconst range = new vscode.Range(start, position.translate(0, suffix ? suffix[0].length : 0));\n\t\tthis.range = { inserting: range, replacing: range };\n\t}\n}\n\nclass JsDocCompletionProvider implements vscode.CompletionItemProvider {\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly fileConfigurationManager: FileConfigurationManager,\n\t) { }\n\n\tpublic async provideCompletionItems(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.CompletionItem[] | undefined> {\n\t\tconst file = this.client.toOpenedFilePath(document);\n\t\tif (!file) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (!this.isPotentiallyValidDocCompletionPosition(document, position)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst response = await this.client.interruptGetErr(async () => {\n\t\t\tawait this.fileConfigurationManager.ensureConfigurationForDocument(document, token);\n\n\t\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(file, position);\n\t\t\treturn this.client.execute('docCommentTemplate', args, token);\n\t\t});\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst item = new JsDocCompletionItem(document, position);\n\n\t\t// Workaround for #43619\n\t\t// docCommentTemplate previously returned undefined for empty jsdoc templates.\n\t\t// TS 2.7 now returns a single line doc comment, which breaks indentation.\n\t\tif (response.body.newText === '/** */') {\n\t\t\titem.insertText = defaultJsDoc;\n\t\t} else {\n\t\t\titem.insertText = templateToSnippet(response.body.newText);\n\t\t}\n\n\t\treturn [item];\n\t}\n\n\tprivate isPotentiallyValidDocCompletionPosition(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position\n\t): boolean {\n\t\t// Only show the JSdoc completion when the everything before the cursor is whitespace\n\t\t// or could be the opening of a comment\n\t\tconst line = document.lineAt(position.line).text;\n\t\tconst prefix = line.slice(0, position.character);\n\t\tif (!/^\\s*$|\\/\\*\\*\\s*$|^\\s*\\/\\*\\*+\\s*$/.test(prefix)) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// And everything after is possibly a closing comment or more whitespace\n\t\tconst suffix = line.slice(position.character);\n\t\treturn /^\\s*(\\*+\\/)?\\s*$/.test(suffix);\n\t}\n}\n\nexport function templateToSnippet(template: string): vscode.SnippetString {\n\t// TODO: use append placeholder\n\tlet snippetIndex = 1;\n\ttemplate = template.replace(/\\$/g, '\\\\$');\n\ttemplate = template.replace(/^[ \\t]*(?=(\\/|[ ]\\*))/gm, '');\n\ttemplate = template.replace(/^(\\/\\*\\*\\s*\\*[ ]*)$/m, (x) => x + `\\$0`);\n\ttemplate = template.replace(/\\* @param([ ]\\{\\S+\\})?\\s+(\\S+)[ \\t]*$/gm, (_param, type, post) => {\n\t\tlet out = '* @param ';\n\t\tif (type === ' {any}' || type === ' {*}') {\n\t\t\tout += `{\\$\\{${snippetIndex++}:*\\}} `;\n\t\t} else if (type) {\n\t\t\tout += type + ' ';\n\t\t}\n\t\tout += post + ` \\${${snippetIndex++}}`;\n\t\treturn out;\n\t});\n\n\ttemplate = template.replace(/\\* @returns[ \\t]*$/gm, `* @returns \\${${snippetIndex++}}`);\n\n\treturn new vscode.SnippetString(template);\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tmodeId: string,\n\tclient: ITypeScriptServiceClient,\n\tfileConfigurationManager: FileConfigurationManager,\n\n): vscode.Disposable {\n\treturn conditionalRegistration([\n\t\trequireConfiguration(modeId, 'suggest.completeJSDocs')\n\t], () => {\n\t\treturn vscode.languages.registerCompletionItemProvider(selector.syntax,\n\t\t\tnew JsDocCompletionProvider(client, fileConfigurationManager),\n\t\t\t'*');\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as nls from 'vscode-nls';\nimport { Command, CommandManager } from '../commands/commandManager';\nimport type * as Proto from '../protocol';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport API from '../utils/api';\nimport { nulToken } from '../utils/cancellation';\nimport { conditionalRegistration, requireMinVersion, requireSomeCapability } from '../utils/dependentRegistration';\nimport { DocumentSelector } from '../utils/documentSelector';\nimport { TelemetryReporter } from '../utils/telemetry';\nimport * as typeConverters from '../utils/typeConverters';\nimport FileConfigurationManager from './fileConfigurationManager';\n\nconst localize = nls.loadMessageBundle();\n\n\nclass OrganizeImportsCommand implements Command {\n\tpublic static readonly Id = '_typescript.organizeImports';\n\n\tpublic readonly id = OrganizeImportsCommand.Id;\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly telemetryReporter: TelemetryReporter,\n\t) { }\n\n\tpublic async execute(file: string, sortOnly = false): Promise<any> {\n\t\t/* __GDPR__\n\t\t\t\"organizeImports.execute\" : {\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t]\n\t\t\t}\n\t\t*/\n\t\tthis.telemetryReporter.logTelemetry('organizeImports.execute', {});\n\n\t\tconst args: Proto.OrganizeImportsRequestArgs = {\n\t\t\tscope: {\n\t\t\t\ttype: 'file',\n\t\t\t\targs: {\n\t\t\t\t\tfile\n\t\t\t\t}\n\t\t\t},\n\t\t\tskipDestructiveCodeActions: sortOnly,\n\t\t};\n\t\tconst response = await this.client.interruptGetErr(() => this.client.execute('organizeImports', args, nulToken));\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (response.body.length) {\n\t\t\tconst edits = typeConverters.WorkspaceEdit.fromFileCodeEdits(this.client, response.body);\n\t\t\treturn vscode.workspace.applyEdit(edits);\n\t\t}\n\t}\n}\n\nclass ImportsCodeActionProvider implements vscode.CodeActionProvider {\n\n\tstatic register(\n\t\tclient: ITypeScriptServiceClient,\n\t\tminVersion: API,\n\t\tkind: vscode.CodeActionKind,\n\t\ttitle: string,\n\t\tsortOnly: boolean,\n\t\tcommandManager: CommandManager,\n\t\tfileConfigurationManager: FileConfigurationManager,\n\t\ttelemetryReporter: TelemetryReporter,\n\t\tselector: DocumentSelector\n\t): vscode.Disposable {\n\t\treturn conditionalRegistration([\n\t\t\trequireMinVersion(client, minVersion),\n\t\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t\t], () => {\n\t\t\tconst provider = new ImportsCodeActionProvider(client, kind, title, sortOnly, commandManager, fileConfigurationManager, telemetryReporter);\n\t\t\treturn vscode.languages.registerCodeActionsProvider(selector.semantic, provider, {\n\t\t\t\tprovidedCodeActionKinds: [kind]\n\t\t\t});\n\t\t});\n\t}\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly kind: vscode.CodeActionKind,\n\t\tprivate readonly title: string,\n\t\tprivate readonly sortOnly: boolean,\n\t\tcommandManager: CommandManager,\n\t\tprivate readonly fileConfigManager: FileConfigurationManager,\n\t\ttelemetryReporter: TelemetryReporter,\n\t) {\n\t\tcommandManager.register(new OrganizeImportsCommand(client, telemetryReporter));\n\t}\n\n\tpublic provideCodeActions(\n\t\tdocument: vscode.TextDocument,\n\t\t_range: vscode.Range,\n\t\tcontext: vscode.CodeActionContext,\n\t\ttoken: vscode.CancellationToken\n\t): vscode.CodeAction[] {\n\t\tconst file = this.client.toOpenedFilePath(document);\n\t\tif (!file) {\n\t\t\treturn [];\n\t\t}\n\n\t\tif (!context.only || !context.only.contains(this.kind)) {\n\t\t\treturn [];\n\t\t}\n\n\t\tthis.fileConfigManager.ensureConfigurationForDocument(document, token);\n\n\t\tconst action = new vscode.CodeAction(this.title, this.kind);\n\t\taction.command = { title: '', command: OrganizeImportsCommand.Id, arguments: [file, this.sortOnly] };\n\t\treturn [action];\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n\tcommandManager: CommandManager,\n\tfileConfigurationManager: FileConfigurationManager,\n\ttelemetryReporter: TelemetryReporter,\n) {\n\treturn vscode.Disposable.from(\n\t\tImportsCodeActionProvider.register(\n\t\t\tclient,\n\t\t\tAPI.v280,\n\t\t\tvscode.CodeActionKind.SourceOrganizeImports,\n\t\t\tlocalize('organizeImportsAction.title', \"Organize Imports\"),\n\t\t\tfalse,\n\t\t\tcommandManager,\n\t\t\tfileConfigurationManager,\n\t\t\ttelemetryReporter,\n\t\t\tselector\n\t\t),\n\t\tImportsCodeActionProvider.register(\n\t\t\tclient,\n\t\t\tAPI.v430,\n\t\t\tvscode.CodeActionKind.Source.append('sortImports'),\n\t\t\tlocalize('sortImportsAction.title', \"Sort Imports\"),\n\t\t\ttrue,\n\t\t\tcommandManager,\n\t\t\tfileConfigurationManager,\n\t\t\ttelemetryReporter,\n\t\t\tselector\n\t\t),\n\t);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as nls from 'vscode-nls';\nimport { Command, CommandManager } from '../commands/commandManager';\nimport type * as Proto from '../protocol';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport API from '../utils/api';\nimport { nulToken } from '../utils/cancellation';\nimport { applyCodeActionCommands, getEditForCodeAction } from '../utils/codeAction';\nimport { conditionalRegistration, requireSomeCapability } from '../utils/dependentRegistration';\nimport { DocumentSelector } from '../utils/documentSelector';\nimport * as fixNames from '../utils/fixNames';\nimport { memoize } from '../utils/memoize';\nimport { equals } from '../utils/objects';\nimport { TelemetryReporter } from '../utils/telemetry';\nimport * as typeConverters from '../utils/typeConverters';\nimport { DiagnosticsManager } from './diagnostics';\nimport FileConfigurationManager from './fileConfigurationManager';\n\nconst localize = nls.loadMessageBundle();\n\nclass ApplyCodeActionCommand implements Command {\n\tpublic static readonly ID = '_typescript.applyCodeActionCommand';\n\tpublic readonly id = ApplyCodeActionCommand.ID;\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly telemetryReporter: TelemetryReporter,\n\t) { }\n\n\tpublic async execute(\n\t\taction: Proto.CodeFixAction\n\t): Promise<boolean> {\n\t\t/* __GDPR__\n\t\t\t\"quickFix.execute\" : {\n\t\t\t\t\"fixName\" : { \"classification\": \"PublicNonPersonalData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t]\n\t\t\t}\n\t\t*/\n\t\tthis.telemetryReporter.logTelemetry('quickFix.execute', {\n\t\t\tfixName: action.fixName\n\t\t});\n\n\t\treturn applyCodeActionCommands(this.client, action.commands, nulToken);\n\t}\n}\n\ntype ApplyFixAllCodeAction_args = {\n\treadonly action: VsCodeFixAllCodeAction;\n};\n\nclass ApplyFixAllCodeAction implements Command {\n\tpublic static readonly ID = '_typescript.applyFixAllCodeAction';\n\tpublic readonly id = ApplyFixAllCodeAction.ID;\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly telemetryReporter: TelemetryReporter,\n\t) { }\n\n\tpublic async execute(args: ApplyFixAllCodeAction_args): Promise<void> {\n\t\t/* __GDPR__\n\t\t\t\"quickFixAll.execute\" : {\n\t\t\t\t\"fixName\" : { \"classification\": \"PublicNonPersonalData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t]\n\t\t\t}\n\t\t*/\n\t\tthis.telemetryReporter.logTelemetry('quickFixAll.execute', {\n\t\t\tfixName: args.action.tsAction.fixName\n\t\t});\n\n\t\tif (args.action.combinedResponse) {\n\t\t\tawait applyCodeActionCommands(this.client, args.action.combinedResponse.body.commands, nulToken);\n\t\t}\n\t}\n}\n\n/**\n * Unique set of diagnostics keyed on diagnostic range and error code.\n */\nclass DiagnosticsSet {\n\tpublic static from(diagnostics: vscode.Diagnostic[]) {\n\t\tconst values = new Map<string, vscode.Diagnostic>();\n\t\tfor (const diagnostic of diagnostics) {\n\t\t\tvalues.set(DiagnosticsSet.key(diagnostic), diagnostic);\n\t\t}\n\t\treturn new DiagnosticsSet(values);\n\t}\n\n\tprivate static key(diagnostic: vscode.Diagnostic) {\n\t\tconst { start, end } = diagnostic.range;\n\t\treturn `${diagnostic.code}-${start.line},${start.character}-${end.line},${end.character}`;\n\t}\n\n\tprivate constructor(\n\t\tprivate readonly _values: Map<string, vscode.Diagnostic>\n\t) { }\n\n\tpublic get values(): Iterable<vscode.Diagnostic> {\n\t\treturn this._values.values();\n\t}\n\n\tpublic get size() {\n\t\treturn this._values.size;\n\t}\n}\n\nclass VsCodeCodeAction extends vscode.CodeAction {\n\tconstructor(\n\t\tpublic readonly tsAction: Proto.CodeFixAction,\n\t\ttitle: string,\n\t\tkind: vscode.CodeActionKind\n\t) {\n\t\tsuper(title, kind);\n\t}\n}\n\nclass VsCodeFixAllCodeAction extends VsCodeCodeAction {\n\tconstructor(\n\t\ttsAction: Proto.CodeFixAction,\n\t\tpublic readonly file: string,\n\t\ttitle: string,\n\t\tkind: vscode.CodeActionKind\n\t) {\n\t\tsuper(tsAction, title, kind);\n\t}\n\n\tpublic combinedResponse?: Proto.GetCombinedCodeFixResponse;\n}\n\nclass CodeActionSet {\n\tprivate readonly _actions = new Set<VsCodeCodeAction>();\n\tprivate readonly _fixAllActions = new Map<{}, VsCodeCodeAction>();\n\n\tpublic get values(): Iterable<VsCodeCodeAction> {\n\t\treturn this._actions;\n\t}\n\n\tpublic addAction(action: VsCodeCodeAction) {\n\t\tfor (const existing of this._actions) {\n\t\t\tif (action.tsAction.fixName === existing.tsAction.fixName && equals(action.edit, existing.edit)) {\n\t\t\t\tthis._actions.delete(existing);\n\t\t\t}\n\t\t}\n\n\t\tthis._actions.add(action);\n\n\t\tif (action.tsAction.fixId) {\n\t\t\t// If we have an existing fix all action, then make sure it follows this action\n\t\t\tconst existingFixAll = this._fixAllActions.get(action.tsAction.fixId);\n\t\t\tif (existingFixAll) {\n\t\t\t\tthis._actions.delete(existingFixAll);\n\t\t\t\tthis._actions.add(existingFixAll);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic addFixAllAction(fixId: {}, action: VsCodeCodeAction) {\n\t\tconst existing = this._fixAllActions.get(fixId);\n\t\tif (existing) {\n\t\t\t// reinsert action at back of actions list\n\t\t\tthis._actions.delete(existing);\n\t\t}\n\t\tthis.addAction(action);\n\t\tthis._fixAllActions.set(fixId, action);\n\t}\n\n\tpublic hasFixAllAction(fixId: {}) {\n\t\treturn this._fixAllActions.has(fixId);\n\t}\n}\n\nclass SupportedCodeActionProvider {\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient\n\t) { }\n\n\tpublic async getFixableDiagnosticsForContext(context: vscode.CodeActionContext): Promise<DiagnosticsSet> {\n\t\tconst fixableCodes = await this.fixableDiagnosticCodes;\n\t\treturn DiagnosticsSet.from(\n\t\t\tcontext.diagnostics.filter(diagnostic => typeof diagnostic.code !== 'undefined' && fixableCodes.has(diagnostic.code + '')));\n\t}\n\n\t@memoize\n\tprivate get fixableDiagnosticCodes(): Thenable<Set<string>> {\n\t\treturn this.client.execute('getSupportedCodeFixes', null, nulToken)\n\t\t\t.then(response => response.type === 'response' ? response.body || [] : [])\n\t\t\t.then(codes => new Set(codes));\n\t}\n}\n\nclass TypeScriptQuickFixProvider implements vscode.CodeActionProvider<VsCodeCodeAction> {\n\n\tpublic static readonly metadata: vscode.CodeActionProviderMetadata = {\n\t\tprovidedCodeActionKinds: [vscode.CodeActionKind.QuickFix]\n\t};\n\n\tprivate readonly supportedCodeActionProvider: SupportedCodeActionProvider;\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly formattingConfigurationManager: FileConfigurationManager,\n\t\tcommandManager: CommandManager,\n\t\tprivate readonly diagnosticsManager: DiagnosticsManager,\n\t\ttelemetryReporter: TelemetryReporter\n\t) {\n\t\tcommandManager.register(new ApplyCodeActionCommand(client, telemetryReporter));\n\t\tcommandManager.register(new ApplyFixAllCodeAction(client, telemetryReporter));\n\n\t\tthis.supportedCodeActionProvider = new SupportedCodeActionProvider(client);\n\t}\n\n\tpublic async provideCodeActions(\n\t\tdocument: vscode.TextDocument,\n\t\t_range: vscode.Range,\n\t\tcontext: vscode.CodeActionContext,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<VsCodeCodeAction[]> {\n\t\tconst file = this.client.toOpenedFilePath(document);\n\t\tif (!file) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst fixableDiagnostics = await this.supportedCodeActionProvider.getFixableDiagnosticsForContext(context);\n\t\tif (!fixableDiagnostics.size) {\n\t\t\treturn [];\n\t\t}\n\n\t\tif (this.client.bufferSyncSupport.hasPendingDiagnostics(document.uri)) {\n\t\t\treturn [];\n\t\t}\n\n\t\tawait this.formattingConfigurationManager.ensureConfigurationForDocument(document, token);\n\n\t\tconst results = new CodeActionSet();\n\t\tfor (const diagnostic of fixableDiagnostics.values) {\n\t\t\tawait this.getFixesForDiagnostic(document, file, diagnostic, results, token);\n\t\t}\n\n\t\tconst allActions = Array.from(results.values);\n\t\tfor (const action of allActions) {\n\t\t\taction.isPreferred = isPreferredFix(action, allActions);\n\t\t}\n\t\treturn allActions;\n\t}\n\n\tpublic async resolveCodeAction(codeAction: VsCodeCodeAction, token: vscode.CancellationToken): Promise<VsCodeCodeAction> {\n\t\tif (!(codeAction instanceof VsCodeFixAllCodeAction) || !codeAction.tsAction.fixId) {\n\t\t\treturn codeAction;\n\t\t}\n\n\t\tconst arg: Proto.GetCombinedCodeFixRequestArgs = {\n\t\t\tscope: {\n\t\t\t\ttype: 'file',\n\t\t\t\targs: { file: codeAction.file }\n\t\t\t},\n\t\t\tfixId: codeAction.tsAction.fixId,\n\t\t};\n\n\t\tconst response = await this.client.execute('getCombinedCodeFix', arg, token);\n\t\tif (response.type === 'response') {\n\t\t\tcodeAction.combinedResponse = response;\n\t\t\tcodeAction.edit = typeConverters.WorkspaceEdit.fromFileCodeEdits(this.client, response.body.changes);\n\t\t}\n\n\t\treturn codeAction;\n\t}\n\n\tprivate async getFixesForDiagnostic(\n\t\tdocument: vscode.TextDocument,\n\t\tfile: string,\n\t\tdiagnostic: vscode.Diagnostic,\n\t\tresults: CodeActionSet,\n\t\ttoken: vscode.CancellationToken,\n\t): Promise<CodeActionSet> {\n\t\tconst args: Proto.CodeFixRequestArgs = {\n\t\t\t...typeConverters.Range.toFileRangeRequestArgs(file, diagnostic.range),\n\t\t\terrorCodes: [+(diagnostic.code!)]\n\t\t};\n\t\tconst response = await this.client.execute('getCodeFixes', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn results;\n\t\t}\n\n\t\tfor (const tsCodeFix of response.body) {\n\t\t\tthis.addAllFixesForTsCodeAction(results, document, file, diagnostic, tsCodeFix as Proto.CodeFixAction);\n\t\t}\n\t\treturn results;\n\t}\n\n\tprivate addAllFixesForTsCodeAction(\n\t\tresults: CodeActionSet,\n\t\tdocument: vscode.TextDocument,\n\t\tfile: string,\n\t\tdiagnostic: vscode.Diagnostic,\n\t\ttsAction: Proto.CodeFixAction\n\t): CodeActionSet {\n\t\tresults.addAction(this.getSingleFixForTsCodeAction(diagnostic, tsAction));\n\t\tthis.addFixAllForTsCodeAction(results, document, file, diagnostic, tsAction as Proto.CodeFixAction);\n\t\treturn results;\n\t}\n\n\tprivate getSingleFixForTsCodeAction(\n\t\tdiagnostic: vscode.Diagnostic,\n\t\ttsAction: Proto.CodeFixAction\n\t): VsCodeCodeAction {\n\t\tconst codeAction = new VsCodeCodeAction(tsAction, tsAction.description, vscode.CodeActionKind.QuickFix);\n\t\tcodeAction.edit = getEditForCodeAction(this.client, tsAction);\n\t\tcodeAction.diagnostics = [diagnostic];\n\t\tcodeAction.command = {\n\t\t\tcommand: ApplyCodeActionCommand.ID,\n\t\t\targuments: [tsAction],\n\t\t\ttitle: ''\n\t\t};\n\t\treturn codeAction;\n\t}\n\n\tprivate addFixAllForTsCodeAction(\n\t\tresults: CodeActionSet,\n\t\tdocument: vscode.TextDocument,\n\t\tfile: string,\n\t\tdiagnostic: vscode.Diagnostic,\n\t\ttsAction: Proto.CodeFixAction,\n\t): CodeActionSet {\n\t\tif (!tsAction.fixId || this.client.apiVersion.lt(API.v270) || results.hasFixAllAction(tsAction.fixId)) {\n\t\t\treturn results;\n\t\t}\n\n\t\t// Make sure there are multiple diagnostics of the same type in the file\n\t\tif (!this.diagnosticsManager.getDiagnostics(document.uri).some(x => {\n\t\t\tif (x === diagnostic) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn x.code === diagnostic.code\n\t\t\t\t|| (fixAllErrorCodes.has(x.code as number) && fixAllErrorCodes.get(x.code as number) === fixAllErrorCodes.get(diagnostic.code as number));\n\t\t})) {\n\t\t\treturn results;\n\t\t}\n\n\t\tconst action = new VsCodeFixAllCodeAction(\n\t\t\ttsAction,\n\t\t\tfile,\n\t\t\ttsAction.fixAllDescription || localize('fixAllInFileLabel', '{0} (Fix all in file)', tsAction.description),\n\t\t\tvscode.CodeActionKind.QuickFix);\n\n\t\taction.diagnostics = [diagnostic];\n\t\taction.command = {\n\t\t\tcommand: ApplyFixAllCodeAction.ID,\n\t\t\targuments: [<ApplyFixAllCodeAction_args>{ action }],\n\t\t\ttitle: ''\n\t\t};\n\t\tresults.addFixAllAction(tsAction.fixId, action);\n\t\treturn results;\n\t}\n}\n\n// Some fix all actions can actually fix multiple differnt diagnostics. Make sure we still show the fix all action\n// in such cases\nconst fixAllErrorCodes = new Map<number, number>([\n\t// Missing async\n\t[2339, 2339],\n\t[2345, 2339],\n]);\n\nconst preferredFixes = new Map<string, { readonly priority: number, readonly thereCanOnlyBeOne?: boolean }>([\n\t[fixNames.annotateWithTypeFromJSDoc, { priority: 2 }],\n\t[fixNames.constructorForDerivedNeedSuperCall, { priority: 2 }],\n\t[fixNames.extendsInterfaceBecomesImplements, { priority: 2 }],\n\t[fixNames.awaitInSyncFunction, { priority: 2 }],\n\t[fixNames.classIncorrectlyImplementsInterface, { priority: 3 }],\n\t[fixNames.classDoesntImplementInheritedAbstractMember, { priority: 3 }],\n\t[fixNames.unreachableCode, { priority: 2 }],\n\t[fixNames.unusedIdentifier, { priority: 2 }],\n\t[fixNames.forgottenThisPropertyAccess, { priority: 2 }],\n\t[fixNames.spelling, { priority: 0 }],\n\t[fixNames.addMissingAwait, { priority: 2 }],\n\t[fixNames.addMissingOverride, { priority: 2 }],\n\t[fixNames.fixImport, { priority: 1, thereCanOnlyBeOne: true }],\n]);\n\nfunction isPreferredFix(\n\taction: VsCodeCodeAction,\n\tallActions: readonly VsCodeCodeAction[]\n): boolean {\n\tif (action instanceof VsCodeFixAllCodeAction) {\n\t\treturn false;\n\t}\n\n\tconst fixPriority = preferredFixes.get(action.tsAction.fixName);\n\tif (!fixPriority) {\n\t\treturn false;\n\t}\n\n\treturn allActions.every(otherAction => {\n\t\tif (otherAction === action) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (otherAction instanceof VsCodeFixAllCodeAction) {\n\t\t\treturn true;\n\t\t}\n\n\t\tconst otherFixPriority = preferredFixes.get(otherAction.tsAction.fixName);\n\t\tif (!otherFixPriority || otherFixPriority.priority < fixPriority.priority) {\n\t\t\treturn true;\n\t\t} else if (otherFixPriority.priority > fixPriority.priority) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (fixPriority.thereCanOnlyBeOne && action.tsAction.fixName === otherAction.tsAction.fixName) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t});\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n\tfileConfigurationManager: FileConfigurationManager,\n\tcommandManager: CommandManager,\n\tdiagnosticsManager: DiagnosticsManager,\n\ttelemetryReporter: TelemetryReporter\n) {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerCodeActionsProvider(selector.semantic,\n\t\t\tnew TypeScriptQuickFixProvider(client, fileConfigurationManager, commandManager, diagnosticsManager, telemetryReporter),\n\t\t\tTypeScriptQuickFixProvider.metadata);\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport function memoize(_target: any, key: string, descriptor: any) {\n\tlet fnKey: string | undefined;\n\tlet fn: Function | undefined;\n\n\tif (typeof descriptor.value === 'function') {\n\t\tfnKey = 'value';\n\t\tfn = descriptor.value;\n\t} else if (typeof descriptor.get === 'function') {\n\t\tfnKey = 'get';\n\t\tfn = descriptor.get;\n\t} else {\n\t\tthrow new Error('not supported');\n\t}\n\n\tconst memoizeKey = `$memoize$${key}`;\n\n\tdescriptor[fnKey] = function (...args: any[]) {\n\t\tif (!this.hasOwnProperty(memoizeKey)) {\n\t\t\tObject.defineProperty(this, memoizeKey, {\n\t\t\t\tconfigurable: false,\n\t\t\t\tenumerable: false,\n\t\t\t\twritable: false,\n\t\t\t\tvalue: fn!.apply(this, args)\n\t\t\t});\n\t\t}\n\n\t\treturn this[memoizeKey];\n\t};\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as nls from 'vscode-nls';\nimport { Command, CommandManager } from '../commands/commandManager';\nimport { LearnMoreAboutRefactoringsCommand } from '../commands/learnMoreAboutRefactorings';\nimport type * as Proto from '../protocol';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport API from '../utils/api';\nimport { nulToken } from '../utils/cancellation';\nimport { conditionalRegistration, requireMinVersion, requireSomeCapability } from '../utils/dependentRegistration';\nimport { DocumentSelector } from '../utils/documentSelector';\nimport * as fileSchemes from '../utils/fileSchemes';\nimport { TelemetryReporter } from '../utils/telemetry';\nimport * as typeConverters from '../utils/typeConverters';\nimport FormattingOptionsManager from './fileConfigurationManager';\n\nconst localize = nls.loadMessageBundle();\n\n\ninterface DidApplyRefactoringCommand_Args {\n\treadonly codeAction: InlinedCodeAction\n}\n\nclass DidApplyRefactoringCommand implements Command {\n\tpublic static readonly ID = '_typescript.didApplyRefactoring';\n\tpublic readonly id = DidApplyRefactoringCommand.ID;\n\n\tconstructor(\n\t\tprivate readonly telemetryReporter: TelemetryReporter\n\t) { }\n\n\tpublic async execute(args: DidApplyRefactoringCommand_Args): Promise<void> {\n\t\t/* __GDPR__\n\t\t\t\"refactor.execute\" : {\n\t\t\t\t\"action\" : { \"classification\": \"PublicNonPersonalData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t]\n\t\t\t}\n\t\t*/\n\t\tthis.telemetryReporter.logTelemetry('refactor.execute', {\n\t\t\taction: args.codeAction.action,\n\t\t});\n\n\t\tif (!args.codeAction.edit?.size) {\n\t\t\tvscode.window.showErrorMessage(localize('refactoringFailed', \"Could not apply refactoring\"));\n\t\t\treturn;\n\t\t}\n\n\t\tconst renameLocation = args.codeAction.renameLocation;\n\t\tif (renameLocation) {\n\t\t\t// Disable renames in interactive playground https://github.com/microsoft/vscode/issues/75137\n\t\t\tif (args.codeAction.document.uri.scheme !== fileSchemes.walkThroughSnippet) {\n\t\t\t\tawait vscode.commands.executeCommand('editor.action.rename', [\n\t\t\t\t\targs.codeAction.document.uri,\n\t\t\t\t\ttypeConverters.Position.fromLocation(renameLocation)\n\t\t\t\t]);\n\t\t\t}\n\t\t}\n\t}\n}\n\ninterface SelectRefactorCommand_Args {\n\treadonly action: vscode.CodeAction;\n\treadonly document: vscode.TextDocument;\n\treadonly info: Proto.ApplicableRefactorInfo;\n\treadonly rangeOrSelection: vscode.Range | vscode.Selection;\n}\n\nclass SelectRefactorCommand implements Command {\n\tpublic static readonly ID = '_typescript.selectRefactoring';\n\tpublic readonly id = SelectRefactorCommand.ID;\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly didApplyCommand: DidApplyRefactoringCommand\n\t) { }\n\n\tpublic async execute(args: SelectRefactorCommand_Args): Promise<void> {\n\t\tconst file = this.client.toOpenedFilePath(args.document);\n\t\tif (!file) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst selected = await vscode.window.showQuickPick(args.info.actions.map((action): vscode.QuickPickItem => ({\n\t\t\tlabel: action.name,\n\t\t\tdescription: action.description,\n\t\t})));\n\t\tif (!selected) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst tsAction = new InlinedCodeAction(this.client, args.action.title, args.action.kind, args.document, args.info.name, selected.label, args.rangeOrSelection);\n\t\tawait tsAction.resolve(nulToken);\n\n\t\tif (tsAction.edit) {\n\t\t\tif (!(await vscode.workspace.applyEdit(tsAction.edit))) {\n\t\t\t\tvscode.window.showErrorMessage(localize('refactoringFailed', \"Could not apply refactoring\"));\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tawait this.didApplyCommand.execute({ codeAction: tsAction });\n\t}\n}\n\ninterface CodeActionKind {\n\treadonly kind: vscode.CodeActionKind;\n\tmatches(refactor: Proto.RefactorActionInfo): boolean;\n}\n\nconst Extract_Function = Object.freeze<CodeActionKind>({\n\tkind: vscode.CodeActionKind.RefactorExtract.append('function'),\n\tmatches: refactor => refactor.name.startsWith('function_')\n});\n\nconst Extract_Constant = Object.freeze<CodeActionKind>({\n\tkind: vscode.CodeActionKind.RefactorExtract.append('constant'),\n\tmatches: refactor => refactor.name.startsWith('constant_')\n});\n\nconst Extract_Type = Object.freeze<CodeActionKind>({\n\tkind: vscode.CodeActionKind.RefactorExtract.append('type'),\n\tmatches: refactor => refactor.name.startsWith('Extract to type alias')\n});\n\nconst Extract_Interface = Object.freeze<CodeActionKind>({\n\tkind: vscode.CodeActionKind.RefactorExtract.append('interface'),\n\tmatches: refactor => refactor.name.startsWith('Extract to interface')\n});\n\nconst Move_NewFile = Object.freeze<CodeActionKind>({\n\tkind: vscode.CodeActionKind.Refactor.append('move').append('newFile'),\n\tmatches: refactor => refactor.name.startsWith('Move to a new file')\n});\n\nconst Rewrite_Import = Object.freeze<CodeActionKind>({\n\tkind: vscode.CodeActionKind.RefactorRewrite.append('import'),\n\tmatches: refactor => refactor.name.startsWith('Convert namespace import') || refactor.name.startsWith('Convert named imports')\n});\n\nconst Rewrite_Export = Object.freeze<CodeActionKind>({\n\tkind: vscode.CodeActionKind.RefactorRewrite.append('export'),\n\tmatches: refactor => refactor.name.startsWith('Convert default export') || refactor.name.startsWith('Convert named export')\n});\n\nconst Rewrite_Arrow_Braces = Object.freeze<CodeActionKind>({\n\tkind: vscode.CodeActionKind.RefactorRewrite.append('arrow').append('braces'),\n\tmatches: refactor => refactor.name.startsWith('Convert default export') || refactor.name.startsWith('Convert named export')\n});\n\nconst Rewrite_Parameters_ToDestructured = Object.freeze<CodeActionKind>({\n\tkind: vscode.CodeActionKind.RefactorRewrite.append('parameters').append('toDestructured'),\n\tmatches: refactor => refactor.name.startsWith('Convert parameters to destructured object')\n});\n\nconst Rewrite_Property_GenerateAccessors = Object.freeze<CodeActionKind>({\n\tkind: vscode.CodeActionKind.RefactorRewrite.append('property').append('generateAccessors'),\n\tmatches: refactor => refactor.name.startsWith('Generate \\'get\\' and \\'set\\' accessors')\n});\n\nconst allKnownCodeActionKinds = [\n\tExtract_Function,\n\tExtract_Constant,\n\tExtract_Type,\n\tExtract_Interface,\n\tMove_NewFile,\n\tRewrite_Import,\n\tRewrite_Export,\n\tRewrite_Arrow_Braces,\n\tRewrite_Parameters_ToDestructured,\n\tRewrite_Property_GenerateAccessors\n];\n\nclass InlinedCodeAction extends vscode.CodeAction {\n\tconstructor(\n\t\tpublic readonly client: ITypeScriptServiceClient,\n\t\ttitle: string,\n\t\tkind: vscode.CodeActionKind | undefined,\n\t\tpublic readonly document: vscode.TextDocument,\n\t\tpublic readonly refactor: string,\n\t\tpublic readonly action: string,\n\t\tpublic readonly range: vscode.Range,\n\t) {\n\t\tsuper(title, kind);\n\t}\n\n\t// Filled in during resolve\n\tpublic renameLocation?: Proto.Location;\n\n\tpublic async resolve(token: vscode.CancellationToken): Promise<undefined> {\n\t\tconst file = this.client.toOpenedFilePath(this.document);\n\t\tif (!file) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst args: Proto.GetEditsForRefactorRequestArgs = {\n\t\t\t...typeConverters.Range.toFileRangeRequestArgs(file, this.range),\n\t\t\trefactor: this.refactor,\n\t\t\taction: this.action,\n\t\t};\n\n\t\tconst response = await this.client.execute('getEditsForRefactor', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Resolve\n\t\tthis.edit = InlinedCodeAction.getWorkspaceEditForRefactoring(this.client, response.body);\n\t\tthis.renameLocation = response.body.renameLocation;\n\n\t\treturn;\n\t}\n\n\tprivate static getWorkspaceEditForRefactoring(\n\t\tclient: ITypeScriptServiceClient,\n\t\tbody: Proto.RefactorEditInfo,\n\t): vscode.WorkspaceEdit {\n\t\tconst workspaceEdit = new vscode.WorkspaceEdit();\n\t\tfor (const edit of body.edits) {\n\t\t\tconst resource = client.toResource(edit.fileName);\n\t\t\tif (resource.scheme === fileSchemes.file) {\n\t\t\t\tworkspaceEdit.createFile(resource, { ignoreIfExists: true });\n\t\t\t}\n\t\t}\n\t\ttypeConverters.WorkspaceEdit.withFileCodeEdits(workspaceEdit, client, body.edits);\n\t\treturn workspaceEdit;\n\t}\n}\n\nclass SelectCodeAction extends vscode.CodeAction {\n\tconstructor(\n\t\tinfo: Proto.ApplicableRefactorInfo,\n\t\tdocument: vscode.TextDocument,\n\t\trangeOrSelection: vscode.Range | vscode.Selection\n\t) {\n\t\tsuper(info.description, vscode.CodeActionKind.Refactor);\n\t\tthis.command = {\n\t\t\ttitle: info.description,\n\t\t\tcommand: SelectRefactorCommand.ID,\n\t\t\targuments: [<SelectRefactorCommand_Args>{ action: this, document, info, rangeOrSelection }]\n\t\t};\n\t}\n}\n\ntype TsCodeAction = InlinedCodeAction | SelectCodeAction;\n\nclass TypeScriptRefactorProvider implements vscode.CodeActionProvider<TsCodeAction> {\n\tpublic static readonly minVersion = API.v240;\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly formattingOptionsManager: FormattingOptionsManager,\n\t\tcommandManager: CommandManager,\n\t\ttelemetryReporter: TelemetryReporter\n\t) {\n\t\tconst didApplyRefactoringCommand = commandManager.register(new DidApplyRefactoringCommand(telemetryReporter));\n\t\tcommandManager.register(new SelectRefactorCommand(this.client, didApplyRefactoringCommand));\n\t}\n\n\tpublic static readonly metadata: vscode.CodeActionProviderMetadata = {\n\t\tprovidedCodeActionKinds: [\n\t\t\tvscode.CodeActionKind.Refactor,\n\t\t\t...allKnownCodeActionKinds.map(x => x.kind),\n\t\t],\n\t\tdocumentation: [\n\t\t\t{\n\t\t\t\tkind: vscode.CodeActionKind.Refactor,\n\t\t\t\tcommand: {\n\t\t\t\t\tcommand: LearnMoreAboutRefactoringsCommand.id,\n\t\t\t\t\ttitle: localize('refactor.documentation.title', \"Learn more about JS/TS refactorings\")\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t};\n\n\tpublic async provideCodeActions(\n\t\tdocument: vscode.TextDocument,\n\t\trangeOrSelection: vscode.Range | vscode.Selection,\n\t\tcontext: vscode.CodeActionContext,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<TsCodeAction[] | undefined> {\n\t\tif (!this.shouldTrigger(context, rangeOrSelection)) {\n\t\t\treturn undefined;\n\t\t}\n\t\tif (!this.client.toOpenedFilePath(document)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst response = await this.client.interruptGetErr(() => {\n\t\t\tconst file = this.client.toOpenedFilePath(document);\n\t\t\tif (!file) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tthis.formattingOptionsManager.ensureConfigurationForDocument(document, token);\n\n\t\t\tconst args: Proto.GetApplicableRefactorsRequestArgs & { kind?: string } = {\n\t\t\t\t...typeConverters.Range.toFileRangeRequestArgs(file, rangeOrSelection),\n\t\t\t\ttriggerReason: this.toTsTriggerReason(context),\n\t\t\t\tkind: context.only?.value\n\t\t\t};\n\t\t\treturn this.client.execute('getApplicableRefactors', args, token);\n\t\t});\n\t\tif (response?.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst actions = this.convertApplicableRefactors(response.body, document, rangeOrSelection).filter(action => {\n\t\t\tif (this.client.apiVersion.lt(API.v430)) {\n\t\t\t\t// Don't show 'infer return type' refactoring unless it has been explicitly requested\n\t\t\t\t// https://github.com/microsoft/TypeScript/issues/42993\n\t\t\t\tif (!context.only && action.kind?.value === 'refactor.rewrite.function.returnType') {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tif (!context.only) {\n\t\t\treturn actions;\n\t\t}\n\t\treturn this.pruneInvalidActions(this.appendInvalidActions(actions), context.only, /* numberOfInvalid = */ 5);\n\t}\n\n\tpublic async resolveCodeAction(\n\t\tcodeAction: TsCodeAction,\n\t\ttoken: vscode.CancellationToken,\n\t): Promise<TsCodeAction> {\n\t\tif (codeAction instanceof InlinedCodeAction) {\n\t\t\tawait codeAction.resolve(token);\n\t\t}\n\t\treturn codeAction;\n\t}\n\n\tprivate toTsTriggerReason(context: vscode.CodeActionContext): Proto.RefactorTriggerReason | undefined {\n\t\tif (context.triggerKind === vscode.CodeActionTriggerKind.Invoke) {\n\t\t\treturn 'invoked';\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate convertApplicableRefactors(\n\t\tbody: Proto.ApplicableRefactorInfo[],\n\t\tdocument: vscode.TextDocument,\n\t\trangeOrSelection: vscode.Range | vscode.Selection\n\t): TsCodeAction[] {\n\t\tconst actions: TsCodeAction[] = [];\n\t\tfor (const info of body) {\n\t\t\tif (info.inlineable === false) {\n\t\t\t\tconst codeAction = new SelectCodeAction(info, document, rangeOrSelection);\n\t\t\t\tactions.push(codeAction);\n\t\t\t} else {\n\t\t\t\tfor (const action of info.actions) {\n\t\t\t\t\tactions.push(this.refactorActionToCodeAction(action, document, info, rangeOrSelection, info.actions));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn actions;\n\t}\n\n\tprivate refactorActionToCodeAction(\n\t\taction: Proto.RefactorActionInfo,\n\t\tdocument: vscode.TextDocument,\n\t\tinfo: Proto.ApplicableRefactorInfo,\n\t\trangeOrSelection: vscode.Range | vscode.Selection,\n\t\tallActions: readonly Proto.RefactorActionInfo[],\n\t): InlinedCodeAction {\n\t\tconst codeAction = new InlinedCodeAction(this.client, action.description, TypeScriptRefactorProvider.getKind(action), document, info.name, action.name, rangeOrSelection);\n\n\t\t// https://github.com/microsoft/TypeScript/pull/37871\n\t\tif (action.notApplicableReason) {\n\t\t\tcodeAction.disabled = { reason: action.notApplicableReason };\n\t\t} else {\n\t\t\tcodeAction.command = {\n\t\t\t\ttitle: action.description,\n\t\t\t\tcommand: DidApplyRefactoringCommand.ID,\n\t\t\t\targuments: [<DidApplyRefactoringCommand_Args>{ codeAction }],\n\t\t\t};\n\t\t}\n\n\t\tcodeAction.isPreferred = TypeScriptRefactorProvider.isPreferred(action, allActions);\n\t\treturn codeAction;\n\t}\n\n\tprivate shouldTrigger(context: vscode.CodeActionContext, rangeOrSelection: vscode.Range | vscode.Selection) {\n\t\tif (context.only && !vscode.CodeActionKind.Refactor.contains(context.only)) {\n\t\t\treturn false;\n\t\t}\n\t\tif (context.triggerKind === vscode.CodeActionTriggerKind.Invoke) {\n\t\t\treturn true;\n\t\t}\n\t\treturn rangeOrSelection instanceof vscode.Selection;\n\t}\n\n\tprivate static getKind(refactor: Proto.RefactorActionInfo) {\n\t\tif ((refactor as Proto.RefactorActionInfo & { kind?: string }).kind) {\n\t\t\treturn vscode.CodeActionKind.Empty.append((refactor as Proto.RefactorActionInfo & { kind?: string }).kind!);\n\t\t}\n\t\tconst match = allKnownCodeActionKinds.find(kind => kind.matches(refactor));\n\t\treturn match ? match.kind : vscode.CodeActionKind.Refactor;\n\t}\n\n\tprivate static isPreferred(\n\t\taction: Proto.RefactorActionInfo,\n\t\tallActions: readonly Proto.RefactorActionInfo[],\n\t): boolean {\n\t\tif (Extract_Constant.matches(action)) {\n\t\t\t// Only mark the action with the lowest scope as preferred\n\t\t\tconst getScope = (name: string) => {\n\t\t\t\tconst scope = name.match(/scope_(\\d)/)?.[1];\n\t\t\t\treturn scope ? +scope : undefined;\n\t\t\t};\n\t\t\tconst scope = getScope(action.name);\n\t\t\tif (typeof scope !== 'number') {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn allActions\n\t\t\t\t.filter(otherAtion => otherAtion !== action && Extract_Constant.matches(otherAtion))\n\t\t\t\t.every(otherAction => {\n\t\t\t\t\tconst otherScope = getScope(otherAction.name);\n\t\t\t\t\treturn typeof otherScope === 'number' ? scope < otherScope : true;\n\t\t\t\t});\n\t\t}\n\t\tif (Extract_Type.matches(action) || Extract_Interface.matches(action)) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate appendInvalidActions(actions: vscode.CodeAction[]): vscode.CodeAction[] {\n\t\tif (this.client.apiVersion.gte(API.v400)) {\n\t\t\t// Invalid actions come from TS server instead\n\t\t\treturn actions;\n\t\t}\n\n\t\tif (!actions.some(action => action.kind && Extract_Constant.kind.contains(action.kind))) {\n\t\t\tconst disabledAction = new vscode.CodeAction(\n\t\t\t\tlocalize('extractConstant.disabled.title', \"Extract to constant\"),\n\t\t\t\tExtract_Constant.kind);\n\n\t\t\tdisabledAction.disabled = {\n\t\t\t\treason: localize('extractConstant.disabled.reason', \"The current selection cannot be extracted\"),\n\t\t\t};\n\t\t\tdisabledAction.isPreferred = true;\n\n\t\t\tactions.push(disabledAction);\n\t\t}\n\n\t\tif (!actions.some(action => action.kind && Extract_Function.kind.contains(action.kind))) {\n\t\t\tconst disabledAction = new vscode.CodeAction(\n\t\t\t\tlocalize('extractFunction.disabled.title', \"Extract to function\"),\n\t\t\t\tExtract_Function.kind);\n\n\t\t\tdisabledAction.disabled = {\n\t\t\t\treason: localize('extractFunction.disabled.reason', \"The current selection cannot be extracted\"),\n\t\t\t};\n\t\t\tactions.push(disabledAction);\n\t\t}\n\t\treturn actions;\n\t}\n\n\tprivate pruneInvalidActions(actions: vscode.CodeAction[], only?: vscode.CodeActionKind, numberOfInvalid?: number): vscode.CodeAction[] {\n\t\tif (this.client.apiVersion.lt(API.v400)) {\n\t\t\t// Older TS version don't return extra actions\n\t\t\treturn actions;\n\t\t}\n\n\t\tconst availableActions: vscode.CodeAction[] = [];\n\t\tconst invalidCommonActions: vscode.CodeAction[] = [];\n\t\tconst invalidUncommonActions: vscode.CodeAction[] = [];\n\t\tfor (const action of actions) {\n\t\t\tif (!action.disabled) {\n\t\t\t\tavailableActions.push(action);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// These are the common refactors that we should always show if applicable.\n\t\t\tif (action.kind && (Extract_Constant.kind.contains(action.kind) || Extract_Function.kind.contains(action.kind))) {\n\t\t\t\tinvalidCommonActions.push(action);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// These are the remaining refactors that we can show if we haven't reached the max limit with just common refactors.\n\t\t\tinvalidUncommonActions.push(action);\n\t\t}\n\n\t\tconst prioritizedActions: vscode.CodeAction[] = [];\n\t\tprioritizedActions.push(...invalidCommonActions);\n\t\tprioritizedActions.push(...invalidUncommonActions);\n\t\tconst topNInvalid = prioritizedActions.filter(action => !only || (action.kind && only.contains(action.kind))).slice(0, numberOfInvalid);\n\t\tavailableActions.push(...topNInvalid);\n\t\treturn availableActions;\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n\tformattingOptionsManager: FormattingOptionsManager,\n\tcommandManager: CommandManager,\n\ttelemetryReporter: TelemetryReporter,\n) {\n\treturn conditionalRegistration([\n\t\trequireMinVersion(client, TypeScriptRefactorProvider.minVersion),\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerCodeActionsProvider(selector.semantic,\n\t\t\tnew TypeScriptRefactorProvider(client, formattingOptionsManager, commandManager, telemetryReporter),\n\t\t\tTypeScriptRefactorProvider.metadata);\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport { conditionalRegistration, requireSomeCapability } from '../utils/dependentRegistration';\nimport { DocumentSelector } from '../utils/documentSelector';\nimport * as typeConverters from '../utils/typeConverters';\n\nclass TypeScriptReferenceSupport implements vscode.ReferenceProvider {\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient) { }\n\n\tpublic async provideReferences(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\toptions: vscode.ReferenceContext,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.Location[]> {\n\t\tconst filepath = this.client.toOpenedFilePath(document);\n\t\tif (!filepath) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(filepath, position);\n\t\tconst response = await this.client.execute('references', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst result: vscode.Location[] = [];\n\t\tfor (const ref of response.body.refs) {\n\t\t\tif (!options.includeDeclaration && ref.isDefinition) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst url = this.client.toResource(ref.file);\n\t\t\tconst location = typeConverters.Location.fromTextSpan(url, ref);\n\t\t\tresult.push(location);\n\t\t}\n\t\treturn result;\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient\n) {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.EnhancedSyntax, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerReferenceProvider(selector.syntax,\n\t\t\tnew TypeScriptReferenceSupport(client));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as path from 'path';\nimport * as vscode from 'vscode';\nimport * as nls from 'vscode-nls';\nimport type * as Proto from '../protocol';\nimport { ClientCapability, ITypeScriptServiceClient, ServerResponse } from '../typescriptService';\nimport API from '../utils/api';\nimport { conditionalRegistration, requireSomeCapability } from '../utils/dependentRegistration';\nimport { DocumentSelector } from '../utils/documentSelector';\nimport * as typeConverters from '../utils/typeConverters';\nimport FileConfigurationManager from './fileConfigurationManager';\n\nconst localize = nls.loadMessageBundle();\n\nclass TypeScriptRenameProvider implements vscode.RenameProvider {\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly fileConfigurationManager: FileConfigurationManager\n\t) { }\n\n\tpublic async prepareRename(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.Range | null> {\n\t\tif (this.client.apiVersion.lt(API.v310)) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst response = await this.execRename(document, position, token);\n\t\tif (response?.type !== 'response' || !response.body) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst renameInfo = response.body.info;\n\t\tif (!renameInfo.canRename) {\n\t\t\treturn Promise.reject<vscode.Range>(renameInfo.localizedErrorMessage);\n\t\t}\n\n\t\treturn typeConverters.Range.fromTextSpan(renameInfo.triggerSpan);\n\t}\n\n\tpublic async provideRenameEdits(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\tnewName: string,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.WorkspaceEdit | null> {\n\t\tconst response = await this.execRename(document, position, token);\n\t\tif (!response || response.type !== 'response' || !response.body) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst renameInfo = response.body.info;\n\t\tif (!renameInfo.canRename) {\n\t\t\treturn Promise.reject<vscode.WorkspaceEdit>(renameInfo.localizedErrorMessage);\n\t\t}\n\n\t\tif (renameInfo.fileToRename) {\n\t\t\tconst edits = await this.renameFile(renameInfo.fileToRename, newName, token);\n\t\t\tif (edits) {\n\t\t\t\treturn edits;\n\t\t\t} else {\n\t\t\t\treturn Promise.reject<vscode.WorkspaceEdit>(localize('fileRenameFail', \"An error occurred while renaming file\"));\n\t\t\t}\n\t\t}\n\n\t\treturn this.updateLocs(response.body.locs, newName);\n\t}\n\n\tpublic async execRename(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<ServerResponse.Response<Proto.RenameResponse> | undefined> {\n\t\tconst file = this.client.toOpenedFilePath(document);\n\t\tif (!file) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst args: Proto.RenameRequestArgs = {\n\t\t\t...typeConverters.Position.toFileLocationRequestArgs(file, position),\n\t\t\tfindInStrings: false,\n\t\t\tfindInComments: false\n\t\t};\n\n\t\treturn this.client.interruptGetErr(() => {\n\t\t\tthis.fileConfigurationManager.ensureConfigurationForDocument(document, token);\n\t\t\treturn this.client.execute('rename', args, token);\n\t\t});\n\t}\n\n\tprivate updateLocs(\n\t\tlocations: ReadonlyArray<Proto.SpanGroup>,\n\t\tnewName: string\n\t) {\n\t\tconst edit = new vscode.WorkspaceEdit();\n\t\tfor (const spanGroup of locations) {\n\t\t\tconst resource = this.client.toResource(spanGroup.file);\n\t\t\tfor (const textSpan of spanGroup.locs) {\n\t\t\t\tedit.replace(resource, typeConverters.Range.fromTextSpan(textSpan),\n\t\t\t\t\t(textSpan.prefixText || '') + newName + (textSpan.suffixText || ''));\n\t\t\t}\n\t\t}\n\t\treturn edit;\n\t}\n\n\tprivate async renameFile(\n\t\tfileToRename: string,\n\t\tnewName: string,\n\t\ttoken: vscode.CancellationToken,\n\t): Promise<vscode.WorkspaceEdit | undefined> {\n\t\t// Make sure we preserve file extension if none provided\n\t\tif (!path.extname(newName)) {\n\t\t\tnewName += path.extname(fileToRename);\n\t\t}\n\n\t\tconst dirname = path.dirname(fileToRename);\n\t\tconst newFilePath = path.join(dirname, newName);\n\n\t\tconst args: Proto.GetEditsForFileRenameRequestArgs & { file: string } = {\n\t\t\tfile: fileToRename,\n\t\t\toldFilePath: fileToRename,\n\t\t\tnewFilePath: newFilePath,\n\t\t};\n\t\tconst response = await this.client.execute('getEditsForFileRename', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst edits = typeConverters.WorkspaceEdit.fromFileCodeEdits(this.client, response.body);\n\t\tedits.renameFile(vscode.Uri.file(fileToRename), vscode.Uri.file(newFilePath));\n\t\treturn edits;\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n\tfileConfigurationManager: FileConfigurationManager,\n) {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerRenameProvider(selector.semantic,\n\t\t\tnew TypeScriptRenameProvider(client, fileConfigurationManager));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n// all constants are const\nimport * as vscode from 'vscode';\nimport * as Proto from '../protocol';\nimport { ClientCapability, ExecConfig, ITypeScriptServiceClient, ServerResponse } from '../typescriptService';\nimport API from '../utils/api';\nimport { conditionalRegistration, requireMinVersion, requireSomeCapability } from '../utils/dependentRegistration';\nimport { DocumentSelector } from '../utils/documentSelector';\n\n\nconst minTypeScriptVersion = API.fromVersionString(`${VersionRequirement.major}.${VersionRequirement.minor}`);\n\n// as we don't do deltas, for performance reasons, don't compute semantic tokens for documents above that limit\nconst CONTENT_LENGTH_LIMIT = 100000;\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n) {\n\treturn conditionalRegistration([\n\t\trequireMinVersion(client, minTypeScriptVersion),\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\tconst provider = new DocumentSemanticTokensProvider(client);\n\t\treturn vscode.Disposable.from(\n\t\t\t// register only as a range provider\n\t\t\tvscode.languages.registerDocumentRangeSemanticTokensProvider(selector.semantic, provider, provider.getLegend()),\n\t\t);\n\t});\n}\n\n/**\n * Prototype of a DocumentSemanticTokensProvider, relying on the experimental `encodedSemanticClassifications-full` request from the TypeScript server.\n * As the results retured by the TypeScript server are limited, we also add a Typescript plugin (typescript-vscode-sh-plugin) to enrich the returned token.\n * See https://github.com/aeschli/typescript-vscode-sh-plugin.\n */\nclass DocumentSemanticTokensProvider implements vscode.DocumentSemanticTokensProvider, vscode.DocumentRangeSemanticTokensProvider {\n\n\tconstructor(private readonly client: ITypeScriptServiceClient) {\n\t}\n\n\tgetLegend(): vscode.SemanticTokensLegend {\n\t\treturn new vscode.SemanticTokensLegend(tokenTypes, tokenModifiers);\n\t}\n\n\tasync provideDocumentSemanticTokens(document: vscode.TextDocument, token: vscode.CancellationToken): Promise<vscode.SemanticTokens | null> {\n\t\tconst file = this.client.toOpenedFilePath(document);\n\t\tif (!file || document.getText().length > CONTENT_LENGTH_LIMIT) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this._provideSemanticTokens(document, { file, start: 0, length: document.getText().length }, token);\n\t}\n\n\tasync provideDocumentRangeSemanticTokens(document: vscode.TextDocument, range: vscode.Range, token: vscode.CancellationToken): Promise<vscode.SemanticTokens | null> {\n\t\tconst file = this.client.toOpenedFilePath(document);\n\t\tif (!file || (document.offsetAt(range.end) - document.offsetAt(range.start) > CONTENT_LENGTH_LIMIT)) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst start = document.offsetAt(range.start);\n\t\tconst length = document.offsetAt(range.end) - start;\n\t\treturn this._provideSemanticTokens(document, { file, start, length }, token);\n\t}\n\n\tasync _provideSemanticTokens(document: vscode.TextDocument, requestArg: Proto.EncodedSemanticClassificationsRequestArgs, token: vscode.CancellationToken): Promise<vscode.SemanticTokens | null> {\n\t\tconst file = this.client.toOpenedFilePath(document);\n\t\tif (!file) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst versionBeforeRequest = document.version;\n\n\t\trequestArg.format = '2020';\n\n\t\tconst response = await (this.client as ExperimentalProtocol.IExtendedTypeScriptServiceClient).execute('encodedSemanticClassifications-full', requestArg, token, {\n\t\t\tcancelOnResourceChange: document.uri\n\t\t});\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst versionAfterRequest = document.version;\n\n\t\tif (versionBeforeRequest !== versionAfterRequest) {\n\t\t\t// cannot convert result's offsets to (line;col) values correctly\n\t\t\t// a new request will come in soon...\n\t\t\t//\n\t\t\t// here we cannot return null, because returning null would remove all semantic tokens.\n\t\t\t// we must throw to indicate that the semantic tokens should not be removed.\n\t\t\t// using the string busy here because it is not logged to error telemetry if the error text contains busy.\n\n\t\t\t// as the new request will come in right after our response, we first wait for the document activity to stop\n\t\t\tawait waitForDocumentChangesToEnd(document);\n\n\t\t\tthrow new vscode.CancellationError();\n\t\t}\n\n\t\tconst tokenSpan = response.body.spans;\n\n\t\tconst builder = new vscode.SemanticTokensBuilder();\n\t\tlet i = 0;\n\t\twhile (i < tokenSpan.length) {\n\t\t\tconst offset = tokenSpan[i++];\n\t\t\tconst length = tokenSpan[i++];\n\t\t\tconst tsClassification = tokenSpan[i++];\n\n\t\t\tlet tokenModifiers = 0;\n\t\t\tlet tokenType = getTokenTypeFromClassification(tsClassification);\n\t\t\tif (tokenType !== undefined) {\n\t\t\t\t// it's a classification as returned by the typescript-vscode-sh-plugin\n\t\t\t\ttokenModifiers = getTokenModifierFromClassification(tsClassification);\n\t\t\t} else {\n\t\t\t\t// typescript-vscode-sh-plugin is not present\n\t\t\t\ttokenType = tokenTypeMap[tsClassification];\n\t\t\t\tif (tokenType === undefined) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// we can use the document's range conversion methods because the result is at the same version as the document\n\t\t\tconst startPos = document.positionAt(offset);\n\t\t\tconst endPos = document.positionAt(offset + length);\n\n\t\t\tfor (let line = startPos.line; line <= endPos.line; line++) {\n\t\t\t\tconst startCharacter = (line === startPos.line ? startPos.character : 0);\n\t\t\t\tconst endCharacter = (line === endPos.line ? endPos.character : document.lineAt(line).text.length);\n\t\t\t\tbuilder.push(line, startCharacter, endCharacter - startCharacter, tokenType, tokenModifiers);\n\t\t\t}\n\t\t}\n\t\treturn builder.build();\n\t}\n}\n\nfunction waitForDocumentChangesToEnd(document: vscode.TextDocument) {\n\tlet version = document.version;\n\treturn new Promise<void>((s) => {\n\t\tconst iv = setInterval(_ => {\n\t\t\tif (document.version === version) {\n\t\t\t\tclearInterval(iv);\n\t\t\t\ts();\n\t\t\t}\n\t\t\tversion = document.version;\n\t\t}, 400);\n\t});\n}\n\n\n// typescript encodes type and modifiers in the classification:\n// TSClassification = (TokenType + 1) << 8 + TokenModifier\n\ndeclare const enum TokenType {\n\tclass = 0,\n\tenum = 1,\n\tinterface = 2,\n\tnamespace = 3,\n\ttypeParameter = 4,\n\ttype = 5,\n\tparameter = 6,\n\tvariable = 7,\n\tenumMember = 8,\n\tproperty = 9,\n\tfunction = 10,\n\tmethod = 11,\n\t_ = 12\n}\ndeclare const enum TokenModifier {\n\tdeclaration = 0,\n\tstatic = 1,\n\tasync = 2,\n\treadonly = 3,\n\tdefaultLibrary = 4,\n\tlocal = 5,\n\t_ = 6\n}\ndeclare const enum TokenEncodingConsts {\n\ttypeOffset = 8,\n\tmodifierMask = 255\n}\ndeclare const enum VersionRequirement {\n\tmajor = 3,\n\tminor = 7\n}\n\nfunction getTokenTypeFromClassification(tsClassification: number): number | undefined {\n\tif (tsClassification > TokenEncodingConsts.modifierMask) {\n\t\treturn (tsClassification >> TokenEncodingConsts.typeOffset) - 1;\n\t}\n\treturn undefined;\n}\n\nfunction getTokenModifierFromClassification(tsClassification: number) {\n\treturn tsClassification & TokenEncodingConsts.modifierMask;\n}\n\nconst tokenTypes: string[] = [];\ntokenTypes[TokenType.class] = 'class';\ntokenTypes[TokenType.enum] = 'enum';\ntokenTypes[TokenType.interface] = 'interface';\ntokenTypes[TokenType.namespace] = 'namespace';\ntokenTypes[TokenType.typeParameter] = 'typeParameter';\ntokenTypes[TokenType.type] = 'type';\ntokenTypes[TokenType.parameter] = 'parameter';\ntokenTypes[TokenType.variable] = 'variable';\ntokenTypes[TokenType.enumMember] = 'enumMember';\ntokenTypes[TokenType.property] = 'property';\ntokenTypes[TokenType.function] = 'function';\ntokenTypes[TokenType.method] = 'method';\n\nconst tokenModifiers: string[] = [];\ntokenModifiers[TokenModifier.async] = 'async';\ntokenModifiers[TokenModifier.declaration] = 'declaration';\ntokenModifiers[TokenModifier.readonly] = 'readonly';\ntokenModifiers[TokenModifier.static] = 'static';\ntokenModifiers[TokenModifier.local] = 'local';\ntokenModifiers[TokenModifier.defaultLibrary] = 'defaultLibrary';\n\n// mapping for the original ExperimentalProtocol.ClassificationType from TypeScript (only used when plugin is not available)\nconst tokenTypeMap: number[] = [];\ntokenTypeMap[ExperimentalProtocol.ClassificationType.className] = TokenType.class;\ntokenTypeMap[ExperimentalProtocol.ClassificationType.enumName] = TokenType.enum;\ntokenTypeMap[ExperimentalProtocol.ClassificationType.interfaceName] = TokenType.interface;\ntokenTypeMap[ExperimentalProtocol.ClassificationType.moduleName] = TokenType.namespace;\ntokenTypeMap[ExperimentalProtocol.ClassificationType.typeParameterName] = TokenType.typeParameter;\ntokenTypeMap[ExperimentalProtocol.ClassificationType.typeAliasName] = TokenType.type;\ntokenTypeMap[ExperimentalProtocol.ClassificationType.parameterName] = TokenType.parameter;\n\nnamespace ExperimentalProtocol {\n\n\texport interface IExtendedTypeScriptServiceClient {\n\t\texecute<K extends keyof ExperimentalProtocol.ExtendedTsServerRequests>(\n\t\t\tcommand: K,\n\t\t\targs: ExperimentalProtocol.ExtendedTsServerRequests[K][0],\n\t\t\ttoken: vscode.CancellationToken,\n\t\t\tconfig?: ExecConfig\n\t\t): Promise<ServerResponse.Response<ExperimentalProtocol.ExtendedTsServerRequests[K][1]>>;\n\t}\n\n\t/**\n\t * A request to get encoded semantic classifications for a span in the file\n\t */\n\texport interface EncodedSemanticClassificationsRequest extends Proto.FileRequest {\n\t\targuments: EncodedSemanticClassificationsRequestArgs;\n\t}\n\n\t/**\n\t * Arguments for EncodedSemanticClassificationsRequest request.\n\t */\n\texport interface EncodedSemanticClassificationsRequestArgs extends Proto.FileRequestArgs {\n\t\t/**\n\t\t * Start position of the span.\n\t\t */\n\t\tstart: number;\n\t\t/**\n\t\t * Length of the span.\n\t\t */\n\t\tlength: number;\n\t}\n\n\texport const enum EndOfLineState {\n\t\tNone,\n\t\tInMultiLineCommentTrivia,\n\t\tInSingleQuoteStringLiteral,\n\t\tInDoubleQuoteStringLiteral,\n\t\tInTemplateHeadOrNoSubstitutionTemplate,\n\t\tInTemplateMiddleOrTail,\n\t\tInTemplateSubstitutionPosition,\n\t}\n\n\texport const enum ClassificationType {\n\t\tcomment = 1,\n\t\tidentifier = 2,\n\t\tkeyword = 3,\n\t\tnumericLiteral = 4,\n\t\toperator = 5,\n\t\tstringLiteral = 6,\n\t\tregularExpressionLiteral = 7,\n\t\twhiteSpace = 8,\n\t\ttext = 9,\n\t\tpunctuation = 10,\n\t\tclassName = 11,\n\t\tenumName = 12,\n\t\tinterfaceName = 13,\n\t\tmoduleName = 14,\n\t\ttypeParameterName = 15,\n\t\ttypeAliasName = 16,\n\t\tparameterName = 17,\n\t\tdocCommentTagName = 18,\n\t\tjsxOpenTagName = 19,\n\t\tjsxCloseTagName = 20,\n\t\tjsxSelfClosingTagName = 21,\n\t\tjsxAttribute = 22,\n\t\tjsxText = 23,\n\t\tjsxAttributeStringLiteralValue = 24,\n\t\tbigintLiteral = 25,\n\t}\n\n\texport interface EncodedSemanticClassificationsResponse extends Proto.Response {\n\t\tbody?: {\n\t\t\tendOfLineState: EndOfLineState;\n\t\t\tspans: number[];\n\t\t};\n\t}\n\n\texport interface ExtendedTsServerRequests {\n\t\t'encodedSemanticClassifications-full': [ExperimentalProtocol.EncodedSemanticClassificationsRequestArgs, ExperimentalProtocol.EncodedSemanticClassificationsResponse];\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../protocol';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport { conditionalRegistration, requireSomeCapability } from '../utils/dependentRegistration';\nimport { DocumentSelector } from '../utils/documentSelector';\nimport * as Previewer from '../utils/previewer';\nimport * as typeConverters from '../utils/typeConverters';\n\nclass TypeScriptSignatureHelpProvider implements vscode.SignatureHelpProvider {\n\n\tpublic static readonly triggerCharacters = ['(', ',', '<'];\n\tpublic static readonly retriggerCharacters = [')'];\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient\n\t) { }\n\n\tpublic async provideSignatureHelp(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\ttoken: vscode.CancellationToken,\n\t\tcontext: vscode.SignatureHelpContext,\n\t): Promise<vscode.SignatureHelp | undefined> {\n\t\tconst filepath = this.client.toOpenedFilePath(document);\n\t\tif (!filepath) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst args: Proto.SignatureHelpRequestArgs = {\n\t\t\t...typeConverters.Position.toFileLocationRequestArgs(filepath, position),\n\t\t\ttriggerReason: toTsTriggerReason(context)\n\t\t};\n\t\tconst response = await this.client.interruptGetErr(() => this.client.execute('signatureHelp', args, token));\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst info = response.body;\n\t\tconst result = new vscode.SignatureHelp();\n\t\tresult.signatures = info.items.map(signature => this.convertSignature(signature));\n\t\tresult.activeSignature = this.getActiveSignature(context, info, result.signatures);\n\t\tresult.activeParameter = this.getActiveParameter(info);\n\n\t\treturn result;\n\t}\n\n\tprivate getActiveSignature(context: vscode.SignatureHelpContext, info: Proto.SignatureHelpItems, signatures: readonly vscode.SignatureInformation[]): number {\n\t\t// Try matching the previous active signature's label to keep it selected\n\t\tconst previouslyActiveSignature = context.activeSignatureHelp?.signatures[context.activeSignatureHelp.activeSignature];\n\t\tif (previouslyActiveSignature && context.isRetrigger) {\n\t\t\tconst existingIndex = signatures.findIndex(other => other.label === previouslyActiveSignature?.label);\n\t\t\tif (existingIndex >= 0) {\n\t\t\t\treturn existingIndex;\n\t\t\t}\n\t\t}\n\n\t\treturn info.selectedItemIndex;\n\t}\n\n\tprivate getActiveParameter(info: Proto.SignatureHelpItems): number {\n\t\tconst activeSignature = info.items[info.selectedItemIndex];\n\t\tif (activeSignature && activeSignature.isVariadic) {\n\t\t\treturn Math.min(info.argumentIndex, activeSignature.parameters.length - 1);\n\t\t}\n\t\treturn info.argumentIndex;\n\t}\n\n\tprivate convertSignature(item: Proto.SignatureHelpItem) {\n\t\tconst signature = new vscode.SignatureInformation(\n\t\t\tPreviewer.plainWithLinks(item.prefixDisplayParts, this.client),\n\t\t\tPreviewer.markdownDocumentation(item.documentation, item.tags.filter(x => x.name !== 'param'), this.client));\n\n\t\tlet textIndex = signature.label.length;\n\t\tconst separatorLabel = Previewer.plainWithLinks(item.separatorDisplayParts, this.client);\n\t\tfor (let i = 0; i < item.parameters.length; ++i) {\n\t\t\tconst parameter = item.parameters[i];\n\t\t\tconst label = Previewer.plainWithLinks(parameter.displayParts, this.client);\n\n\t\t\tsignature.parameters.push(\n\t\t\t\tnew vscode.ParameterInformation(\n\t\t\t\t\t[textIndex, textIndex + label.length],\n\t\t\t\t\tPreviewer.markdownDocumentation(parameter.documentation, [], this.client)));\n\n\t\t\ttextIndex += label.length;\n\t\t\tsignature.label += label;\n\n\t\t\tif (i !== item.parameters.length - 1) {\n\t\t\t\tsignature.label += separatorLabel;\n\t\t\t\ttextIndex += separatorLabel.length;\n\t\t\t}\n\t\t}\n\n\t\tsignature.label += Previewer.plainWithLinks(item.suffixDisplayParts, this.client);\n\t\treturn signature;\n\t}\n}\n\nfunction toTsTriggerReason(context: vscode.SignatureHelpContext): Proto.SignatureHelpTriggerReason {\n\tswitch (context.triggerKind) {\n\t\tcase vscode.SignatureHelpTriggerKind.TriggerCharacter:\n\t\t\tif (context.triggerCharacter) {\n\t\t\t\tif (context.isRetrigger) {\n\t\t\t\t\treturn { kind: 'retrigger', triggerCharacter: context.triggerCharacter as any };\n\t\t\t\t} else {\n\t\t\t\t\treturn { kind: 'characterTyped', triggerCharacter: context.triggerCharacter as any };\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn { kind: 'invoked' };\n\t\t\t}\n\n\t\tcase vscode.SignatureHelpTriggerKind.ContentChange:\n\t\t\treturn context.isRetrigger ? { kind: 'retrigger' } : { kind: 'invoked' };\n\n\t\tcase vscode.SignatureHelpTriggerKind.Invoke:\n\t\tdefault:\n\t\t\treturn { kind: 'invoked' };\n\t}\n}\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n) {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.EnhancedSyntax, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerSignatureHelpProvider(selector.syntax,\n\t\t\tnew TypeScriptSignatureHelpProvider(client), {\n\t\t\ttriggerCharacters: TypeScriptSignatureHelpProvider.triggerCharacters,\n\t\t\tretriggerCharacters: TypeScriptSignatureHelpProvider.retriggerCharacters\n\t\t});\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../protocol';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport API from '../utils/api';\nimport { conditionalRegistration, requireMinVersion } from '../utils/dependentRegistration';\nimport { DocumentSelector } from '../utils/documentSelector';\nimport * as typeConverters from '../utils/typeConverters';\n\nclass SmartSelection implements vscode.SelectionRangeProvider {\n\tpublic static readonly minVersion = API.v350;\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient\n\t) { }\n\n\tpublic async provideSelectionRanges(\n\t\tdocument: vscode.TextDocument,\n\t\tpositions: vscode.Position[],\n\t\ttoken: vscode.CancellationToken,\n\t): Promise<vscode.SelectionRange[] | undefined> {\n\t\tconst file = this.client.toOpenedFilePath(document);\n\t\tif (!file) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst args: Proto.SelectionRangeRequestArgs = {\n\t\t\tfile,\n\t\t\tlocations: positions.map(typeConverters.Position.toLocation)\n\t\t};\n\t\tconst response = await this.client.execute('selectionRange', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn response.body.map(SmartSelection.convertSelectionRange);\n\t}\n\n\tprivate static convertSelectionRange(\n\t\tselectionRange: Proto.SelectionRange\n\t): vscode.SelectionRange {\n\t\treturn new vscode.SelectionRange(\n\t\t\ttypeConverters.Range.fromTextSpan(selectionRange.textSpan),\n\t\t\tselectionRange.parent ? SmartSelection.convertSelectionRange(selectionRange.parent) : undefined,\n\t\t);\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n) {\n\treturn conditionalRegistration([\n\t\trequireMinVersion(client, SmartSelection.minVersion),\n\t], () => {\n\t\treturn vscode.languages.registerSelectionRangeProvider(selector.syntax, new SmartSelection(client));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../protocol';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport API from '../utils/api';\nimport { Condition, conditionalRegistration, requireConfiguration, requireMinVersion } from '../utils/dependentRegistration';\nimport { Disposable } from '../utils/dispose';\nimport { DocumentSelector } from '../utils/documentSelector';\nimport * as typeConverters from '../utils/typeConverters';\n\nclass TagClosing extends Disposable {\n\tpublic static readonly minVersion = API.v300;\n\n\tprivate _disposed = false;\n\tprivate _timeout: NodeJS.Timer | undefined = undefined;\n\tprivate _cancel: vscode.CancellationTokenSource | undefined = undefined;\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient\n\t) {\n\t\tsuper();\n\t\tvscode.workspace.onDidChangeTextDocument(\n\t\t\tevent => this.onDidChangeTextDocument(event),\n\t\t\tnull,\n\t\t\tthis._disposables);\n\t}\n\n\tpublic override dispose() {\n\t\tsuper.dispose();\n\t\tthis._disposed = true;\n\n\t\tif (this._timeout) {\n\t\t\tclearTimeout(this._timeout);\n\t\t\tthis._timeout = undefined;\n\t\t}\n\n\t\tif (this._cancel) {\n\t\t\tthis._cancel.cancel();\n\t\t\tthis._cancel.dispose();\n\t\t\tthis._cancel = undefined;\n\t\t}\n\t}\n\n\tprivate onDidChangeTextDocument(\n\t\t{ document, contentChanges, reason }: vscode.TextDocumentChangeEvent\n\t) {\n\t\tif (contentChanges.length === 0 || reason === vscode.TextDocumentChangeReason.Undo || reason === vscode.TextDocumentChangeReason.Redo) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst activeDocument = vscode.window.activeTextEditor && vscode.window.activeTextEditor.document;\n\t\tif (document !== activeDocument) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst filepath = this.client.toOpenedFilePath(document);\n\t\tif (!filepath) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (typeof this._timeout !== 'undefined') {\n\t\t\tclearTimeout(this._timeout);\n\t\t}\n\n\t\tif (this._cancel) {\n\t\t\tthis._cancel.cancel();\n\t\t\tthis._cancel.dispose();\n\t\t\tthis._cancel = undefined;\n\t\t}\n\n\t\tconst lastChange = contentChanges[contentChanges.length - 1];\n\t\tconst lastCharacter = lastChange.text[lastChange.text.length - 1];\n\t\tif (lastChange.rangeLength > 0 || lastCharacter !== '>' && lastCharacter !== '/') {\n\t\t\treturn;\n\t\t}\n\n\t\tconst priorCharacter = lastChange.range.start.character > 0\n\t\t\t? document.getText(new vscode.Range(lastChange.range.start.translate({ characterDelta: -1 }), lastChange.range.start))\n\t\t\t: '';\n\t\tif (priorCharacter === '>') {\n\t\t\treturn;\n\t\t}\n\n\t\tconst version = document.version;\n\t\tthis._timeout = setTimeout(async () => {\n\t\t\tthis._timeout = undefined;\n\n\t\t\tif (this._disposed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst addedLines = lastChange.text.split(/\\r\\n|\\n/g);\n\t\t\tconst position = addedLines.length <= 1\n\t\t\t\t? lastChange.range.start.translate({ characterDelta: lastChange.text.length })\n\t\t\t\t: new vscode.Position(lastChange.range.start.line + addedLines.length - 1, addedLines[addedLines.length - 1].length);\n\n\t\t\tconst args: Proto.JsxClosingTagRequestArgs = typeConverters.Position.toFileLocationRequestArgs(filepath, position);\n\t\t\tthis._cancel = new vscode.CancellationTokenSource();\n\t\t\tconst response = await this.client.execute('jsxClosingTag', args, this._cancel.token);\n\t\t\tif (response.type !== 'response' || !response.body) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this._disposed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst activeEditor = vscode.window.activeTextEditor;\n\t\t\tif (!activeEditor) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst insertion = response.body;\n\t\t\tconst activeDocument = activeEditor.document;\n\t\t\tif (document === activeDocument && activeDocument.version === version) {\n\t\t\t\tactiveEditor.insertSnippet(\n\t\t\t\t\tthis.getTagSnippet(insertion),\n\t\t\t\t\tthis.getInsertionPositions(activeEditor, position));\n\t\t\t}\n\t\t}, 100);\n\t}\n\n\tprivate getTagSnippet(closingTag: Proto.TextInsertion): vscode.SnippetString {\n\t\tconst snippet = new vscode.SnippetString();\n\t\tsnippet.appendPlaceholder('', 0);\n\t\tsnippet.appendText(closingTag.newText);\n\t\treturn snippet;\n\t}\n\n\tprivate getInsertionPositions(editor: vscode.TextEditor, position: vscode.Position) {\n\t\tconst activeSelectionPositions = editor.selections.map(s => s.active);\n\t\treturn activeSelectionPositions.some(p => p.isEqual(position))\n\t\t\t? activeSelectionPositions\n\t\t\t: position;\n\t}\n}\n\nfunction requireActiveDocument(\n\tselector: vscode.DocumentSelector\n) {\n\treturn new Condition(\n\t\t() => {\n\t\t\tconst editor = vscode.window.activeTextEditor;\n\t\t\treturn !!(editor && vscode.languages.match(selector, editor.document));\n\t\t},\n\t\thandler => {\n\t\t\treturn vscode.Disposable.from(\n\t\t\t\tvscode.window.onDidChangeActiveTextEditor(handler),\n\t\t\t\tvscode.workspace.onDidOpenTextDocument(handler));\n\t\t});\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tmodeId: string,\n\tclient: ITypeScriptServiceClient,\n) {\n\treturn conditionalRegistration([\n\t\trequireMinVersion(client, TagClosing.minVersion),\n\t\trequireConfiguration(modeId, 'autoClosingTags'),\n\t\trequireActiveDocument(selector.syntax)\n\t], () => new TagClosing(client));\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport { conditionalRegistration, requireSomeCapability } from '../utils/dependentRegistration';\nimport { DocumentSelector } from '../utils/documentSelector';\nimport DefinitionProviderBase from './definitionProviderBase';\n\nexport default class TypeScriptTypeDefinitionProvider extends DefinitionProviderBase implements vscode.TypeDefinitionProvider {\n\tpublic provideTypeDefinition(document: vscode.TextDocument, position: vscode.Position, token: vscode.CancellationToken): Promise<vscode.Definition | undefined> {\n\t\treturn this.getSymbolLocations('typeDefinition', document, position, token);\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n) {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.EnhancedSyntax, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerTypeDefinitionProvider(selector.syntax,\n\t\t\tnew TypeScriptTypeDefinitionProvider(client));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../protocol';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport API from '../utils/api';\nimport { Condition, conditionalRegistration, requireMinVersion, requireSomeCapability } from '../utils/dependentRegistration';\nimport { Disposable } from '../utils/dispose';\nimport { DocumentSelector } from '../utils/documentSelector';\nimport { Position } from '../utils/typeConverters';\nimport FileConfigurationManager, { getInlayHintsPreferences, InlayHintSettingNames } from './fileConfigurationManager';\n\n\nconst inlayHintSettingNames = [\n\tInlayHintSettingNames.parameterNamesSuppressWhenArgumentMatchesName,\n\tInlayHintSettingNames.parameterNamesEnabled,\n\tInlayHintSettingNames.variableTypesEnabled,\n\tInlayHintSettingNames.propertyDeclarationTypesEnabled,\n\tInlayHintSettingNames.functionLikeReturnTypesEnabled,\n\tInlayHintSettingNames.enumMemberValuesEnabled,\n];\n\nclass TypeScriptInlayHintsProvider extends Disposable implements vscode.InlayHintsProvider {\n\n\tpublic static readonly minVersion = API.v440;\n\n\tprivate readonly _onDidChangeInlayHints = new vscode.EventEmitter<void>();\n\tpublic readonly onDidChangeInlayHints = this._onDidChangeInlayHints.event;\n\n\tconstructor(\n\t\tmodeId: string,\n\t\tlanguageIds: readonly string[],\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly fileConfigurationManager: FileConfigurationManager\n\t) {\n\t\tsuper();\n\n\t\tthis._register(vscode.workspace.onDidChangeConfiguration(e => {\n\t\t\tif (inlayHintSettingNames.some(settingName => e.affectsConfiguration(modeId + '.' + settingName))) {\n\t\t\t\tthis._onDidChangeInlayHints.fire();\n\t\t\t}\n\t\t}));\n\n\t\t// When a JS/TS file changes, change inlay hints for all visible editors\n\t\t// since changes in one file can effect the hints the others.\n\t\tthis._register(vscode.workspace.onDidChangeTextDocument(e => {\n\t\t\tif (languageIds.includes(e.document.languageId)) {\n\t\t\t\tthis._onDidChangeInlayHints.fire();\n\t\t\t}\n\t\t}));\n\t}\n\n\tasync provideInlayHints(model: vscode.TextDocument, range: vscode.Range, token: vscode.CancellationToken): Promise<vscode.InlayHint[]> {\n\t\tconst filepath = this.client.toOpenedFilePath(model);\n\t\tif (!filepath) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst start = model.offsetAt(range.start);\n\t\tconst length = model.offsetAt(range.end) - start;\n\n\t\tawait this.fileConfigurationManager.ensureConfigurationForDocument(model, token);\n\n\t\tconst response = await this.client.execute('provideInlayHints', { file: filepath, start, length }, token);\n\t\tif (response.type !== 'response' || !response.success || !response.body) {\n\t\t\treturn [];\n\t\t}\n\n\t\treturn response.body.map(hint => {\n\t\t\tconst result = new vscode.InlayHint(\n\t\t\t\thint.text,\n\t\t\t\tPosition.fromLocation(hint.position),\n\t\t\t\thint.kind && fromProtocolInlayHintKind(hint.kind)\n\t\t\t);\n\t\t\tresult.whitespaceBefore = hint.whitespaceBefore;\n\t\t\tresult.whitespaceAfter = hint.whitespaceAfter;\n\t\t\treturn result;\n\t\t});\n\t}\n}\n\n\nfunction fromProtocolInlayHintKind(kind: Proto.InlayHintKind): vscode.InlayHintKind {\n\tswitch (kind) {\n\t\tcase 'Parameter': return vscode.InlayHintKind.Parameter;\n\t\tcase 'Type': return vscode.InlayHintKind.Type;\n\t\tcase 'Enum': return vscode.InlayHintKind.Other;\n\t\tdefault: return vscode.InlayHintKind.Other;\n\t}\n}\n\nexport function requireInlayHintsConfiguration(\n\tlanguage: string\n) {\n\treturn new Condition(\n\t\t() => {\n\t\t\tconst config = vscode.workspace.getConfiguration(language, null);\n\t\t\tconst preferences = getInlayHintsPreferences(config);\n\n\t\t\treturn preferences.includeInlayParameterNameHints === 'literals' ||\n\t\t\t\tpreferences.includeInlayParameterNameHints === 'all' ||\n\t\t\t\tpreferences.includeInlayEnumMemberValueHints ||\n\t\t\t\tpreferences.includeInlayFunctionLikeReturnTypeHints ||\n\t\t\t\tpreferences.includeInlayFunctionParameterTypeHints ||\n\t\t\t\tpreferences.includeInlayPropertyDeclarationTypeHints ||\n\t\t\t\tpreferences.includeInlayVariableTypeHints;\n\t\t},\n\t\tvscode.workspace.onDidChangeConfiguration\n\t);\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tmodeId: string,\n\tlanguageIds: readonly string[],\n\tclient: ITypeScriptServiceClient,\n\tfileConfigurationManager: FileConfigurationManager\n) {\n\treturn conditionalRegistration([\n\t\trequireInlayHintsConfiguration(modeId),\n\t\trequireMinVersion(client, TypeScriptInlayHintsProvider.minVersion),\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\tconst provider = new TypeScriptInlayHintsProvider(modeId, languageIds, client, fileConfigurationManager);\n\t\treturn vscode.languages.registerInlayHintsProvider(selector.semantic, provider);\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as path from 'path';\nimport * as vscode from 'vscode';\nimport * as nls from 'vscode-nls';\nimport { DiagnosticKind, DiagnosticsManager } from './languageFeatures/diagnostics';\nimport * as Proto from './protocol';\nimport { EventName } from './protocol.const';\nimport BufferSyncSupport from './tsServer/bufferSyncSupport';\nimport { OngoingRequestCancellerFactory } from './tsServer/cancellation';\nimport { ILogDirectoryProvider } from './tsServer/logDirectoryProvider';\nimport { ITypeScriptServer, TsServerProcessFactory, TypeScriptServerExitEvent } from './tsServer/server';\nimport { TypeScriptServerError } from './tsServer/serverError';\nimport { TypeScriptServerSpawner } from './tsServer/spawner';\nimport { TypeScriptVersionManager } from './tsServer/versionManager';\nimport { ITypeScriptVersionProvider, TypeScriptVersion } from './tsServer/versionProvider';\nimport { ClientCapabilities, ClientCapability, ExecConfig, ITypeScriptServiceClient, ServerResponse, TypeScriptRequests } from './typescriptService';\nimport API from './utils/api';\nimport { areServiceConfigurationsEqual, ServiceConfigurationProvider, SyntaxServerConfiguration, TsServerLogLevel, TypeScriptServiceConfiguration } from './utils/configuration';\nimport { Disposable } from './utils/dispose';\nimport * as fileSchemes from './utils/fileSchemes';\nimport { Logger } from './utils/logger';\nimport { isWeb } from './utils/platform';\nimport { TypeScriptPluginPathsProvider } from './utils/pluginPathsProvider';\nimport { PluginManager } from './utils/plugins';\nimport { TelemetryProperties, TelemetryReporter, VSCodeTelemetryReporter } from './utils/telemetry';\nimport Tracer from './utils/tracer';\nimport { inferredProjectCompilerOptions, ProjectType } from './utils/tsconfig';\n\nconst localize = nls.loadMessageBundle();\n\nexport interface TsDiagnostics {\n\treadonly kind: DiagnosticKind;\n\treadonly resource: vscode.Uri;\n\treadonly diagnostics: Proto.Diagnostic[];\n}\n\ninterface ToCancelOnResourceChanged {\n\treadonly resource: vscode.Uri;\n\tcancel(): void;\n}\n\nnamespace ServerState {\n\texport const enum Type {\n\t\tNone,\n\t\tRunning,\n\t\tErrored\n\t}\n\n\texport const None = { type: Type.None } as const;\n\n\texport class Running {\n\t\treadonly type = Type.Running;\n\n\t\tconstructor(\n\t\t\tpublic readonly server: ITypeScriptServer,\n\n\t\t\t/**\n\t\t\t * API version obtained from the version picker after checking the corresponding path exists.\n\t\t\t */\n\t\t\tpublic readonly apiVersion: API,\n\n\t\t\t/**\n\t\t\t * Version reported by currently-running tsserver.\n\t\t\t */\n\t\t\tpublic tsserverVersion: string | undefined,\n\t\t\tpublic languageServiceEnabled: boolean,\n\t\t) { }\n\n\t\tpublic readonly toCancelOnResourceChange = new Set<ToCancelOnResourceChanged>();\n\n\t\tupdateTsserverVersion(tsserverVersion: string) {\n\t\t\tthis.tsserverVersion = tsserverVersion;\n\t\t}\n\n\t\tupdateLanguageServiceEnabled(enabled: boolean) {\n\t\t\tthis.languageServiceEnabled = enabled;\n\t\t}\n\t}\n\n\texport class Errored {\n\t\treadonly type = Type.Errored;\n\t\tconstructor(\n\t\t\tpublic readonly error: Error,\n\t\t\tpublic readonly tsServerLogFile: string | undefined,\n\t\t) { }\n\t}\n\n\texport type State = typeof None | Running | Errored;\n}\n\nexport default class TypeScriptServiceClient extends Disposable implements ITypeScriptServiceClient {\n\n\tprivate readonly pathSeparator: string;\n\tprivate readonly inMemoryResourcePrefix = '^';\n\n\tprivate readonly workspaceState: vscode.Memento;\n\n\tprivate _onReady?: { promise: Promise<void>; resolve: () => void; reject: () => void; };\n\tprivate _configuration: TypeScriptServiceConfiguration;\n\tprivate pluginPathsProvider: TypeScriptPluginPathsProvider;\n\tprivate readonly _versionManager: TypeScriptVersionManager;\n\n\tprivate readonly logger = new Logger();\n\tprivate readonly tracer = new Tracer(this.logger);\n\n\tprivate readonly typescriptServerSpawner: TypeScriptServerSpawner;\n\tprivate serverState: ServerState.State = ServerState.None;\n\tprivate lastStart: number;\n\tprivate numberRestarts: number;\n\tprivate _isPromptingAfterCrash = false;\n\tprivate isRestarting: boolean = false;\n\tprivate hasServerFatallyCrashedTooManyTimes = false;\n\tprivate readonly loadingIndicator = new ServerInitializingIndicator();\n\n\tpublic readonly telemetryReporter: TelemetryReporter;\n\tpublic readonly bufferSyncSupport: BufferSyncSupport;\n\tpublic readonly diagnosticsManager: DiagnosticsManager;\n\tpublic readonly pluginManager: PluginManager;\n\n\tprivate readonly logDirectoryProvider: ILogDirectoryProvider;\n\tprivate readonly cancellerFactory: OngoingRequestCancellerFactory;\n\tprivate readonly versionProvider: ITypeScriptVersionProvider;\n\tprivate readonly processFactory: TsServerProcessFactory;\n\n\tconstructor(\n\t\tprivate readonly context: vscode.ExtensionContext,\n\t\tonCaseInsenitiveFileSystem: boolean,\n\t\tservices: {\n\t\t\tpluginManager: PluginManager,\n\t\t\tlogDirectoryProvider: ILogDirectoryProvider,\n\t\t\tcancellerFactory: OngoingRequestCancellerFactory,\n\t\t\tversionProvider: ITypeScriptVersionProvider,\n\t\t\tprocessFactory: TsServerProcessFactory,\n\t\t\tserviceConfigurationProvider: ServiceConfigurationProvider,\n\t\t},\n\t\tallModeIds: readonly string[]\n\t) {\n\t\tsuper();\n\n\t\tthis.workspaceState = context.workspaceState;\n\n\t\tthis.pluginManager = services.pluginManager;\n\t\tthis.logDirectoryProvider = services.logDirectoryProvider;\n\t\tthis.cancellerFactory = services.cancellerFactory;\n\t\tthis.versionProvider = services.versionProvider;\n\t\tthis.processFactory = services.processFactory;\n\n\t\tthis.pathSeparator = path.sep;\n\t\tthis.lastStart = Date.now();\n\n\t\tlet resolve: () => void;\n\t\tlet reject: () => void;\n\t\tconst p = new Promise<void>((res, rej) => {\n\t\t\tresolve = res;\n\t\t\treject = rej;\n\t\t});\n\t\tthis._onReady = { promise: p, resolve: resolve!, reject: reject! };\n\n\t\tthis.numberRestarts = 0;\n\n\t\tthis._configuration = services.serviceConfigurationProvider.loadFromWorkspace();\n\t\tthis.versionProvider.updateConfiguration(this._configuration);\n\n\t\tthis.pluginPathsProvider = new TypeScriptPluginPathsProvider(this._configuration);\n\t\tthis._versionManager = this._register(new TypeScriptVersionManager(this._configuration, this.versionProvider, this.workspaceState));\n\t\tthis._register(this._versionManager.onDidPickNewVersion(() => {\n\t\t\tthis.restartTsServer();\n\t\t}));\n\n\t\tthis.bufferSyncSupport = new BufferSyncSupport(this, allModeIds, onCaseInsenitiveFileSystem);\n\t\tthis.onReady(() => { this.bufferSyncSupport.listen(); });\n\n\t\tthis.diagnosticsManager = new DiagnosticsManager('typescript', onCaseInsenitiveFileSystem);\n\t\tthis.bufferSyncSupport.onDelete(resource => {\n\t\t\tthis.cancelInflightRequestsForResource(resource);\n\t\t\tthis.diagnosticsManager.delete(resource);\n\t\t}, null, this._disposables);\n\n\t\tthis.bufferSyncSupport.onWillChange(resource => {\n\t\t\tthis.cancelInflightRequestsForResource(resource);\n\t\t});\n\n\t\tvscode.workspace.onDidChangeConfiguration(() => {\n\t\t\tconst oldConfiguration = this._configuration;\n\t\t\tthis._configuration = services.serviceConfigurationProvider.loadFromWorkspace();\n\n\t\t\tthis.versionProvider.updateConfiguration(this._configuration);\n\t\t\tthis._versionManager.updateConfiguration(this._configuration);\n\t\t\tthis.pluginPathsProvider.updateConfiguration(this._configuration);\n\t\t\tthis.tracer.updateConfiguration();\n\n\t\t\tif (this.serverState.type === ServerState.Type.Running) {\n\t\t\t\tif (!this._configuration.implicitProjectConfiguration.isEqualTo(oldConfiguration.implicitProjectConfiguration)) {\n\t\t\t\t\tthis.setCompilerOptionsForInferredProjects(this._configuration);\n\t\t\t\t}\n\n\t\t\t\tif (!areServiceConfigurationsEqual(this._configuration, oldConfiguration)) {\n\t\t\t\t\tthis.restartTsServer();\n\t\t\t\t}\n\t\t\t}\n\t\t}, this, this._disposables);\n\n\t\tthis.telemetryReporter = this._register(new VSCodeTelemetryReporter(() => {\n\t\t\tif (this.serverState.type === ServerState.Type.Running) {\n\t\t\t\tif (this.serverState.tsserverVersion) {\n\t\t\t\t\treturn this.serverState.tsserverVersion;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this.apiVersion.fullVersionString;\n\t\t}));\n\n\t\tthis.typescriptServerSpawner = new TypeScriptServerSpawner(this.versionProvider, this._versionManager, this.logDirectoryProvider, this.pluginPathsProvider, this.logger, this.telemetryReporter, this.tracer, this.processFactory);\n\n\t\tthis._register(this.pluginManager.onDidUpdateConfig(update => {\n\t\t\tthis.configurePlugin(update.pluginId, update.config);\n\t\t}));\n\n\t\tthis._register(this.pluginManager.onDidChangePlugins(() => {\n\t\t\tthis.restartTsServer();\n\t\t}));\n\t}\n\n\tpublic get capabilities() {\n\t\tif (this._configuration.useSyntaxServer === SyntaxServerConfiguration.Always) {\n\t\t\treturn new ClientCapabilities(\n\t\t\t\tClientCapability.Syntax,\n\t\t\t\tClientCapability.EnhancedSyntax);\n\t\t}\n\n\t\tif (isWeb()) {\n\t\t\treturn new ClientCapabilities(\n\t\t\t\tClientCapability.Syntax,\n\t\t\t\tClientCapability.EnhancedSyntax);\n\t\t}\n\n\t\tif (this.apiVersion.gte(API.v400)) {\n\t\t\treturn new ClientCapabilities(\n\t\t\t\tClientCapability.Syntax,\n\t\t\t\tClientCapability.EnhancedSyntax,\n\t\t\t\tClientCapability.Semantic);\n\t\t}\n\n\t\treturn new ClientCapabilities(\n\t\t\tClientCapability.Syntax,\n\t\t\tClientCapability.Semantic);\n\t}\n\n\tprivate readonly _onDidChangeCapabilities = this._register(new vscode.EventEmitter<void>());\n\treadonly onDidChangeCapabilities = this._onDidChangeCapabilities.event;\n\n\tprivate cancelInflightRequestsForResource(resource: vscode.Uri): void {\n\t\tif (this.serverState.type !== ServerState.Type.Running) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const request of this.serverState.toCancelOnResourceChange) {\n\t\t\tif (request.resource.toString() === resource.toString()) {\n\t\t\t\trequest.cancel();\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic get configuration() {\n\t\treturn this._configuration;\n\t}\n\n\tpublic override dispose() {\n\t\tsuper.dispose();\n\n\t\tthis.bufferSyncSupport.dispose();\n\n\t\tif (this.serverState.type === ServerState.Type.Running) {\n\t\t\tthis.serverState.server.kill();\n\t\t}\n\n\t\tthis.loadingIndicator.reset();\n\t}\n\n\tpublic restartTsServer(): void {\n\t\tif (this.serverState.type === ServerState.Type.Running) {\n\t\t\tthis.info('Killing TS Server');\n\t\t\tthis.isRestarting = true;\n\t\t\tthis.serverState.server.kill();\n\t\t}\n\n\t\tthis.serverState = this.startService(true);\n\t}\n\n\tprivate readonly _onTsServerStarted = this._register(new vscode.EventEmitter<{ version: TypeScriptVersion, usedApiVersion: API }>());\n\tpublic readonly onTsServerStarted = this._onTsServerStarted.event;\n\n\tprivate readonly _onDiagnosticsReceived = this._register(new vscode.EventEmitter<TsDiagnostics>());\n\tpublic readonly onDiagnosticsReceived = this._onDiagnosticsReceived.event;\n\n\tprivate readonly _onConfigDiagnosticsReceived = this._register(new vscode.EventEmitter<Proto.ConfigFileDiagnosticEvent>());\n\tpublic readonly onConfigDiagnosticsReceived = this._onConfigDiagnosticsReceived.event;\n\n\tprivate readonly _onResendModelsRequested = this._register(new vscode.EventEmitter<void>());\n\tpublic readonly onResendModelsRequested = this._onResendModelsRequested.event;\n\n\tprivate readonly _onProjectLanguageServiceStateChanged = this._register(new vscode.EventEmitter<Proto.ProjectLanguageServiceStateEventBody>());\n\tpublic readonly onProjectLanguageServiceStateChanged = this._onProjectLanguageServiceStateChanged.event;\n\n\tprivate readonly _onDidBeginInstallTypings = this._register(new vscode.EventEmitter<Proto.BeginInstallTypesEventBody>());\n\tpublic readonly onDidBeginInstallTypings = this._onDidBeginInstallTypings.event;\n\n\tprivate readonly _onDidEndInstallTypings = this._register(new vscode.EventEmitter<Proto.EndInstallTypesEventBody>());\n\tpublic readonly onDidEndInstallTypings = this._onDidEndInstallTypings.event;\n\n\tprivate readonly _onTypesInstallerInitializationFailed = this._register(new vscode.EventEmitter<Proto.TypesInstallerInitializationFailedEventBody>());\n\tpublic readonly onTypesInstallerInitializationFailed = this._onTypesInstallerInitializationFailed.event;\n\n\tprivate readonly _onSurveyReady = this._register(new vscode.EventEmitter<Proto.SurveyReadyEventBody>());\n\tpublic readonly onSurveyReady = this._onSurveyReady.event;\n\n\tpublic get apiVersion(): API {\n\t\tif (this.serverState.type === ServerState.Type.Running) {\n\t\t\treturn this.serverState.apiVersion;\n\t\t}\n\t\treturn API.defaultVersion;\n\t}\n\n\tpublic onReady(f: () => void): Promise<void> {\n\t\treturn this._onReady!.promise.then(f);\n\t}\n\n\tprivate info(message: string, data?: any): void {\n\t\tthis.logger.info(message, data);\n\t}\n\n\tprivate error(message: string, data?: any): void {\n\t\tthis.logger.error(message, data);\n\t}\n\n\tprivate logTelemetry(eventName: string, properties?: TelemetryProperties) {\n\t\tthis.telemetryReporter.logTelemetry(eventName, properties);\n\t}\n\n\tprivate service(): ServerState.Running {\n\t\tif (this.serverState.type === ServerState.Type.Running) {\n\t\t\treturn this.serverState;\n\t\t}\n\t\tif (this.serverState.type === ServerState.Type.Errored) {\n\t\t\tthrow this.serverState.error;\n\t\t}\n\t\tconst newState = this.startService();\n\t\tif (newState.type === ServerState.Type.Running) {\n\t\t\treturn newState;\n\t\t}\n\t\tthrow new Error(`Could not create TS service. Service state:${JSON.stringify(newState)}`);\n\t}\n\n\tpublic ensureServiceStarted() {\n\t\tif (this.serverState.type !== ServerState.Type.Running) {\n\t\t\tthis.startService();\n\t\t}\n\t}\n\n\tprivate token: number = 0;\n\tprivate startService(resendModels: boolean = false): ServerState.State {\n\t\tthis.info(`Starting TS Server `);\n\n\t\tif (this.isDisposed) {\n\t\t\tthis.info(`Not starting server. Disposed `);\n\t\t\treturn ServerState.None;\n\t\t}\n\n\t\tif (this.hasServerFatallyCrashedTooManyTimes) {\n\t\t\tthis.info(`Not starting server. Too many crashes.`);\n\t\t\treturn ServerState.None;\n\t\t}\n\n\t\tlet version = this._versionManager.currentVersion;\n\t\tif (!version.isValid) {\n\t\t\tvscode.window.showWarningMessage(localize('noServerFound', 'The path {0} doesn\\'t point to a valid tsserver install. Falling back to bundled TypeScript version.', version.path));\n\n\t\t\tthis._versionManager.reset();\n\t\t\tversion = this._versionManager.currentVersion;\n\t\t}\n\n\t\tthis.info(`Using tsserver from: ${version.path}`);\n\n\t\tconst apiVersion = version.apiVersion || API.defaultVersion;\n\t\tconst mytoken = ++this.token;\n\t\tconst handle = this.typescriptServerSpawner.spawn(version, this.capabilities, this.configuration, this.pluginManager, this.cancellerFactory, {\n\t\t\tonFatalError: (command, err) => this.fatalError(command, err),\n\t\t});\n\t\tthis.serverState = new ServerState.Running(handle, apiVersion, undefined, true);\n\t\tthis.lastStart = Date.now();\n\n\t\t/* __GDPR__\n\t\t\t\"tsserver.spawned\" : {\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t],\n\t\t\t\t\"localTypeScriptVersion\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"typeScriptVersionSource\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n\t\t\t}\n\t\t*/\n\t\tthis.logTelemetry('tsserver.spawned', {\n\t\t\tlocalTypeScriptVersion: this.versionProvider.localVersion ? this.versionProvider.localVersion.displayName : '',\n\t\t\ttypeScriptVersionSource: version.source,\n\t\t});\n\n\t\thandle.onError((err: Error) => {\n\t\t\tif (this.token !== mytoken) {\n\t\t\t\t// this is coming from an old process\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (err) {\n\t\t\t\tvscode.window.showErrorMessage(localize('serverExitedWithError', 'TypeScript language server exited with error. Error message is: {0}', err.message || err.name));\n\t\t\t}\n\n\t\t\tthis.serverState = new ServerState.Errored(err, handle.tsServerLogFile);\n\t\t\tthis.error('TSServer errored with error.', err);\n\t\t\tif (handle.tsServerLogFile) {\n\t\t\t\tthis.error(`TSServer log file: ${handle.tsServerLogFile}`);\n\t\t\t}\n\n\t\t\t/* __GDPR__\n\t\t\t\t\"tsserver.error\" : {\n\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t*/\n\t\t\tthis.logTelemetry('tsserver.error');\n\t\t\tthis.serviceExited(false);\n\t\t});\n\n\t\thandle.onExit((data: TypeScriptServerExitEvent) => {\n\t\t\tif (this.token !== mytoken) {\n\t\t\t\t// this is coming from an old process\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { code, signal } = data;\n\n\t\t\tif (code === null || typeof code === 'undefined') {\n\t\t\t\tthis.info(`TSServer exited. Signal: ${signal}`);\n\t\t\t} else {\n\t\t\t\t// In practice, the exit code is an integer with no ties to any identity,\n\t\t\t\t// so it can be classified as SystemMetaData, rather than CallstackOrException.\n\t\t\t\tthis.error(`TSServer exited with code: ${code}. Signal: ${signal}`);\n\t\t\t\t/* __GDPR__\n\t\t\t\t\t\"tsserver.exitWithCode\" : {\n\t\t\t\t\t\t\"code\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\t\t\t\t\"signal\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\tthis.logTelemetry('tsserver.exitWithCode', { code, signal: signal ?? undefined });\n\t\t\t}\n\n\t\t\tif (handle.tsServerLogFile) {\n\t\t\t\tthis.info(`TSServer log file: ${handle.tsServerLogFile}`);\n\t\t\t}\n\t\t\tthis.serviceExited(!this.isRestarting);\n\t\t\tthis.isRestarting = false;\n\t\t});\n\n\t\thandle.onEvent(event => this.dispatchEvent(event));\n\n\t\tif (apiVersion.gte(API.v300) && this.capabilities.has(ClientCapability.Semantic)) {\n\t\t\tthis.loadingIndicator.startedLoadingProject(undefined /* projectName */);\n\t\t}\n\n\t\tthis.serviceStarted(resendModels);\n\n\t\tthis._onReady!.resolve();\n\t\tthis._onTsServerStarted.fire({ version: version, usedApiVersion: apiVersion });\n\t\tthis._onDidChangeCapabilities.fire();\n\t\treturn this.serverState;\n\t}\n\n\tpublic async showVersionPicker(): Promise<void> {\n\t\tthis._versionManager.promptUserForVersion();\n\t}\n\n\tpublic async openTsServerLogFile(): Promise<boolean> {\n\t\tif (this._configuration.tsServerLogLevel === TsServerLogLevel.Off) {\n\t\t\tvscode.window.showErrorMessage<vscode.MessageItem>(\n\t\t\t\tlocalize(\n\t\t\t\t\t'typescript.openTsServerLog.loggingNotEnabled',\n\t\t\t\t\t'TS Server logging is off. Please set `typescript.tsserver.log` and restart the TS server to enable logging'),\n\t\t\t\t{\n\t\t\t\t\ttitle: localize(\n\t\t\t\t\t\t'typescript.openTsServerLog.enableAndReloadOption',\n\t\t\t\t\t\t'Enable logging and restart TS server'),\n\t\t\t\t})\n\t\t\t\t.then(selection => {\n\t\t\t\t\tif (selection) {\n\t\t\t\t\t\treturn vscode.workspace.getConfiguration().update('typescript.tsserver.log', 'verbose', true).then(() => {\n\t\t\t\t\t\t\tthis.restartTsServer();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn undefined;\n\t\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.serverState.type !== ServerState.Type.Running || !this.serverState.server.tsServerLogFile) {\n\t\t\tvscode.window.showWarningMessage(localize(\n\t\t\t\t'typescript.openTsServerLog.noLogFile',\n\t\t\t\t'TS Server has not started logging.'));\n\t\t\treturn false;\n\t\t}\n\n\t\ttry {\n\t\t\tconst doc = await vscode.workspace.openTextDocument(vscode.Uri.file(this.serverState.server.tsServerLogFile));\n\t\t\tawait vscode.window.showTextDocument(doc);\n\t\t\treturn true;\n\t\t} catch {\n\t\t\t// noop\n\t\t}\n\n\t\ttry {\n\t\t\tawait vscode.commands.executeCommand('revealFileInOS', vscode.Uri.file(this.serverState.server.tsServerLogFile));\n\t\t\treturn true;\n\t\t} catch {\n\t\t\tvscode.window.showWarningMessage(localize(\n\t\t\t\t'openTsServerLog.openFileFailedFailed',\n\t\t\t\t'Could not open TS Server log file'));\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tprivate serviceStarted(resendModels: boolean): void {\n\t\tthis.bufferSyncSupport.reset();\n\n\t\tconst watchOptions = this.apiVersion.gte(API.v380)\n\t\t\t? this.configuration.watchOptions\n\t\t\t: undefined;\n\n\t\tconst configureOptions: Proto.ConfigureRequestArguments = {\n\t\t\thostInfo: 'vscode',\n\t\t\tpreferences: {\n\t\t\t\tprovidePrefixAndSuffixTextForRename: true,\n\t\t\t\tallowRenameOfImportPath: true,\n\t\t\t\tincludePackageJsonAutoImports: this._configuration.includePackageJsonAutoImports,\n\t\t\t},\n\t\t\twatchOptions\n\t\t};\n\t\tthis.executeWithoutWaitingForResponse('configure', configureOptions);\n\t\tthis.setCompilerOptionsForInferredProjects(this._configuration);\n\t\tif (resendModels) {\n\t\t\tthis._onResendModelsRequested.fire();\n\t\t\tthis.bufferSyncSupport.reinitialize();\n\t\t\tthis.bufferSyncSupport.requestAllDiagnostics();\n\t\t}\n\n\t\t// Reconfigure any plugins\n\t\tfor (const [config, pluginName] of this.pluginManager.configurations()) {\n\t\t\tthis.configurePlugin(config, pluginName);\n\t\t}\n\t}\n\n\tprivate setCompilerOptionsForInferredProjects(configuration: TypeScriptServiceConfiguration): void {\n\t\tconst args: Proto.SetCompilerOptionsForInferredProjectsArgs = {\n\t\t\toptions: this.getCompilerOptionsForInferredProjects(configuration)\n\t\t};\n\t\tthis.executeWithoutWaitingForResponse('compilerOptionsForInferredProjects', args);\n\t}\n\n\tprivate getCompilerOptionsForInferredProjects(configuration: TypeScriptServiceConfiguration): Proto.ExternalProjectCompilerOptions {\n\t\treturn {\n\t\t\t...inferredProjectCompilerOptions(ProjectType.TypeScript, configuration),\n\t\t\tallowJs: true,\n\t\t\tallowSyntheticDefaultImports: true,\n\t\t\tallowNonTsExtensions: true,\n\t\t\tresolveJsonModule: true,\n\t\t};\n\t}\n\n\tprivate serviceExited(restart: boolean): void {\n\t\tthis.loadingIndicator.reset();\n\n\t\tconst previousState = this.serverState;\n\t\tthis.serverState = ServerState.None;\n\n\t\tif (restart) {\n\t\t\tconst diff = Date.now() - this.lastStart;\n\t\t\tthis.numberRestarts++;\n\t\t\tlet startService = true;\n\n\t\t\tconst reportIssueItem: vscode.MessageItem = {\n\t\t\t\ttitle: localize('serverDiedReportIssue', 'Report Issue'),\n\t\t\t};\n\t\t\tlet prompt: Thenable<undefined | vscode.MessageItem> | undefined = undefined;\n\n\t\t\tif (this.numberRestarts > 5) {\n\t\t\t\tthis.numberRestarts = 0;\n\t\t\t\tif (diff < 10 * 1000 /* 10 seconds */) {\n\t\t\t\t\tthis.lastStart = Date.now();\n\t\t\t\t\tstartService = false;\n\t\t\t\t\tthis.hasServerFatallyCrashedTooManyTimes = true;\n\t\t\t\t\tprompt = vscode.window.showErrorMessage(\n\t\t\t\t\t\tlocalize('serverDiedAfterStart', 'The TypeScript language service died 5 times right after it got started. The service will not be restarted.'),\n\t\t\t\t\t\treportIssueItem);\n\n\t\t\t\t\t/* __GDPR__\n\t\t\t\t\t\t\"serviceExited\" : {\n\t\t\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t*/\n\t\t\t\t\tthis.logTelemetry('serviceExited');\n\t\t\t\t} else if (diff < 60 * 1000 * 5 /* 5 Minutes */) {\n\t\t\t\t\tthis.lastStart = Date.now();\n\t\t\t\t\tprompt = vscode.window.showWarningMessage(\n\t\t\t\t\t\tlocalize('serverDied', 'The TypeScript language service died unexpectedly 5 times in the last 5 Minutes.'),\n\t\t\t\t\t\treportIssueItem);\n\t\t\t\t}\n\t\t\t} else if (['vscode-insiders', 'code-oss'].includes(vscode.env.uriScheme)) {\n\t\t\t\t// Prompt after a single restart\n\t\t\t\tif (!this._isPromptingAfterCrash && previousState.type === ServerState.Type.Errored && previousState.error instanceof TypeScriptServerError) {\n\t\t\t\t\tthis.numberRestarts = 0;\n\t\t\t\t\tthis._isPromptingAfterCrash = true;\n\t\t\t\t\tprompt = vscode.window.showWarningMessage(\n\t\t\t\t\t\tlocalize('serverDiedOnce', 'The TypeScript language service died unexpectedly.'),\n\t\t\t\t\t\treportIssueItem);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tprompt?.then(item => {\n\t\t\t\tthis._isPromptingAfterCrash = false;\n\n\t\t\t\tif (item === reportIssueItem) {\n\t\t\t\t\tconst minModernTsVersion = this.versionProvider.bundledVersion.apiVersion;\n\n\t\t\t\t\tif (minModernTsVersion && this.apiVersion.lt(minModernTsVersion)) {\n\t\t\t\t\t\tvscode.window.showWarningMessage(\n\t\t\t\t\t\t\tlocalize('usingOldTsVersion.title', 'Please update your TypeScript version'),\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmodal: true,\n\t\t\t\t\t\t\t\tdetail: localize(\n\t\t\t\t\t\t\t\t\t'usingOldTsVersion.detail',\n\t\t\t\t\t\t\t\t\t'The workspace is using an old version of TypeScript ({0}).\\n\\nBefore reporting an issue, please update the workspace to use the latest stable TypeScript release to make sure the bug has not already been fixed.',\n\t\t\t\t\t\t\t\t\tpreviousState.type === ServerState.Type.Errored && previousState.error instanceof TypeScriptServerError ? previousState.error.version.apiVersion?.displayName : undefined),\n\t\t\t\t\t\t\t\tuseCustom: true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst args = previousState.type === ServerState.Type.Errored && previousState.error instanceof TypeScriptServerError\n\t\t\t\t\t\t\t? getReportIssueArgsForError(previousState.error, previousState.tsServerLogFile)\n\t\t\t\t\t\t\t: undefined;\n\t\t\t\t\t\tvscode.commands.executeCommand('workbench.action.openIssueReporter', args);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (startService) {\n\t\t\t\tthis.startService(true);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic normalizedPath(resource: vscode.Uri): string | undefined {\n\t\tif (fileSchemes.disabledSchemes.has(resource.scheme)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tswitch (resource.scheme) {\n\t\t\tcase fileSchemes.file:\n\t\t\t\t{\n\t\t\t\t\tlet result = resource.fsPath;\n\t\t\t\t\tif (!result) {\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t}\n\t\t\t\t\tresult = path.normalize(result);\n\n\t\t\t\t\t// Both \\ and / must be escaped in regular expressions\n\t\t\t\t\treturn result.replace(new RegExp('\\\\' + this.pathSeparator, 'g'), '/');\n\t\t\t\t}\n\t\t\tdefault:\n\t\t\t\t{\n\t\t\t\t\treturn this.inMemoryResourcePrefix + '/' + resource.scheme\n\t\t\t\t\t\t+ (resource.path.startsWith('/') ? resource.path : '/' + resource.path)\n\t\t\t\t\t\t+ (resource.fragment ? '#' + resource.fragment : '');\n\t\t\t\t}\n\t\t}\n\t}\n\n\tpublic toPath(resource: vscode.Uri): string | undefined {\n\t\treturn this.normalizedPath(resource);\n\t}\n\n\tpublic toOpenedFilePath(document: vscode.TextDocument, options: { suppressAlertOnFailure?: boolean } = {}): string | undefined {\n\t\tif (!this.bufferSyncSupport.ensureHasBuffer(document.uri)) {\n\t\t\tif (!options.suppressAlertOnFailure && !fileSchemes.disabledSchemes.has(document.uri.scheme)) {\n\t\t\t\tconsole.error(`Unexpected resource ${document.uri}`);\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}\n\t\treturn this.toPath(document.uri);\n\t}\n\n\tpublic hasCapabilityForResource(resource: vscode.Uri, capability: ClientCapability): boolean {\n\t\tif (!this.capabilities.has(capability)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tswitch (capability) {\n\t\t\tcase ClientCapability.Semantic:\n\t\t\t\t{\n\t\t\t\t\treturn fileSchemes.semanticSupportedSchemes.includes(resource.scheme);\n\t\t\t\t}\n\t\t\tcase ClientCapability.Syntax:\n\t\t\tcase ClientCapability.EnhancedSyntax:\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t}\n\t}\n\n\tpublic toResource(filepath: string): vscode.Uri {\n\t\tif (isWeb()) {\n\t\t\t// On web, the stdlib paths that TS return look like: '/lib.es2015.collection.d.ts'\n\t\t\tif (filepath.startsWith('/lib.') && filepath.endsWith('.d.ts')) {\n\t\t\t\treturn vscode.Uri.joinPath(this.context.extensionUri, 'dist', 'browser', 'typescript', filepath.slice(1));\n\t\t\t}\n\t\t}\n\n\t\tif (filepath.startsWith(this.inMemoryResourcePrefix)) {\n\t\t\tconst parts = filepath.match(/^\\^\\/([^\\/]+)\\/(.+)$/);\n\t\t\tif (parts) {\n\t\t\t\tconst resource = vscode.Uri.parse(parts[1] + ':' + parts[2]);\n\t\t\t\treturn this.bufferSyncSupport.toVsCodeResource(resource);\n\t\t\t}\n\t\t}\n\t\treturn this.bufferSyncSupport.toResource(filepath);\n\t}\n\n\tpublic getWorkspaceRootForResource(resource: vscode.Uri): string | undefined {\n\t\tconst roots = vscode.workspace.workspaceFolders ? Array.from(vscode.workspace.workspaceFolders) : undefined;\n\t\tif (!roots || !roots.length) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tswitch (resource.scheme) {\n\t\t\tcase fileSchemes.file:\n\t\t\tcase fileSchemes.untitled:\n\t\t\tcase fileSchemes.vscodeNotebookCell:\n\t\t\tcase fileSchemes.memFs:\n\t\t\tcase fileSchemes.vscodeVfs:\n\t\t\t\tfor (const root of roots.sort((a, b) => a.uri.fsPath.length - b.uri.fsPath.length)) {\n\t\t\t\t\tif (resource.fsPath.startsWith(root.uri.fsPath + path.sep)) {\n\t\t\t\t\t\treturn root.uri.fsPath;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn roots[0].uri.fsPath;\n\n\t\t\tdefault:\n\t\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tpublic execute(command: keyof TypeScriptRequests, args: any, token: vscode.CancellationToken, config?: ExecConfig): Promise<ServerResponse.Response<Proto.Response>> {\n\t\tlet executions: Array<Promise<ServerResponse.Response<Proto.Response>> | undefined>;\n\n\t\tif (config?.cancelOnResourceChange) {\n\t\t\tconst runningServerState = this.service();\n\n\t\t\tconst source = new vscode.CancellationTokenSource();\n\t\t\ttoken.onCancellationRequested(() => source.cancel());\n\n\t\t\tconst inFlight: ToCancelOnResourceChanged = {\n\t\t\t\tresource: config.cancelOnResourceChange,\n\t\t\t\tcancel: () => source.cancel(),\n\t\t\t};\n\t\t\trunningServerState.toCancelOnResourceChange.add(inFlight);\n\n\t\t\texecutions = this.executeImpl(command, args, {\n\t\t\t\tisAsync: false,\n\t\t\t\ttoken: source.token,\n\t\t\t\texpectsResult: true,\n\t\t\t\t...config,\n\t\t\t});\n\t\t\texecutions[0]!.finally(() => {\n\t\t\t\trunningServerState.toCancelOnResourceChange.delete(inFlight);\n\t\t\t\tsource.dispose();\n\t\t\t});\n\t\t} else {\n\t\t\texecutions = this.executeImpl(command, args, {\n\t\t\t\tisAsync: false,\n\t\t\t\ttoken,\n\t\t\t\texpectsResult: true,\n\t\t\t\t...config,\n\t\t\t});\n\t\t}\n\n\t\tif (config?.nonRecoverable) {\n\t\t\texecutions[0]!.catch(err => this.fatalError(command, err));\n\t\t}\n\n\t\tif (command === 'updateOpen') {\n\t\t\t// If update open has completed, consider that the project has loaded\n\t\t\tPromise.all(executions).then(() => {\n\t\t\t\tthis.loadingIndicator.reset();\n\t\t\t});\n\t\t}\n\n\t\treturn executions[0]!;\n\t}\n\n\tpublic executeWithoutWaitingForResponse(command: keyof TypeScriptRequests, args: any): void {\n\t\tthis.executeImpl(command, args, {\n\t\t\tisAsync: false,\n\t\t\ttoken: undefined,\n\t\t\texpectsResult: false\n\t\t});\n\t}\n\n\tpublic executeAsync(command: keyof TypeScriptRequests, args: Proto.GeterrRequestArgs, token: vscode.CancellationToken): Promise<ServerResponse.Response<Proto.Response>> {\n\t\treturn this.executeImpl(command, args, {\n\t\t\tisAsync: true,\n\t\t\ttoken,\n\t\t\texpectsResult: true\n\t\t})[0]!;\n\t}\n\n\tprivate executeImpl(command: keyof TypeScriptRequests, args: any, executeInfo: { isAsync: boolean, token?: vscode.CancellationToken, expectsResult: boolean, lowPriority?: boolean, requireSemantic?: boolean }): Array<Promise<ServerResponse.Response<Proto.Response>> | undefined> {\n\t\tthis.bufferSyncSupport.beforeCommand(command);\n\t\tconst runningServerState = this.service();\n\t\treturn runningServerState.server.executeImpl(command, args, executeInfo);\n\t}\n\n\tpublic interruptGetErr<R>(f: () => R): R {\n\t\treturn this.bufferSyncSupport.interruptGetErr(f);\n\t}\n\n\tprivate fatalError(command: string, error: unknown): void {\n\t\t/* __GDPR__\n\t\t\t\"fatalError\" : {\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${TypeScriptCommonProperties}\",\n\t\t\t\t\t\"${TypeScriptRequestErrorProperties}\"\n\t\t\t\t],\n\t\t\t\t\"command\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n\t\t\t}\n\t\t*/\n\t\tthis.logTelemetry('fatalError', { ...(error instanceof TypeScriptServerError ? error.telemetry : { command }) });\n\t\tconsole.error(`A non-recoverable error occurred while executing tsserver command: ${command}`);\n\t\tif (error instanceof TypeScriptServerError && error.serverErrorText) {\n\t\t\tconsole.error(error.serverErrorText);\n\t\t}\n\n\t\tif (this.serverState.type === ServerState.Type.Running) {\n\t\t\tthis.info('Killing TS Server');\n\t\t\tconst logfile = this.serverState.server.tsServerLogFile;\n\t\t\tthis.serverState.server.kill();\n\t\t\tif (error instanceof TypeScriptServerError) {\n\t\t\t\tthis.serverState = new ServerState.Errored(error, logfile);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate dispatchEvent(event: Proto.Event) {\n\t\tswitch (event.event) {\n\t\t\tcase EventName.syntaxDiag:\n\t\t\tcase EventName.semanticDiag:\n\t\t\tcase EventName.suggestionDiag:\n\t\t\t\t// This event also roughly signals that projects have been loaded successfully (since the TS server is synchronous)\n\t\t\t\tthis.loadingIndicator.reset();\n\n\t\t\t\tconst diagnosticEvent = event as Proto.DiagnosticEvent;\n\t\t\t\tif (diagnosticEvent.body && diagnosticEvent.body.diagnostics) {\n\t\t\t\t\tthis._onDiagnosticsReceived.fire({\n\t\t\t\t\t\tkind: getDignosticsKind(event),\n\t\t\t\t\t\tresource: this.toResource(diagnosticEvent.body.file),\n\t\t\t\t\t\tdiagnostics: diagnosticEvent.body.diagnostics\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase EventName.configFileDiag:\n\t\t\t\tthis._onConfigDiagnosticsReceived.fire(event as Proto.ConfigFileDiagnosticEvent);\n\t\t\t\tbreak;\n\n\t\t\tcase EventName.telemetry:\n\t\t\t\t{\n\t\t\t\t\tconst body = (event as Proto.TelemetryEvent).body;\n\t\t\t\t\tthis.dispatchTelemetryEvent(body);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tcase EventName.projectLanguageServiceState:\n\t\t\t\t{\n\t\t\t\t\tconst body = (event as Proto.ProjectLanguageServiceStateEvent).body!;\n\t\t\t\t\tif (this.serverState.type === ServerState.Type.Running) {\n\t\t\t\t\t\tthis.serverState.updateLanguageServiceEnabled(body.languageServiceEnabled);\n\t\t\t\t\t}\n\t\t\t\t\tthis._onProjectLanguageServiceStateChanged.fire(body);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tcase EventName.projectsUpdatedInBackground:\n\t\t\t\tthis.loadingIndicator.reset();\n\n\t\t\t\tconst body = (event as Proto.ProjectsUpdatedInBackgroundEvent).body;\n\t\t\t\tconst resources = body.openFiles.map(file => this.toResource(file));\n\t\t\t\tthis.bufferSyncSupport.getErr(resources);\n\t\t\t\tbreak;\n\n\t\t\tcase EventName.beginInstallTypes:\n\t\t\t\tthis._onDidBeginInstallTypings.fire((event as Proto.BeginInstallTypesEvent).body);\n\t\t\t\tbreak;\n\n\t\t\tcase EventName.endInstallTypes:\n\t\t\t\tthis._onDidEndInstallTypings.fire((event as Proto.EndInstallTypesEvent).body);\n\t\t\t\tbreak;\n\n\t\t\tcase EventName.typesInstallerInitializationFailed:\n\t\t\t\tthis._onTypesInstallerInitializationFailed.fire((event as Proto.TypesInstallerInitializationFailedEvent).body);\n\t\t\t\tbreak;\n\n\t\t\tcase EventName.surveyReady:\n\t\t\t\tthis._onSurveyReady.fire((event as Proto.SurveyReadyEvent).body);\n\t\t\t\tbreak;\n\n\t\t\tcase EventName.projectLoadingStart:\n\t\t\t\tthis.loadingIndicator.startedLoadingProject((event as Proto.ProjectLoadingStartEvent).body.projectName);\n\t\t\t\tbreak;\n\n\t\t\tcase EventName.projectLoadingFinish:\n\t\t\t\tthis.loadingIndicator.finishedLoadingProject((event as Proto.ProjectLoadingFinishEvent).body.projectName);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate dispatchTelemetryEvent(telemetryData: Proto.TelemetryEventBody): void {\n\t\tconst properties: { [key: string]: string } = Object.create(null);\n\t\tswitch (telemetryData.telemetryEventName) {\n\t\t\tcase 'typingsInstalled':\n\t\t\t\tconst typingsInstalledPayload: Proto.TypingsInstalledTelemetryEventPayload = (telemetryData.payload as Proto.TypingsInstalledTelemetryEventPayload);\n\t\t\t\tproperties['installedPackages'] = typingsInstalledPayload.installedPackages;\n\n\t\t\t\tif (typeof typingsInstalledPayload.installSuccess === 'boolean') {\n\t\t\t\t\tproperties['installSuccess'] = typingsInstalledPayload.installSuccess.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof typingsInstalledPayload.typingsInstallerVersion === 'string') {\n\t\t\t\t\tproperties['typingsInstallerVersion'] = typingsInstalledPayload.typingsInstallerVersion;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconst payload = telemetryData.payload;\n\t\t\t\tif (payload) {\n\t\t\t\t\tObject.keys(payload).forEach((key) => {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (payload.hasOwnProperty(key)) {\n\t\t\t\t\t\t\t\tproperties[key] = typeof payload[key] === 'string' ? payload[key] : JSON.stringify(payload[key]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t// noop\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t\tif (telemetryData.telemetryEventName === 'projectInfo') {\n\t\t\tif (this.serverState.type === ServerState.Type.Running) {\n\t\t\t\tthis.serverState.updateTsserverVersion(properties['version']);\n\t\t\t}\n\t\t}\n\n\t\t/* __GDPR__\n\t\t\t\"typingsInstalled\" : {\n\t\t\t\t\"installedPackages\" : { \"classification\": \"PublicNonPersonalData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"installSuccess\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\t\t\"typingsInstallerVersion\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t]\n\t\t\t}\n\t\t*/\n\t\t// __GDPR__COMMENT__: Other events are defined by TypeScript.\n\t\tthis.logTelemetry(telemetryData.telemetryEventName, properties);\n\t}\n\n\tprivate configurePlugin(pluginName: string, configuration: {}): any {\n\t\tif (this.apiVersion.gte(API.v314)) {\n\t\t\tthis.executeWithoutWaitingForResponse('configurePlugin', { pluginName, configuration });\n\t\t}\n\t}\n}\n\nfunction getReportIssueArgsForError(\n\terror: TypeScriptServerError,\n\tlogPath: string | undefined,\n): { extensionId: string, issueTitle: string, issueBody: string } | undefined {\n\tif (!error.serverStack || !error.serverMessage) {\n\t\treturn undefined;\n\t}\n\n\t// Note these strings are intentionally not localized\n\t// as we want users to file issues in english\n\n\tconst sections = [\n\t\t` Please fill in the sections below to help us diagnose the issue `,\n\t\t`**TypeScript Version:** ${error.version.apiVersion?.fullVersionString}`,\n\t\t`**Steps to reproduce crash**\n\n1.\n2.\n3.`,\n\t];\n\n\tif (logPath) {\n\t\tsections.push(`**TS Server Log**\n\n Please review and upload this log file to help us diagnose this crash:\n\n\\`${logPath}\\`\n\nThe log file may contain personal data, including full paths and source code from your workspace. You can scrub the log file to remove paths or other personal information.\n`);\n\t} else {\n\n\t\tsections.push(`**TS Server Log**\n\nServer logging disabled. To help us fix crashes like this, please enable logging by setting:\n\n\\`\\`\\`json\n\"typescript.tsserver.log\": \"verbose\"\n\\`\\`\\`\n\nAfter enabling this setting, future crash reports will include the server log.`);\n\t}\n\n\tsections.push(`**TS Server Error Stack**\n\nServer: \\`${error.serverId}\\`\n\n\\`\\`\\`\n${error.serverStack}\n\\`\\`\\``);\n\n\treturn {\n\t\textensionId: 'vscode.typescript-language-features',\n\t\tissueTitle: `TS Server fatal error:  ${error.serverMessage}`,\n\n\t\tissueBody: sections.join('\\n\\n')\n\t};\n}\n\nfunction getDignosticsKind(event: Proto.Event) {\n\tswitch (event.event) {\n\t\tcase 'syntaxDiag': return DiagnosticKind.Syntax;\n\t\tcase 'semanticDiag': return DiagnosticKind.Semantic;\n\t\tcase 'suggestionDiag': return DiagnosticKind.Suggestion;\n\t}\n\tthrow new Error('Unknown dignostics kind');\n}\n\nclass ServerInitializingIndicator extends Disposable {\n\tprivate _task?: { project: string | undefined, resolve: () => void, reject: () => void };\n\n\tpublic reset(): void {\n\t\tif (this._task) {\n\t\t\tthis._task.reject();\n\t\t\tthis._task = undefined;\n\t\t}\n\t}\n\n\t/**\n\t * Signal that a project has started loading.\n\t */\n\tpublic startedLoadingProject(projectName: string | undefined): void {\n\t\t// TS projects are loaded sequentially. Cancel existing task because it should always be resolved before\n\t\t// the incoming project loading task is.\n\t\tthis.reset();\n\n\t\tvscode.window.withProgress({\n\t\t\tlocation: vscode.ProgressLocation.Window,\n\t\t\ttitle: localize('serverLoading.progress', \"Initializing JS/TS language features\"),\n\t\t}, () => new Promise<void>((resolve, reject) => {\n\t\t\tthis._task = { project: projectName, resolve, reject };\n\t\t}));\n\t}\n\n\tpublic finishedLoadingProject(projectName: string | undefined): void {\n\t\tif (this._task && this._task.project === projectName) {\n\t\t\tthis._task.resolve();\n\t\t\tthis._task = undefined;\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as arrays from '../utils/arrays';\nimport { Disposable } from '../utils/dispose';\nimport { DiagnosticLanguage } from '../utils/languageDescription';\nimport { ResourceMap } from '../utils/resourceMap';\n\nfunction diagnosticsEquals(a: vscode.Diagnostic, b: vscode.Diagnostic): boolean {\n\tif (a === b) {\n\t\treturn true;\n\t}\n\n\treturn a.code === b.code\n\t\t&& a.message === b.message\n\t\t&& a.severity === b.severity\n\t\t&& a.source === b.source\n\t\t&& a.range.isEqual(b.range)\n\t\t&& arrays.equals(a.relatedInformation || arrays.empty, b.relatedInformation || arrays.empty, (a, b) => {\n\t\t\treturn a.message === b.message\n\t\t\t\t&& a.location.range.isEqual(b.location.range)\n\t\t\t\t&& a.location.uri.fsPath === b.location.uri.fsPath;\n\t\t})\n\t\t&& arrays.equals(a.tags || arrays.empty, b.tags || arrays.empty);\n}\n\nexport const enum DiagnosticKind {\n\tSyntax,\n\tSemantic,\n\tSuggestion,\n}\n\nclass FileDiagnostics {\n\tprivate readonly _diagnostics = new Map<DiagnosticKind, ReadonlyArray<vscode.Diagnostic>>();\n\n\tconstructor(\n\t\tpublic readonly file: vscode.Uri,\n\t\tpublic language: DiagnosticLanguage\n\t) { }\n\n\tpublic updateDiagnostics(\n\t\tlanguage: DiagnosticLanguage,\n\t\tkind: DiagnosticKind,\n\t\tdiagnostics: ReadonlyArray<vscode.Diagnostic>\n\t): boolean {\n\t\tif (language !== this.language) {\n\t\t\tthis._diagnostics.clear();\n\t\t\tthis.language = language;\n\t\t}\n\n\t\tconst existing = this._diagnostics.get(kind);\n\t\tif (arrays.equals(existing || arrays.empty, diagnostics, diagnosticsEquals)) {\n\t\t\t// No need to update\n\t\t\treturn false;\n\t\t}\n\n\t\tthis._diagnostics.set(kind, diagnostics);\n\t\treturn true;\n\t}\n\n\tpublic getDiagnostics(settings: DiagnosticSettings): vscode.Diagnostic[] {\n\t\tif (!settings.getValidate(this.language)) {\n\t\t\treturn [];\n\t\t}\n\n\t\treturn [\n\t\t\t...this.get(DiagnosticKind.Syntax),\n\t\t\t...this.get(DiagnosticKind.Semantic),\n\t\t\t...this.getSuggestionDiagnostics(settings),\n\t\t];\n\t}\n\n\tprivate getSuggestionDiagnostics(settings: DiagnosticSettings) {\n\t\tconst enableSuggestions = settings.getEnableSuggestions(this.language);\n\t\treturn this.get(DiagnosticKind.Suggestion).filter(x => {\n\t\t\tif (!enableSuggestions) {\n\t\t\t\t// Still show unused\n\t\t\t\treturn x.tags && (x.tags.includes(vscode.DiagnosticTag.Unnecessary) || x.tags.includes(vscode.DiagnosticTag.Deprecated));\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t}\n\n\tprivate get(kind: DiagnosticKind): ReadonlyArray<vscode.Diagnostic> {\n\t\treturn this._diagnostics.get(kind) || [];\n\t}\n}\n\ninterface LanguageDiagnosticSettings {\n\treadonly validate: boolean;\n\treadonly enableSuggestions: boolean;\n}\n\nfunction areLanguageDiagnosticSettingsEqual(currentSettings: LanguageDiagnosticSettings, newSettings: LanguageDiagnosticSettings): boolean {\n\treturn currentSettings.validate === newSettings.validate\n\t\t&& currentSettings.enableSuggestions && currentSettings.enableSuggestions;\n}\n\nclass DiagnosticSettings {\n\tprivate static readonly defaultSettings: LanguageDiagnosticSettings = {\n\t\tvalidate: true,\n\t\tenableSuggestions: true\n\t};\n\n\tprivate readonly _languageSettings = new Map<DiagnosticLanguage, LanguageDiagnosticSettings>();\n\n\tpublic getValidate(language: DiagnosticLanguage): boolean {\n\t\treturn this.get(language).validate;\n\t}\n\n\tpublic setValidate(language: DiagnosticLanguage, value: boolean): boolean {\n\t\treturn this.update(language, settings => ({\n\t\t\tvalidate: value,\n\t\t\tenableSuggestions: settings.enableSuggestions,\n\t\t}));\n\t}\n\n\tpublic getEnableSuggestions(language: DiagnosticLanguage): boolean {\n\t\treturn this.get(language).enableSuggestions;\n\t}\n\n\tpublic setEnableSuggestions(language: DiagnosticLanguage, value: boolean): boolean {\n\t\treturn this.update(language, settings => ({\n\t\t\tvalidate: settings.validate,\n\t\t\tenableSuggestions: value\n\t\t}));\n\t}\n\n\tprivate get(language: DiagnosticLanguage): LanguageDiagnosticSettings {\n\t\treturn this._languageSettings.get(language) || DiagnosticSettings.defaultSettings;\n\t}\n\n\tprivate update(language: DiagnosticLanguage, f: (x: LanguageDiagnosticSettings) => LanguageDiagnosticSettings): boolean {\n\t\tconst currentSettings = this.get(language);\n\t\tconst newSettings = f(currentSettings);\n\t\tthis._languageSettings.set(language, newSettings);\n\t\treturn !areLanguageDiagnosticSettingsEqual(currentSettings, newSettings);\n\t}\n}\n\nexport class DiagnosticsManager extends Disposable {\n\tprivate readonly _diagnostics: ResourceMap<FileDiagnostics>;\n\tprivate readonly _settings = new DiagnosticSettings();\n\tprivate readonly _currentDiagnostics: vscode.DiagnosticCollection;\n\tprivate readonly _pendingUpdates: ResourceMap<any>;\n\n\tprivate readonly _updateDelay = 50;\n\n\tconstructor(\n\t\towner: string,\n\t\tonCaseInsensitiveFileSystem: boolean\n\t) {\n\t\tsuper();\n\t\tthis._diagnostics = new ResourceMap<FileDiagnostics>(undefined, { onCaseInsensitiveFileSystem });\n\t\tthis._pendingUpdates = new ResourceMap<any>(undefined, { onCaseInsensitiveFileSystem });\n\n\t\tthis._currentDiagnostics = this._register(vscode.languages.createDiagnosticCollection(owner));\n\t}\n\n\tpublic override dispose() {\n\t\tsuper.dispose();\n\n\t\tfor (const value of this._pendingUpdates.values) {\n\t\t\tclearTimeout(value);\n\t\t}\n\t\tthis._pendingUpdates.clear();\n\t}\n\n\tpublic reInitialize(): void {\n\t\tthis._currentDiagnostics.clear();\n\t\tthis._diagnostics.clear();\n\t}\n\n\tpublic setValidate(language: DiagnosticLanguage, value: boolean) {\n\t\tconst didUpdate = this._settings.setValidate(language, value);\n\t\tif (didUpdate) {\n\t\t\tthis.rebuild();\n\t\t}\n\t}\n\n\tpublic setEnableSuggestions(language: DiagnosticLanguage, value: boolean) {\n\t\tconst didUpdate = this._settings.setEnableSuggestions(language, value);\n\t\tif (didUpdate) {\n\t\t\tthis.rebuild();\n\t\t}\n\t}\n\n\tpublic updateDiagnostics(\n\t\tfile: vscode.Uri,\n\t\tlanguage: DiagnosticLanguage,\n\t\tkind: DiagnosticKind,\n\t\tdiagnostics: ReadonlyArray<vscode.Diagnostic>\n\t): void {\n\t\tlet didUpdate = false;\n\t\tconst entry = this._diagnostics.get(file);\n\t\tif (entry) {\n\t\t\tdidUpdate = entry.updateDiagnostics(language, kind, diagnostics);\n\t\t} else if (diagnostics.length) {\n\t\t\tconst fileDiagnostics = new FileDiagnostics(file, language);\n\t\t\tfileDiagnostics.updateDiagnostics(language, kind, diagnostics);\n\t\t\tthis._diagnostics.set(file, fileDiagnostics);\n\t\t\tdidUpdate = true;\n\t\t}\n\n\t\tif (didUpdate) {\n\t\t\tthis.scheduleDiagnosticsUpdate(file);\n\t\t}\n\t}\n\n\tpublic configFileDiagnosticsReceived(\n\t\tfile: vscode.Uri,\n\t\tdiagnostics: ReadonlyArray<vscode.Diagnostic>\n\t): void {\n\t\tthis._currentDiagnostics.set(file, diagnostics);\n\t}\n\n\tpublic delete(resource: vscode.Uri): void {\n\t\tthis._currentDiagnostics.delete(resource);\n\t\tthis._diagnostics.delete(resource);\n\t}\n\n\tpublic getDiagnostics(file: vscode.Uri): ReadonlyArray<vscode.Diagnostic> {\n\t\treturn this._currentDiagnostics.get(file) || [];\n\t}\n\n\tprivate scheduleDiagnosticsUpdate(file: vscode.Uri) {\n\t\tif (!this._pendingUpdates.has(file)) {\n\t\t\tthis._pendingUpdates.set(file, setTimeout(() => this.updateCurrentDiagnostics(file), this._updateDelay));\n\t\t}\n\t}\n\n\tprivate updateCurrentDiagnostics(file: vscode.Uri): void {\n\t\tif (this._pendingUpdates.has(file)) {\n\t\t\tclearTimeout(this._pendingUpdates.get(file));\n\t\t\tthis._pendingUpdates.delete(file);\n\t\t}\n\n\t\tconst fileDiagnostics = this._diagnostics.get(file);\n\t\tthis._currentDiagnostics.set(file, fileDiagnostics ? fileDiagnostics.getDiagnostics(this._settings) : []);\n\t}\n\n\tprivate rebuild(): void {\n\t\tthis._currentDiagnostics.clear();\n\t\tfor (const fileDiagnostic of this._diagnostics.values) {\n\t\t\tthis._currentDiagnostics.set(fileDiagnostic.file, fileDiagnostic.getDiagnostics(this._settings));\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../protocol';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport API from '../utils/api';\nimport { coalesce } from '../utils/arrays';\nimport { Delayer, setImmediate } from '../utils/async';\nimport { nulToken } from '../utils/cancellation';\nimport { Disposable } from '../utils/dispose';\nimport * as languageModeIds from '../utils/languageModeIds';\nimport { ResourceMap } from '../utils/resourceMap';\nimport * as typeConverters from '../utils/typeConverters';\n\nconst enum BufferKind {\n\tTypeScript = 1,\n\tJavaScript = 2,\n}\n\nconst enum BufferState {\n\tInitial = 1,\n\tOpen = 2,\n\tClosed = 2,\n}\n\nfunction mode2ScriptKind(mode: string): 'TS' | 'TSX' | 'JS' | 'JSX' | undefined {\n\tswitch (mode) {\n\t\tcase languageModeIds.typescript: return 'TS';\n\t\tcase languageModeIds.typescriptreact: return 'TSX';\n\t\tcase languageModeIds.javascript: return 'JS';\n\t\tcase languageModeIds.javascriptreact: return 'JSX';\n\t}\n\treturn undefined;\n}\n\nconst enum BufferOperationType { Close, Open, Change }\n\nclass CloseOperation {\n\treadonly type = BufferOperationType.Close;\n\tconstructor(\n\t\tpublic readonly args: string\n\t) { }\n}\n\nclass OpenOperation {\n\treadonly type = BufferOperationType.Open;\n\tconstructor(\n\t\tpublic readonly args: Proto.OpenRequestArgs\n\t) { }\n}\n\nclass ChangeOperation {\n\treadonly type = BufferOperationType.Change;\n\tconstructor(\n\t\tpublic readonly args: Proto.FileCodeEdits\n\t) { }\n}\n\ntype BufferOperation = CloseOperation | OpenOperation | ChangeOperation;\n\n/**\n * Manages synchronization of buffers with the TS server.\n *\n * If supported, batches together file changes. This allows the TS server to more efficiently process changes.\n */\nclass BufferSynchronizer {\n\n\tprivate readonly _pending: ResourceMap<BufferOperation>;\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tpathNormalizer: (path: vscode.Uri) => string | undefined,\n\t\tonCaseInsensitiveFileSystem: boolean\n\t) {\n\t\tthis._pending = new ResourceMap<BufferOperation>(pathNormalizer, {\n\t\t\tonCaseInsensitiveFileSystem\n\t\t});\n\t}\n\n\tpublic open(resource: vscode.Uri, args: Proto.OpenRequestArgs) {\n\t\tif (this.supportsBatching) {\n\t\t\tthis.updatePending(resource, new OpenOperation(args));\n\t\t} else {\n\t\t\tthis.client.executeWithoutWaitingForResponse('open', args);\n\t\t}\n\t}\n\n\t/**\n\t * @return Was the buffer open?\n\t */\n\tpublic close(resource: vscode.Uri, filepath: string): boolean {\n\t\tif (this.supportsBatching) {\n\t\t\treturn this.updatePending(resource, new CloseOperation(filepath));\n\t\t} else {\n\t\t\tconst args: Proto.FileRequestArgs = { file: filepath };\n\t\t\tthis.client.executeWithoutWaitingForResponse('close', args);\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tpublic change(resource: vscode.Uri, filepath: string, events: readonly vscode.TextDocumentContentChangeEvent[]) {\n\t\tif (!events.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.supportsBatching) {\n\t\t\tthis.updatePending(resource, new ChangeOperation({\n\t\t\t\tfileName: filepath,\n\t\t\t\ttextChanges: events.map((change): Proto.CodeEdit => ({\n\t\t\t\t\tnewText: change.text,\n\t\t\t\t\tstart: typeConverters.Position.toLocation(change.range.start),\n\t\t\t\t\tend: typeConverters.Position.toLocation(change.range.end),\n\t\t\t\t})).reverse(), // Send the edits end-of-document to start-of-document order\n\t\t\t}));\n\t\t} else {\n\t\t\tfor (const { range, text } of events) {\n\t\t\t\tconst args: Proto.ChangeRequestArgs = {\n\t\t\t\t\tinsertString: text,\n\t\t\t\t\t...typeConverters.Range.toFormattingRequestArgs(filepath, range)\n\t\t\t\t};\n\t\t\t\tthis.client.executeWithoutWaitingForResponse('change', args);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic reset(): void {\n\t\tthis._pending.clear();\n\t}\n\n\tpublic beforeCommand(command: string): void {\n\t\tif (command === 'updateOpen') {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.flush();\n\t}\n\n\tprivate flush() {\n\t\tif (!this.supportsBatching) {\n\t\t\t// We've already eagerly synchronized\n\t\t\tthis._pending.clear();\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._pending.size > 0) {\n\t\t\tconst closedFiles: string[] = [];\n\t\t\tconst openFiles: Proto.OpenRequestArgs[] = [];\n\t\t\tconst changedFiles: Proto.FileCodeEdits[] = [];\n\t\t\tfor (const change of this._pending.values) {\n\t\t\t\tswitch (change.type) {\n\t\t\t\t\tcase BufferOperationType.Change: changedFiles.push(change.args); break;\n\t\t\t\t\tcase BufferOperationType.Open: openFiles.push(change.args); break;\n\t\t\t\t\tcase BufferOperationType.Close: closedFiles.push(change.args); break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.client.execute('updateOpen', { changedFiles, closedFiles, openFiles }, nulToken, { nonRecoverable: true });\n\t\t\tthis._pending.clear();\n\t\t}\n\t}\n\n\tprivate get supportsBatching(): boolean {\n\t\treturn this.client.apiVersion.gte(API.v340);\n\t}\n\n\tprivate updatePending(resource: vscode.Uri, op: BufferOperation): boolean {\n\t\tswitch (op.type) {\n\t\t\tcase BufferOperationType.Close:\n\t\t\t\tconst existing = this._pending.get(resource);\n\t\t\t\tswitch (existing?.type) {\n\t\t\t\t\tcase BufferOperationType.Open:\n\t\t\t\t\t\tthis._pending.delete(resource);\n\t\t\t\t\t\treturn false; // Open then close. No need to do anything\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (this._pending.has(resource)) {\n\t\t\t// we saw this file before, make sure we flush before working with it again\n\t\t\tthis.flush();\n\t\t}\n\t\tthis._pending.set(resource, op);\n\t\treturn true;\n\t}\n}\n\nclass SyncedBuffer {\n\n\tprivate state = BufferState.Initial;\n\n\tconstructor(\n\t\tprivate readonly document: vscode.TextDocument,\n\t\tpublic readonly filepath: string,\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly synchronizer: BufferSynchronizer,\n\t) { }\n\n\tpublic open(): void {\n\t\tconst args: Proto.OpenRequestArgs = {\n\t\t\tfile: this.filepath,\n\t\t\tfileContent: this.document.getText(),\n\t\t\tprojectRootPath: this.client.getWorkspaceRootForResource(this.document.uri),\n\t\t};\n\n\t\tconst scriptKind = mode2ScriptKind(this.document.languageId);\n\t\tif (scriptKind) {\n\t\t\targs.scriptKindName = scriptKind;\n\t\t}\n\n\t\tif (this.client.apiVersion.gte(API.v240)) {\n\t\t\tconst tsPluginsForDocument = this.client.pluginManager.plugins\n\t\t\t\t.filter(x => x.languages.indexOf(this.document.languageId) >= 0);\n\n\t\t\tif (tsPluginsForDocument.length) {\n\t\t\t\t(args as any).plugins = tsPluginsForDocument.map(plugin => plugin.name);\n\t\t\t}\n\t\t}\n\n\t\tthis.synchronizer.open(this.resource, args);\n\t\tthis.state = BufferState.Open;\n\t}\n\n\tpublic get resource(): vscode.Uri {\n\t\treturn this.document.uri;\n\t}\n\n\tpublic get lineCount(): number {\n\t\treturn this.document.lineCount;\n\t}\n\n\tpublic get kind(): BufferKind {\n\t\tswitch (this.document.languageId) {\n\t\t\tcase languageModeIds.javascript:\n\t\t\tcase languageModeIds.javascriptreact:\n\t\t\t\treturn BufferKind.JavaScript;\n\n\t\t\tcase languageModeIds.typescript:\n\t\t\tcase languageModeIds.typescriptreact:\n\t\t\tdefault:\n\t\t\t\treturn BufferKind.TypeScript;\n\t\t}\n\t}\n\n\t/**\n\t * @return Was the buffer open?\n\t */\n\tpublic close(): boolean {\n\t\tif (this.state !== BufferState.Open) {\n\t\t\tthis.state = BufferState.Closed;\n\t\t\treturn false;\n\t\t}\n\t\tthis.state = BufferState.Closed;\n\t\treturn this.synchronizer.close(this.resource, this.filepath);\n\t}\n\n\tpublic onContentChanged(events: readonly vscode.TextDocumentContentChangeEvent[]): void {\n\t\tif (this.state !== BufferState.Open) {\n\t\t\tconsole.error(`Unexpected buffer state: ${this.state}`);\n\t\t}\n\n\t\tthis.synchronizer.change(this.resource, this.filepath, events);\n\t}\n}\n\nclass SyncedBufferMap extends ResourceMap<SyncedBuffer> {\n\n\tpublic getForPath(filePath: string): SyncedBuffer | undefined {\n\t\treturn this.get(vscode.Uri.file(filePath));\n\t}\n\n\tpublic get allBuffers(): Iterable<SyncedBuffer> {\n\t\treturn this.values;\n\t}\n}\n\nclass PendingDiagnostics extends ResourceMap<number> {\n\tpublic getOrderedFileSet(): ResourceMap<void> {\n\t\tconst orderedResources = Array.from(this.entries)\n\t\t\t.sort((a, b) => a.value - b.value)\n\t\t\t.map(entry => entry.resource);\n\n\t\tconst map = new ResourceMap<void>(this._normalizePath, this.config);\n\t\tfor (const resource of orderedResources) {\n\t\t\tmap.set(resource, undefined);\n\t\t}\n\t\treturn map;\n\t}\n}\n\nclass GetErrRequest {\n\n\tpublic static executeGetErrRequest(\n\t\tclient: ITypeScriptServiceClient,\n\t\tfiles: ResourceMap<void>,\n\t\tonDone: () => void\n\t) {\n\t\treturn new GetErrRequest(client, files, onDone);\n\t}\n\n\tprivate _done: boolean = false;\n\tprivate readonly _token: vscode.CancellationTokenSource = new vscode.CancellationTokenSource();\n\n\tprivate constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tpublic readonly files: ResourceMap<void>,\n\t\tonDone: () => void\n\t) {\n\t\tif (!this.isErrorReportingEnabled()) {\n\t\t\tthis._done = true;\n\t\t\tsetImmediate(onDone);\n\t\t\treturn;\n\t\t}\n\n\t\tconst supportsSyntaxGetErr = this.client.apiVersion.gte(API.v440);\n\t\tconst allFiles = coalesce(Array.from(files.entries)\n\t\t\t.filter(entry => supportsSyntaxGetErr || client.hasCapabilityForResource(entry.resource, ClientCapability.Semantic))\n\t\t\t.map(entry => client.normalizedPath(entry.resource)));\n\n\t\tif (!allFiles.length) {\n\t\t\tthis._done = true;\n\t\t\tsetImmediate(onDone);\n\t\t} else {\n\t\t\tconst request = this.areProjectDiagnosticsEnabled()\n\t\t\t\t// Note that geterrForProject is almost certainly not the api we want here as it ends up computing far\n\t\t\t\t// too many diagnostics\n\t\t\t\t? client.executeAsync('geterrForProject', { delay: 0, file: allFiles[0] }, this._token.token)\n\t\t\t\t: client.executeAsync('geterr', { delay: 0, files: allFiles }, this._token.token);\n\n\t\t\trequest.finally(() => {\n\t\t\t\tif (this._done) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._done = true;\n\t\t\t\tonDone();\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate isErrorReportingEnabled() {\n\t\tif (this.client.apiVersion.gte(API.v440)) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\t// Older TS versions only support `getErr` on semantic server\n\t\t\treturn this.client.capabilities.has(ClientCapability.Semantic);\n\t\t}\n\t}\n\n\tprivate areProjectDiagnosticsEnabled() {\n\t\treturn this.client.configuration.enableProjectDiagnostics && this.client.capabilities.has(ClientCapability.Semantic);\n\t}\n\n\tpublic cancel(): any {\n\t\tif (!this._done) {\n\t\t\tthis._token.cancel();\n\t\t}\n\n\t\tthis._token.dispose();\n\t}\n}\n\nexport default class BufferSyncSupport extends Disposable {\n\n\tprivate readonly client: ITypeScriptServiceClient;\n\n\tprivate _validateJavaScript: boolean = true;\n\tprivate _validateTypeScript: boolean = true;\n\tprivate readonly modeIds: Set<string>;\n\tprivate readonly syncedBuffers: SyncedBufferMap;\n\tprivate readonly pendingDiagnostics: PendingDiagnostics;\n\tprivate readonly diagnosticDelayer: Delayer<any>;\n\tprivate pendingGetErr: GetErrRequest | undefined;\n\tprivate listening: boolean = false;\n\tprivate readonly synchronizer: BufferSynchronizer;\n\n\tconstructor(\n\t\tclient: ITypeScriptServiceClient,\n\t\tmodeIds: readonly string[],\n\t\tonCaseInsensitiveFileSystem: boolean\n\t) {\n\t\tsuper();\n\t\tthis.client = client;\n\t\tthis.modeIds = new Set<string>(modeIds);\n\n\t\tthis.diagnosticDelayer = new Delayer<any>(300);\n\n\t\tconst pathNormalizer = (path: vscode.Uri) => this.client.normalizedPath(path);\n\t\tthis.syncedBuffers = new SyncedBufferMap(pathNormalizer, { onCaseInsensitiveFileSystem });\n\t\tthis.pendingDiagnostics = new PendingDiagnostics(pathNormalizer, { onCaseInsensitiveFileSystem });\n\t\tthis.synchronizer = new BufferSynchronizer(client, pathNormalizer, onCaseInsensitiveFileSystem);\n\n\t\tthis.updateConfiguration();\n\t\tvscode.workspace.onDidChangeConfiguration(this.updateConfiguration, this, this._disposables);\n\t}\n\n\tprivate readonly _onDelete = this._register(new vscode.EventEmitter<vscode.Uri>());\n\tpublic readonly onDelete = this._onDelete.event;\n\n\tprivate readonly _onWillChange = this._register(new vscode.EventEmitter<vscode.Uri>());\n\tpublic readonly onWillChange = this._onWillChange.event;\n\n\tpublic listen(): void {\n\t\tif (this.listening) {\n\t\t\treturn;\n\t\t}\n\t\tthis.listening = true;\n\t\tvscode.workspace.onDidOpenTextDocument(this.openTextDocument, this, this._disposables);\n\t\tvscode.workspace.onDidCloseTextDocument(this.onDidCloseTextDocument, this, this._disposables);\n\t\tvscode.workspace.onDidChangeTextDocument(this.onDidChangeTextDocument, this, this._disposables);\n\t\tvscode.window.onDidChangeVisibleTextEditors(e => {\n\t\t\tfor (const { document } of e) {\n\t\t\t\tconst syncedBuffer = this.syncedBuffers.get(document.uri);\n\t\t\t\tif (syncedBuffer) {\n\t\t\t\t\tthis.requestDiagnostic(syncedBuffer);\n\t\t\t\t}\n\t\t\t}\n\t\t}, this, this._disposables);\n\t\tvscode.workspace.textDocuments.forEach(this.openTextDocument, this);\n\t}\n\n\tpublic handles(resource: vscode.Uri): boolean {\n\t\treturn this.syncedBuffers.has(resource);\n\t}\n\n\tpublic ensureHasBuffer(resource: vscode.Uri): boolean {\n\t\tif (this.syncedBuffers.has(resource)) {\n\t\t\treturn true;\n\t\t}\n\n\t\tconst existingDocument = vscode.workspace.textDocuments.find(doc => doc.uri.toString() === resource.toString());\n\t\tif (existingDocument) {\n\t\t\treturn this.openTextDocument(existingDocument);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tpublic toVsCodeResource(resource: vscode.Uri): vscode.Uri {\n\t\tconst filepath = this.client.normalizedPath(resource);\n\t\tfor (const buffer of this.syncedBuffers.allBuffers) {\n\t\t\tif (buffer.filepath === filepath) {\n\t\t\t\treturn buffer.resource;\n\t\t\t}\n\t\t}\n\t\treturn resource;\n\t}\n\n\tpublic toResource(filePath: string): vscode.Uri {\n\t\tconst buffer = this.syncedBuffers.getForPath(filePath);\n\t\tif (buffer) {\n\t\t\treturn buffer.resource;\n\t\t}\n\t\treturn vscode.Uri.file(filePath);\n\t}\n\n\tpublic reset(): void {\n\t\tthis.pendingGetErr?.cancel();\n\t\tthis.pendingDiagnostics.clear();\n\t\tthis.synchronizer.reset();\n\t}\n\n\tpublic reinitialize(): void {\n\t\tthis.reset();\n\t\tfor (const buffer of this.syncedBuffers.allBuffers) {\n\t\t\tbuffer.open();\n\t\t}\n\t}\n\n\tpublic openTextDocument(document: vscode.TextDocument): boolean {\n\t\tif (!this.modeIds.has(document.languageId)) {\n\t\t\treturn false;\n\t\t}\n\t\tconst resource = document.uri;\n\t\tconst filepath = this.client.normalizedPath(resource);\n\t\tif (!filepath) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.syncedBuffers.has(resource)) {\n\t\t\treturn true;\n\t\t}\n\n\t\tconst syncedBuffer = new SyncedBuffer(document, filepath, this.client, this.synchronizer);\n\t\tthis.syncedBuffers.set(resource, syncedBuffer);\n\t\tsyncedBuffer.open();\n\t\tthis.requestDiagnostic(syncedBuffer);\n\t\treturn true;\n\t}\n\n\tpublic closeResource(resource: vscode.Uri): void {\n\t\tconst syncedBuffer = this.syncedBuffers.get(resource);\n\t\tif (!syncedBuffer) {\n\t\t\treturn;\n\t\t}\n\t\tthis.pendingDiagnostics.delete(resource);\n\t\tthis.pendingGetErr?.files.delete(resource);\n\t\tthis.syncedBuffers.delete(resource);\n\t\tconst wasBufferOpen = syncedBuffer.close();\n\t\tthis._onDelete.fire(resource);\n\t\tif (wasBufferOpen) {\n\t\t\tthis.requestAllDiagnostics();\n\t\t}\n\t}\n\n\tpublic interruptGetErr<R>(f: () => R): R {\n\t\tif (!this.pendingGetErr\n\t\t\t|| this.client.configuration.enableProjectDiagnostics // `geterr` happens on seperate server so no need to cancel it.\n\t\t) {\n\t\t\treturn f();\n\t\t}\n\n\t\tthis.pendingGetErr.cancel();\n\t\tthis.pendingGetErr = undefined;\n\t\tconst result = f();\n\t\tthis.triggerDiagnostics();\n\t\treturn result;\n\t}\n\n\tpublic beforeCommand(command: string): void {\n\t\tthis.synchronizer.beforeCommand(command);\n\t}\n\n\tprivate onDidCloseTextDocument(document: vscode.TextDocument): void {\n\t\tthis.closeResource(document.uri);\n\t}\n\n\tprivate onDidChangeTextDocument(e: vscode.TextDocumentChangeEvent): void {\n\t\tconst syncedBuffer = this.syncedBuffers.get(e.document.uri);\n\t\tif (!syncedBuffer) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._onWillChange.fire(syncedBuffer.resource);\n\n\t\tsyncedBuffer.onContentChanged(e.contentChanges);\n\t\tconst didTrigger = this.requestDiagnostic(syncedBuffer);\n\n\t\tif (!didTrigger && this.pendingGetErr) {\n\t\t\t// In this case we always want to re-trigger all diagnostics\n\t\t\tthis.pendingGetErr.cancel();\n\t\t\tthis.pendingGetErr = undefined;\n\t\t\tthis.triggerDiagnostics();\n\t\t}\n\t}\n\n\tpublic requestAllDiagnostics() {\n\t\tfor (const buffer of this.syncedBuffers.allBuffers) {\n\t\t\tif (this.shouldValidate(buffer)) {\n\t\t\t\tthis.pendingDiagnostics.set(buffer.resource, Date.now());\n\t\t\t}\n\t\t}\n\t\tthis.triggerDiagnostics();\n\t}\n\n\tpublic getErr(resources: readonly vscode.Uri[]): any {\n\t\tconst handledResources = resources.filter(resource => this.handles(resource));\n\t\tif (!handledResources.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const resource of handledResources) {\n\t\t\tthis.pendingDiagnostics.set(resource, Date.now());\n\t\t}\n\n\t\tthis.triggerDiagnostics();\n\t}\n\n\tprivate triggerDiagnostics(delay: number = 200) {\n\t\tthis.diagnosticDelayer.trigger(() => {\n\t\t\tthis.sendPendingDiagnostics();\n\t\t}, delay);\n\t}\n\n\tprivate requestDiagnostic(buffer: SyncedBuffer): boolean {\n\t\tif (!this.shouldValidate(buffer)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.pendingDiagnostics.set(buffer.resource, Date.now());\n\n\t\tconst delay = Math.min(Math.max(Math.ceil(buffer.lineCount / 20), 300), 800);\n\t\tthis.triggerDiagnostics(delay);\n\t\treturn true;\n\t}\n\n\tpublic hasPendingDiagnostics(resource: vscode.Uri): boolean {\n\t\treturn this.pendingDiagnostics.has(resource);\n\t}\n\n\tprivate sendPendingDiagnostics(): void {\n\t\tconst orderedFileSet = this.pendingDiagnostics.getOrderedFileSet();\n\n\t\tif (this.pendingGetErr) {\n\t\t\tthis.pendingGetErr.cancel();\n\n\t\t\tfor (const { resource } of this.pendingGetErr.files.entries) {\n\t\t\t\tif (this.syncedBuffers.get(resource)) {\n\t\t\t\t\torderedFileSet.set(resource, undefined);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.pendingGetErr = undefined;\n\t\t}\n\n\t\t// Add all open TS buffers to the geterr request. They might be visible\n\t\tfor (const buffer of this.syncedBuffers.values) {\n\t\t\torderedFileSet.set(buffer.resource, undefined);\n\t\t}\n\n\t\tif (orderedFileSet.size) {\n\t\t\tconst getErr = this.pendingGetErr = GetErrRequest.executeGetErrRequest(this.client, orderedFileSet, () => {\n\t\t\t\tif (this.pendingGetErr === getErr) {\n\t\t\t\t\tthis.pendingGetErr = undefined;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.pendingDiagnostics.clear();\n\t}\n\n\tprivate updateConfiguration() {\n\t\tconst jsConfig = vscode.workspace.getConfiguration('javascript', null);\n\t\tconst tsConfig = vscode.workspace.getConfiguration('typescript', null);\n\n\t\tthis._validateJavaScript = jsConfig.get<boolean>('validate.enable', true);\n\t\tthis._validateTypeScript = tsConfig.get<boolean>('validate.enable', true);\n\t}\n\n\tprivate shouldValidate(buffer: SyncedBuffer) {\n\t\tswitch (buffer.kind) {\n\t\t\tcase BufferKind.JavaScript:\n\t\t\t\treturn this._validateJavaScript;\n\n\t\t\tcase BufferKind.TypeScript:\n\t\t\tdefault:\n\t\t\t\treturn this._validateTypeScript;\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable } from 'vscode';\n\nexport interface ITask<T> {\n\t(): T;\n}\n\nexport class Delayer<T> {\n\n\tpublic defaultDelay: number;\n\tprivate timeout: any; // Timer\n\tprivate completionPromise: Promise<T | null> | null;\n\tprivate onSuccess: ((value: T | PromiseLike<T> | undefined) => void) | null;\n\tprivate task: ITask<T> | null;\n\n\tconstructor(defaultDelay: number) {\n\t\tthis.defaultDelay = defaultDelay;\n\t\tthis.timeout = null;\n\t\tthis.completionPromise = null;\n\t\tthis.onSuccess = null;\n\t\tthis.task = null;\n\t}\n\n\tpublic trigger(task: ITask<T>, delay: number = this.defaultDelay): Promise<T | null> {\n\t\tthis.task = task;\n\t\tif (delay >= 0) {\n\t\t\tthis.cancelTimeout();\n\t\t}\n\n\t\tif (!this.completionPromise) {\n\t\t\tthis.completionPromise = new Promise<T | undefined>((resolve) => {\n\t\t\t\tthis.onSuccess = resolve;\n\t\t\t}).then(() => {\n\t\t\t\tthis.completionPromise = null;\n\t\t\t\tthis.onSuccess = null;\n\t\t\t\tconst result = this.task && this.task();\n\t\t\t\tthis.task = null;\n\t\t\t\treturn result;\n\t\t\t});\n\t\t}\n\n\t\tif (delay >= 0 || this.timeout === null) {\n\t\t\tthis.timeout = setTimeout(() => {\n\t\t\t\tthis.timeout = null;\n\t\t\t\tif (this.onSuccess) {\n\t\t\t\t\tthis.onSuccess(undefined);\n\t\t\t\t}\n\t\t\t}, delay >= 0 ? delay : this.defaultDelay);\n\t\t}\n\n\t\treturn this.completionPromise;\n\t}\n\n\tprivate cancelTimeout(): void {\n\t\tif (this.timeout !== null) {\n\t\t\tclearTimeout(this.timeout);\n\t\t\tthis.timeout = null;\n\t\t}\n\t}\n}\n\nexport function setImmediate(callback: (...args: any[]) => void, ...args: any[]): Disposable {\n\tif (global.setImmediate) {\n\t\tconst handle = global.setImmediate(callback, ...args);\n\t\treturn { dispose: () => global.clearImmediate(handle) };\n\t} else {\n\t\tconst handle = setTimeout(callback, 0, ...args);\n\t\treturn { dispose: () => clearTimeout(handle) };\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as path from 'path';\nimport * as vscode from 'vscode';\nimport { OngoingRequestCancellerFactory } from '../tsServer/cancellation';\nimport { ClientCapabilities, ClientCapability, ServerType } from '../typescriptService';\nimport API from '../utils/api';\nimport { SyntaxServerConfiguration, TsServerLogLevel, TypeScriptServiceConfiguration } from '../utils/configuration';\nimport { Logger } from '../utils/logger';\nimport { isWeb } from '../utils/platform';\nimport { TypeScriptPluginPathsProvider } from '../utils/pluginPathsProvider';\nimport { PluginManager } from '../utils/plugins';\nimport { TelemetryReporter } from '../utils/telemetry';\nimport Tracer from '../utils/tracer';\nimport { ILogDirectoryProvider } from './logDirectoryProvider';\nimport { GetErrRoutingTsServer, ITypeScriptServer, ProcessBasedTsServer, SyntaxRoutingTsServer, TsServerDelegate, TsServerProcessFactory, TsServerProcessKind } from './server';\nimport { TypeScriptVersionManager } from './versionManager';\nimport { ITypeScriptVersionProvider, TypeScriptVersion } from './versionProvider';\n\nconst enum CompositeServerType {\n\t/** Run a single server that handles all commands  */\n\tSingle,\n\n\t/** Run a separate server for syntax commands */\n\tSeparateSyntax,\n\n\t/** Use a separate syntax server while the project is loading */\n\tDynamicSeparateSyntax,\n\n\t/** Only enable the syntax server */\n\tSyntaxOnly\n}\n\nexport class TypeScriptServerSpawner {\n\tpublic constructor(\n\t\tprivate readonly _versionProvider: ITypeScriptVersionProvider,\n\t\tprivate readonly _versionManager: TypeScriptVersionManager,\n\t\tprivate readonly _logDirectoryProvider: ILogDirectoryProvider,\n\t\tprivate readonly _pluginPathsProvider: TypeScriptPluginPathsProvider,\n\t\tprivate readonly _logger: Logger,\n\t\tprivate readonly _telemetryReporter: TelemetryReporter,\n\t\tprivate readonly _tracer: Tracer,\n\t\tprivate readonly _factory: TsServerProcessFactory,\n\t) { }\n\n\tpublic spawn(\n\t\tversion: TypeScriptVersion,\n\t\tcapabilities: ClientCapabilities,\n\t\tconfiguration: TypeScriptServiceConfiguration,\n\t\tpluginManager: PluginManager,\n\t\tcancellerFactory: OngoingRequestCancellerFactory,\n\t\tdelegate: TsServerDelegate,\n\t): ITypeScriptServer {\n\t\tlet primaryServer: ITypeScriptServer;\n\t\tconst serverType = this.getCompositeServerType(version, capabilities, configuration);\n\t\tconst shouldUseSeparateDiagnosticsServer = this.shouldUseSeparateDiagnosticsServer(configuration);\n\n\t\tswitch (serverType) {\n\t\t\tcase CompositeServerType.SeparateSyntax:\n\t\t\tcase CompositeServerType.DynamicSeparateSyntax:\n\t\t\t\t{\n\t\t\t\t\tconst enableDynamicRouting = !shouldUseSeparateDiagnosticsServer && serverType === CompositeServerType.DynamicSeparateSyntax;\n\t\t\t\t\tprimaryServer = new SyntaxRoutingTsServer({\n\t\t\t\t\t\tsyntax: this.spawnTsServer(TsServerProcessKind.Syntax, version, configuration, pluginManager, cancellerFactory),\n\t\t\t\t\t\tsemantic: this.spawnTsServer(TsServerProcessKind.Semantic, version, configuration, pluginManager, cancellerFactory),\n\t\t\t\t\t}, delegate, enableDynamicRouting);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tcase CompositeServerType.Single:\n\t\t\t\t{\n\t\t\t\t\tprimaryServer = this.spawnTsServer(TsServerProcessKind.Main, version, configuration, pluginManager, cancellerFactory);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tcase CompositeServerType.SyntaxOnly:\n\t\t\t\t{\n\t\t\t\t\tprimaryServer = this.spawnTsServer(TsServerProcessKind.Syntax, version, configuration, pluginManager, cancellerFactory);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t}\n\n\t\tif (shouldUseSeparateDiagnosticsServer) {\n\t\t\treturn new GetErrRoutingTsServer({\n\t\t\t\tgetErr: this.spawnTsServer(TsServerProcessKind.Diagnostics, version, configuration, pluginManager, cancellerFactory),\n\t\t\t\tprimary: primaryServer,\n\t\t\t}, delegate);\n\t\t}\n\n\t\treturn primaryServer;\n\t}\n\n\tprivate getCompositeServerType(\n\t\tversion: TypeScriptVersion,\n\t\tcapabilities: ClientCapabilities,\n\t\tconfiguration: TypeScriptServiceConfiguration,\n\t): CompositeServerType {\n\t\tif (!capabilities.has(ClientCapability.Semantic)) {\n\t\t\treturn CompositeServerType.SyntaxOnly;\n\t\t}\n\n\t\tswitch (configuration.useSyntaxServer) {\n\t\t\tcase SyntaxServerConfiguration.Always:\n\t\t\t\treturn CompositeServerType.SyntaxOnly;\n\n\t\t\tcase SyntaxServerConfiguration.Never:\n\t\t\t\treturn CompositeServerType.Single;\n\n\t\t\tcase SyntaxServerConfiguration.Auto:\n\t\t\t\tif (version.apiVersion?.gte(API.v340)) {\n\t\t\t\t\treturn version.apiVersion?.gte(API.v400)\n\t\t\t\t\t\t? CompositeServerType.DynamicSeparateSyntax\n\t\t\t\t\t\t: CompositeServerType.SeparateSyntax;\n\t\t\t\t}\n\t\t\t\treturn CompositeServerType.Single;\n\t\t}\n\t}\n\n\tprivate shouldUseSeparateDiagnosticsServer(\n\t\tconfiguration: TypeScriptServiceConfiguration,\n\t): boolean {\n\t\treturn configuration.enableProjectDiagnostics;\n\t}\n\n\tprivate spawnTsServer(\n\t\tkind: TsServerProcessKind,\n\t\tversion: TypeScriptVersion,\n\t\tconfiguration: TypeScriptServiceConfiguration,\n\t\tpluginManager: PluginManager,\n\t\tcancellerFactory: OngoingRequestCancellerFactory,\n\t): ITypeScriptServer {\n\t\tconst apiVersion = version.apiVersion || API.defaultVersion;\n\n\t\tconst canceller = cancellerFactory.create(kind, this._tracer);\n\t\tconst { args, tsServerLogFile, tsServerTraceDirectory } = this.getTsServerArgs(kind, configuration, version, apiVersion, pluginManager, canceller.cancellationPipeName);\n\n\t\tif (TypeScriptServerSpawner.isLoggingEnabled(configuration)) {\n\t\t\tif (tsServerLogFile) {\n\t\t\t\tthis._logger.info(`<${kind}> Log file: ${tsServerLogFile}`);\n\t\t\t} else {\n\t\t\t\tthis._logger.error(`<${kind}> Could not create log directory`);\n\t\t\t}\n\t\t}\n\n\t\tif (configuration.enableTsServerTracing) {\n\t\t\tif (tsServerTraceDirectory) {\n\t\t\t\tthis._logger.info(`<${kind}> Trace directory: ${tsServerTraceDirectory}`);\n\t\t\t} else {\n\t\t\t\tthis._logger.error(`<${kind}> Could not create trace directory`);\n\t\t\t}\n\t\t}\n\n\t\tthis._logger.info(`<${kind}> Forking...`);\n\t\tconst process = this._factory.fork(version.tsServerPath, args, kind, configuration, this._versionManager);\n\t\tthis._logger.info(`<${kind}> Starting...`);\n\n\t\treturn new ProcessBasedTsServer(\n\t\t\tkind,\n\t\t\tthis.kindToServerType(kind),\n\t\t\tprocess!,\n\t\t\ttsServerLogFile,\n\t\t\tcanceller,\n\t\t\tversion,\n\t\t\tthis._telemetryReporter,\n\t\t\tthis._tracer);\n\t}\n\n\tprivate kindToServerType(kind: TsServerProcessKind): ServerType {\n\t\tswitch (kind) {\n\t\t\tcase TsServerProcessKind.Syntax:\n\t\t\t\treturn ServerType.Syntax;\n\n\t\t\tcase TsServerProcessKind.Main:\n\t\t\tcase TsServerProcessKind.Semantic:\n\t\t\tcase TsServerProcessKind.Diagnostics:\n\t\t\tdefault:\n\t\t\t\treturn ServerType.Semantic;\n\t\t}\n\t}\n\n\tprivate getTsServerArgs(\n\t\tkind: TsServerProcessKind,\n\t\tconfiguration: TypeScriptServiceConfiguration,\n\t\tcurrentVersion: TypeScriptVersion,\n\t\tapiVersion: API,\n\t\tpluginManager: PluginManager,\n\t\tcancellationPipeName: string | undefined,\n\t): { args: string[], tsServerLogFile: string | undefined, tsServerTraceDirectory: string | undefined } {\n\t\tconst args: string[] = [];\n\t\tlet tsServerLogFile: string | undefined;\n\t\tlet tsServerTraceDirectory: string | undefined;\n\n\t\tif (kind === TsServerProcessKind.Syntax) {\n\t\t\tif (apiVersion.gte(API.v401)) {\n\t\t\t\targs.push('--serverMode', 'partialSemantic');\n\t\t\t} else {\n\t\t\t\targs.push('--syntaxOnly');\n\t\t\t}\n\t\t}\n\n\t\tif (apiVersion.gte(API.v250)) {\n\t\t\targs.push('--useInferredProjectPerProjectRoot');\n\t\t} else {\n\t\t\targs.push('--useSingleInferredProject');\n\t\t}\n\n\t\tif (configuration.disableAutomaticTypeAcquisition || kind === TsServerProcessKind.Syntax || kind === TsServerProcessKind.Diagnostics) {\n\t\t\targs.push('--disableAutomaticTypingAcquisition');\n\t\t}\n\n\t\tif (kind === TsServerProcessKind.Semantic || kind === TsServerProcessKind.Main) {\n\t\t\targs.push('--enableTelemetry');\n\t\t}\n\n\t\tif (cancellationPipeName) {\n\t\t\targs.push('--cancellationPipeName', cancellationPipeName + '*');\n\t\t}\n\n\t\tif (TypeScriptServerSpawner.isLoggingEnabled(configuration)) {\n\t\t\tif (isWeb()) {\n\t\t\t\targs.push('--logVerbosity', TsServerLogLevel.toString(configuration.tsServerLogLevel));\n\t\t\t} else {\n\t\t\t\tconst logDir = this._logDirectoryProvider.getNewLogDirectory();\n\t\t\t\tif (logDir) {\n\t\t\t\t\ttsServerLogFile = path.join(logDir, `tsserver.log`);\n\t\t\t\t\targs.push('--logVerbosity', TsServerLogLevel.toString(configuration.tsServerLogLevel));\n\t\t\t\t\targs.push('--logFile', tsServerLogFile);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (configuration.enableTsServerTracing && !isWeb()) {\n\t\t\ttsServerTraceDirectory = this._logDirectoryProvider.getNewLogDirectory();\n\t\t\tif (tsServerTraceDirectory) {\n\t\t\t\targs.push('--traceDirectory', tsServerTraceDirectory);\n\t\t\t}\n\t\t}\n\n\t\tif (!isWeb()) {\n\t\t\tconst pluginPaths = this._pluginPathsProvider.getPluginPaths();\n\n\t\t\tif (pluginManager.plugins.length) {\n\t\t\t\targs.push('--globalPlugins', pluginManager.plugins.map(x => x.name).join(','));\n\n\t\t\t\tconst isUsingBundledTypeScriptVersion = currentVersion.path === this._versionProvider.defaultVersion.path;\n\t\t\t\tfor (const plugin of pluginManager.plugins) {\n\t\t\t\t\tif (isUsingBundledTypeScriptVersion || plugin.enableForWorkspaceTypeScriptVersions) {\n\t\t\t\t\t\tpluginPaths.push(plugin.path);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (pluginPaths.length !== 0) {\n\t\t\t\targs.push('--pluginProbeLocations', pluginPaths.join(','));\n\t\t\t}\n\t\t}\n\n\t\tif (configuration.npmLocation) {\n\t\t\targs.push('--npmLocation', `\"${configuration.npmLocation}\"`);\n\t\t}\n\n\t\tif (apiVersion.gte(API.v260)) {\n\t\t\targs.push('--locale', TypeScriptServerSpawner.getTsLocale(configuration));\n\t\t}\n\n\t\tif (apiVersion.gte(API.v291)) {\n\t\t\targs.push('--noGetErrOnBackgroundUpdate');\n\t\t}\n\n\t\tif (apiVersion.gte(API.v345)) {\n\t\t\targs.push('--validateDefaultNpmLocation');\n\t\t}\n\n\t\treturn { args, tsServerLogFile, tsServerTraceDirectory };\n\t}\n\n\tprivate static isLoggingEnabled(configuration: TypeScriptServiceConfiguration) {\n\t\treturn configuration.tsServerLogLevel !== TsServerLogLevel.Off;\n\t}\n\n\tprivate static getTsLocale(configuration: TypeScriptServiceConfiguration): string {\n\t\treturn configuration.locale\n\t\t\t? configuration.locale\n\t\t\t: vscode.env.language;\n\t}\n}\n\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as objects from '../utils/objects';\n\nexport enum TsServerLogLevel {\n\tOff,\n\tNormal,\n\tTerse,\n\tVerbose,\n}\n\nexport namespace TsServerLogLevel {\n\texport function fromString(value: string): TsServerLogLevel {\n\t\tswitch (value && value.toLowerCase()) {\n\t\t\tcase 'normal':\n\t\t\t\treturn TsServerLogLevel.Normal;\n\t\t\tcase 'terse':\n\t\t\t\treturn TsServerLogLevel.Terse;\n\t\t\tcase 'verbose':\n\t\t\t\treturn TsServerLogLevel.Verbose;\n\t\t\tcase 'off':\n\t\t\tdefault:\n\t\t\t\treturn TsServerLogLevel.Off;\n\t\t}\n\t}\n\n\texport function toString(value: TsServerLogLevel): string {\n\t\tswitch (value) {\n\t\t\tcase TsServerLogLevel.Normal:\n\t\t\t\treturn 'normal';\n\t\t\tcase TsServerLogLevel.Terse:\n\t\t\t\treturn 'terse';\n\t\t\tcase TsServerLogLevel.Verbose:\n\t\t\t\treturn 'verbose';\n\t\t\tcase TsServerLogLevel.Off:\n\t\t\tdefault:\n\t\t\t\treturn 'off';\n\t\t}\n\t}\n}\n\nexport const enum SyntaxServerConfiguration {\n\tNever,\n\tAlways,\n\t/** Use a single syntax server for every request, even on desktop */\n\tAuto,\n}\n\nexport class ImplicitProjectConfiguration {\n\n\tpublic readonly checkJs: boolean;\n\tpublic readonly experimentalDecorators: boolean;\n\tpublic readonly strictNullChecks: boolean;\n\tpublic readonly strictFunctionTypes: boolean;\n\n\tconstructor(configuration: vscode.WorkspaceConfiguration) {\n\t\tthis.checkJs = ImplicitProjectConfiguration.readCheckJs(configuration);\n\t\tthis.experimentalDecorators = ImplicitProjectConfiguration.readExperimentalDecorators(configuration);\n\t\tthis.strictNullChecks = ImplicitProjectConfiguration.readImplicitStrictNullChecks(configuration);\n\t\tthis.strictFunctionTypes = ImplicitProjectConfiguration.readImplicitStrictFunctionTypes(configuration);\n\t}\n\n\tpublic isEqualTo(other: ImplicitProjectConfiguration): boolean {\n\t\treturn objects.equals(this, other);\n\t}\n\n\tprivate static readCheckJs(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\treturn configuration.get<boolean>('js/ts.implicitProjectConfig.checkJs')\n\t\t\t?? configuration.get<boolean>('javascript.implicitProjectConfig.checkJs', false);\n\t}\n\n\tprivate static readExperimentalDecorators(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\treturn configuration.get<boolean>('js/ts.implicitProjectConfig.experimentalDecorators')\n\t\t\t?? configuration.get<boolean>('javascript.implicitProjectConfig.experimentalDecorators', false);\n\t}\n\n\tprivate static readImplicitStrictNullChecks(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\treturn configuration.get<boolean>('js/ts.implicitProjectConfig.strictNullChecks', false);\n\t}\n\n\tprivate static readImplicitStrictFunctionTypes(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\treturn configuration.get<boolean>('js/ts.implicitProjectConfig.strictFunctionTypes', true);\n\t}\n}\n\nexport interface TypeScriptServiceConfiguration {\n\treadonly locale: string | null;\n\treadonly globalTsdk: string | null;\n\treadonly localTsdk: string | null;\n\treadonly npmLocation: string | null;\n\treadonly tsServerLogLevel: TsServerLogLevel;\n\treadonly tsServerPluginPaths: readonly string[];\n\treadonly implicitProjectConfiguration: ImplicitProjectConfiguration;\n\treadonly disableAutomaticTypeAcquisition: boolean;\n\treadonly useSyntaxServer: SyntaxServerConfiguration;\n\treadonly enableProjectDiagnostics: boolean;\n\treadonly maxTsServerMemory: number;\n\treadonly enablePromptUseWorkspaceTsdk: boolean;\n\treadonly watchOptions: protocol.WatchOptions | undefined;\n\treadonly includePackageJsonAutoImports: 'auto' | 'on' | 'off' | undefined;\n\treadonly enableTsServerTracing: boolean;\n}\n\nexport function areServiceConfigurationsEqual(a: TypeScriptServiceConfiguration, b: TypeScriptServiceConfiguration): boolean {\n\treturn objects.equals(a, b);\n}\n\nexport interface ServiceConfigurationProvider {\n\tloadFromWorkspace(): TypeScriptServiceConfiguration;\n}\n\nexport abstract class BaseServiceConfigurationProvider implements ServiceConfigurationProvider {\n\n\tpublic loadFromWorkspace(): TypeScriptServiceConfiguration {\n\t\tconst configuration = vscode.workspace.getConfiguration();\n\t\treturn {\n\t\t\tlocale: this.extractLocale(configuration),\n\t\t\tglobalTsdk: this.extractGlobalTsdk(configuration),\n\t\t\tlocalTsdk: this.extractLocalTsdk(configuration),\n\t\t\tnpmLocation: this.readNpmLocation(configuration),\n\t\t\ttsServerLogLevel: this.readTsServerLogLevel(configuration),\n\t\t\ttsServerPluginPaths: this.readTsServerPluginPaths(configuration),\n\t\t\timplicitProjectConfiguration: new ImplicitProjectConfiguration(configuration),\n\t\t\tdisableAutomaticTypeAcquisition: this.readDisableAutomaticTypeAcquisition(configuration),\n\t\t\tuseSyntaxServer: this.readUseSyntaxServer(configuration),\n\t\t\tenableProjectDiagnostics: this.readEnableProjectDiagnostics(configuration),\n\t\t\tmaxTsServerMemory: this.readMaxTsServerMemory(configuration),\n\t\t\tenablePromptUseWorkspaceTsdk: this.readEnablePromptUseWorkspaceTsdk(configuration),\n\t\t\twatchOptions: this.readWatchOptions(configuration),\n\t\t\tincludePackageJsonAutoImports: this.readIncludePackageJsonAutoImports(configuration),\n\t\t\tenableTsServerTracing: this.readEnableTsServerTracing(configuration),\n\t\t};\n\t}\n\n\tprotected abstract extractGlobalTsdk(configuration: vscode.WorkspaceConfiguration): string | null;\n\tprotected abstract extractLocalTsdk(configuration: vscode.WorkspaceConfiguration): string | null;\n\n\tprotected readTsServerLogLevel(configuration: vscode.WorkspaceConfiguration): TsServerLogLevel {\n\t\tconst setting = configuration.get<string>('typescript.tsserver.log', 'off');\n\t\treturn TsServerLogLevel.fromString(setting);\n\t}\n\n\tprotected readTsServerPluginPaths(configuration: vscode.WorkspaceConfiguration): string[] {\n\t\treturn configuration.get<string[]>('typescript.tsserver.pluginPaths', []);\n\t}\n\n\tprotected readNpmLocation(configuration: vscode.WorkspaceConfiguration): string | null {\n\t\treturn configuration.get<string | null>('typescript.npm', null);\n\t}\n\n\tprotected readDisableAutomaticTypeAcquisition(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\treturn configuration.get<boolean>('typescript.disableAutomaticTypeAcquisition', false);\n\t}\n\n\tprotected extractLocale(configuration: vscode.WorkspaceConfiguration): string | null {\n\t\treturn configuration.get<string | null>('typescript.locale', null);\n\t}\n\n\tprotected readUseSyntaxServer(configuration: vscode.WorkspaceConfiguration): SyntaxServerConfiguration {\n\t\tconst value = configuration.get<string>('typescript.tsserver.useSyntaxServer');\n\t\tswitch (value) {\n\t\t\tcase 'never': return SyntaxServerConfiguration.Never;\n\t\t\tcase 'always': return SyntaxServerConfiguration.Always;\n\t\t\tcase 'auto': return SyntaxServerConfiguration.Auto;\n\t\t}\n\n\t\t// Fallback to deprecated setting\n\t\tconst deprecatedValue = configuration.get<boolean | string>('typescript.tsserver.useSeparateSyntaxServer', true);\n\t\tif (deprecatedValue === 'forAllRequests') { // Undocumented setting\n\t\t\treturn SyntaxServerConfiguration.Always;\n\t\t}\n\t\tif (deprecatedValue === true) {\n\t\t\treturn SyntaxServerConfiguration.Auto;\n\t\t}\n\t\treturn SyntaxServerConfiguration.Never;\n\t}\n\n\tprotected readEnableProjectDiagnostics(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\treturn configuration.get<boolean>('typescript.tsserver.experimental.enableProjectDiagnostics', false);\n\t}\n\n\tprotected readWatchOptions(configuration: vscode.WorkspaceConfiguration): protocol.WatchOptions | undefined {\n\t\treturn configuration.get<protocol.WatchOptions>('typescript.tsserver.watchOptions');\n\t}\n\n\tprotected readIncludePackageJsonAutoImports(configuration: vscode.WorkspaceConfiguration): 'auto' | 'on' | 'off' | undefined {\n\t\treturn configuration.get<'auto' | 'on' | 'off'>('typescript.preferences.includePackageJsonAutoImports');\n\t}\n\n\tprotected readMaxTsServerMemory(configuration: vscode.WorkspaceConfiguration): number {\n\t\tconst defaultMaxMemory = 3072;\n\t\tconst minimumMaxMemory = 128;\n\t\tconst memoryInMB = configuration.get<number>('typescript.tsserver.maxTsServerMemory', defaultMaxMemory);\n\t\tif (!Number.isSafeInteger(memoryInMB)) {\n\t\t\treturn defaultMaxMemory;\n\t\t}\n\t\treturn Math.max(memoryInMB, minimumMaxMemory);\n\t}\n\n\tprotected readEnablePromptUseWorkspaceTsdk(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\treturn configuration.get<boolean>('typescript.enablePromptUseWorkspaceTsdk', false);\n\t}\n\n\tprotected readEnableTsServerTracing(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\treturn configuration.get<boolean>('typescript.tsserver.enableTracing', false);\n\t}\n\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\n\nexport function isWeb(): boolean {\n\t// @ts-expect-error\n\treturn typeof navigator !== 'undefined' && vscode.env.uiKind === vscode.UIKind.Web;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as nls from 'vscode-nls';\nimport { setImmediate } from '../utils/async';\nimport { TypeScriptServiceConfiguration } from '../utils/configuration';\nimport { Disposable } from '../utils/dispose';\nimport { ITypeScriptVersionProvider, TypeScriptVersion } from './versionProvider';\n\nconst localize = nls.loadMessageBundle();\n\nconst useWorkspaceTsdkStorageKey = 'typescript.useWorkspaceTsdk';\nconst suppressPromptWorkspaceTsdkStorageKey = 'typescript.suppressPromptWorkspaceTsdk';\n\ninterface QuickPickItem extends vscode.QuickPickItem {\n\trun(): void;\n}\n\nexport class TypeScriptVersionManager extends Disposable {\n\n\tprivate _currentVersion: TypeScriptVersion;\n\n\tpublic constructor(\n\t\tprivate configuration: TypeScriptServiceConfiguration,\n\t\tprivate readonly versionProvider: ITypeScriptVersionProvider,\n\t\tprivate readonly workspaceState: vscode.Memento\n\t) {\n\t\tsuper();\n\n\t\tthis._currentVersion = this.versionProvider.defaultVersion;\n\n\t\tif (this.useWorkspaceTsdkSetting) {\n\t\t\tif (vscode.workspace.isTrusted) {\n\t\t\t\tconst localVersion = this.versionProvider.localVersion;\n\t\t\t\tif (localVersion) {\n\t\t\t\t\tthis._currentVersion = localVersion;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._disposables.push(vscode.workspace.onDidGrantWorkspaceTrust(() => {\n\t\t\t\t\tif (this.versionProvider.localVersion) {\n\t\t\t\t\t\tthis.updateActiveVersion(this.versionProvider.localVersion);\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\n\t\tif (this.isInPromptWorkspaceTsdkState(configuration)) {\n\t\t\tsetImmediate(() => {\n\t\t\t\tthis.promptUseWorkspaceTsdk();\n\t\t\t});\n\t\t}\n\n\t}\n\n\tprivate readonly _onDidPickNewVersion = this._register(new vscode.EventEmitter<void>());\n\tpublic readonly onDidPickNewVersion = this._onDidPickNewVersion.event;\n\n\tpublic updateConfiguration(nextConfiguration: TypeScriptServiceConfiguration) {\n\t\tconst lastConfiguration = this.configuration;\n\t\tthis.configuration = nextConfiguration;\n\n\t\tif (\n\t\t\t!this.isInPromptWorkspaceTsdkState(lastConfiguration)\n\t\t\t&& this.isInPromptWorkspaceTsdkState(nextConfiguration)\n\t\t) {\n\t\t\tthis.promptUseWorkspaceTsdk();\n\t\t}\n\t}\n\n\tpublic get currentVersion(): TypeScriptVersion {\n\t\treturn this._currentVersion;\n\t}\n\n\tpublic reset(): void {\n\t\tthis._currentVersion = this.versionProvider.bundledVersion;\n\t}\n\n\tpublic async promptUserForVersion(): Promise<void> {\n\t\tconst selected = await vscode.window.showQuickPick<QuickPickItem>([\n\t\t\tthis.getBundledPickItem(),\n\t\t\t...this.getLocalPickItems(),\n\t\t\tLearnMorePickItem,\n\t\t], {\n\t\t\tplaceHolder: localize(\n\t\t\t\t'selectTsVersion',\n\t\t\t\t\"Select the TypeScript version used for JavaScript and TypeScript language features\"),\n\t\t});\n\n\t\treturn selected?.run();\n\t}\n\n\tprivate getBundledPickItem(): QuickPickItem {\n\t\tconst bundledVersion = this.versionProvider.defaultVersion;\n\t\treturn {\n\t\t\tlabel: (!this.useWorkspaceTsdkSetting || !vscode.workspace.isTrusted\n\t\t\t\t? ' '\n\t\t\t\t: '') + localize('useVSCodeVersionOption', \"Use VS Code's Version\"),\n\t\t\tdescription: bundledVersion.displayName,\n\t\t\tdetail: bundledVersion.pathLabel,\n\t\t\trun: async () => {\n\t\t\t\tawait this.workspaceState.update(useWorkspaceTsdkStorageKey, false);\n\t\t\t\tthis.updateActiveVersion(bundledVersion);\n\t\t\t},\n\t\t};\n\t}\n\n\tprivate getLocalPickItems(): QuickPickItem[] {\n\t\treturn this.versionProvider.localVersions.map(version => {\n\t\t\treturn {\n\t\t\t\tlabel: (this.useWorkspaceTsdkSetting && vscode.workspace.isTrusted && this.currentVersion.eq(version)\n\t\t\t\t\t? ' '\n\t\t\t\t\t: '') + localize('useWorkspaceVersionOption', \"Use Workspace Version\"),\n\t\t\t\tdescription: version.displayName,\n\t\t\t\tdetail: version.pathLabel,\n\t\t\t\trun: async () => {\n\t\t\t\t\tconst trusted = await vscode.workspace.requestWorkspaceTrust();\n\t\t\t\t\tif (trusted) {\n\t\t\t\t\t\tawait this.workspaceState.update(useWorkspaceTsdkStorageKey, true);\n\t\t\t\t\t\tconst tsConfig = vscode.workspace.getConfiguration('typescript');\n\t\t\t\t\t\tawait tsConfig.update('tsdk', version.pathLabel, false);\n\t\t\t\t\t\tthis.updateActiveVersion(version);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t};\n\t\t});\n\t}\n\n\tprivate async promptUseWorkspaceTsdk(): Promise<void> {\n\t\tconst workspaceVersion = this.versionProvider.localVersion;\n\n\t\tif (workspaceVersion === undefined) {\n\t\t\tthrow new Error('Could not prompt to use workspace TypeScript version because no workspace version is specified');\n\t\t}\n\n\t\tconst allowIt = localize('allow', 'Allow');\n\t\tconst dismissPrompt = localize('dismiss', 'Dismiss');\n\t\tconst suppressPrompt = localize('suppress prompt', 'Never in this Workspace');\n\n\t\tconst result = await vscode.window.showInformationMessage(localize('promptUseWorkspaceTsdk', 'This workspace contains a TypeScript version. Would you like to use the workspace TypeScript version for TypeScript and JavaScript language features?'),\n\t\t\tallowIt,\n\t\t\tdismissPrompt,\n\t\t\tsuppressPrompt\n\t\t);\n\n\t\tif (result === allowIt) {\n\t\t\tawait this.workspaceState.update(useWorkspaceTsdkStorageKey, true);\n\t\t\tthis.updateActiveVersion(workspaceVersion);\n\t\t} else if (result === suppressPrompt) {\n\t\t\tawait this.workspaceState.update(suppressPromptWorkspaceTsdkStorageKey, true);\n\t\t}\n\t}\n\n\tprivate updateActiveVersion(pickedVersion: TypeScriptVersion) {\n\t\tconst oldVersion = this.currentVersion;\n\t\tthis._currentVersion = pickedVersion;\n\t\tif (!oldVersion.eq(pickedVersion)) {\n\t\t\tthis._onDidPickNewVersion.fire();\n\t\t}\n\t}\n\n\tprivate get useWorkspaceTsdkSetting(): boolean {\n\t\treturn this.workspaceState.get<boolean>(useWorkspaceTsdkStorageKey, false);\n\t}\n\n\tprivate get suppressPromptWorkspaceTsdkSetting(): boolean {\n\t\treturn this.workspaceState.get<boolean>(suppressPromptWorkspaceTsdkStorageKey, false);\n\t}\n\n\tprivate isInPromptWorkspaceTsdkState(configuration: TypeScriptServiceConfiguration) {\n\t\treturn (\n\t\t\tconfiguration.localTsdk !== null\n\t\t\t&& configuration.enablePromptUseWorkspaceTsdk === true\n\t\t\t&& this.suppressPromptWorkspaceTsdkSetting === false\n\t\t\t&& this.useWorkspaceTsdkSetting === false\n\t\t);\n\t}\n}\n\nconst LearnMorePickItem: QuickPickItem = {\n\tlabel: localize('learnMore', 'Learn more about managing TypeScript versions'),\n\tdescription: '',\n\trun: () => {\n\t\tvscode.env.openExternal(vscode.Uri.parse('https://go.microsoft.com/fwlink/?linkid=839919'));\n\t}\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as nls from 'vscode-nls';\nimport { memoize } from './memoize';\n\nconst localize = nls.loadMessageBundle();\n\ntype LogLevel = 'Trace' | 'Info' | 'Error';\n\nexport class Logger {\n\n\t@memoize\n\tprivate get output(): vscode.OutputChannel {\n\t\treturn vscode.window.createOutputChannel(localize('channelName', 'TypeScript'));\n\t}\n\n\tprivate data2String(data: any): string {\n\t\tif (data instanceof Error) {\n\t\t\treturn data.stack || data.message;\n\t\t}\n\t\tif (data.success === false && data.message) {\n\t\t\treturn data.message;\n\t\t}\n\t\treturn data.toString();\n\t}\n\n\tpublic info(message: string, data?: any): void {\n\t\tthis.logLevel('Info', message, data);\n\t}\n\n\tpublic error(message: string, data?: any): void {\n\t\t// See https://github.com/microsoft/TypeScript/issues/10496\n\t\tif (data && data.message === 'No content available.') {\n\t\t\treturn;\n\t\t}\n\t\tthis.logLevel('Error', message, data);\n\t}\n\n\tpublic logLevel(level: LogLevel, message: string, data?: any): void {\n\t\tthis.output.appendLine(`[${level}  - ${this.now()}] ${message}`);\n\t\tif (data) {\n\t\t\tthis.output.appendLine(this.data2String(data));\n\t\t}\n\t}\n\n\tprivate now(): string {\n\t\tconst now = new Date();\n\t\treturn padLeft(now.getUTCHours() + '', 2, '0')\n\t\t\t+ ':' + padLeft(now.getMinutes() + '', 2, '0')\n\t\t\t+ ':' + padLeft(now.getUTCSeconds() + '', 2, '0') + '.' + now.getMilliseconds();\n\t}\n}\n\nfunction padLeft(s: string, n: number, pad = ' ') {\n\treturn pad.repeat(Math.max(0, n - s.length)) + s;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as path from 'path';\nimport * as vscode from 'vscode';\nimport { TypeScriptServiceConfiguration } from './configuration';\nimport { RelativeWorkspacePathResolver } from './relativePathResolver';\n\n\nexport class TypeScriptPluginPathsProvider {\n\n\tpublic constructor(\n\t\tprivate configuration: TypeScriptServiceConfiguration\n\t) { }\n\n\tpublic updateConfiguration(configuration: TypeScriptServiceConfiguration): void {\n\t\tthis.configuration = configuration;\n\t}\n\n\tpublic getPluginPaths(): string[] {\n\t\tconst pluginPaths = [];\n\t\tfor (const pluginPath of this.configuration.tsServerPluginPaths) {\n\t\t\tpluginPaths.push(...this.resolvePluginPath(pluginPath));\n\t\t}\n\t\treturn pluginPaths;\n\t}\n\n\tprivate resolvePluginPath(pluginPath: string): string[] {\n\t\tif (path.isAbsolute(pluginPath)) {\n\t\t\treturn [pluginPath];\n\t\t}\n\n\t\tconst workspacePath = RelativeWorkspacePathResolver.asAbsoluteWorkspacePath(pluginPath);\n\t\tif (workspacePath !== undefined) {\n\t\t\treturn [workspacePath];\n\t\t}\n\n\t\treturn (vscode.workspace.workspaceFolders || [])\n\t\t\t.map(workspaceFolder => path.join(workspaceFolder.uri.fsPath, pluginPath));\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as path from 'path';\nimport * as vscode from 'vscode';\n\nexport class RelativeWorkspacePathResolver {\n\tpublic static asAbsoluteWorkspacePath(relativePath: string): string | undefined {\n\t\tfor (const root of vscode.workspace.workspaceFolders || []) {\n\t\t\tconst rootPrefixes = [`./${root.name}/`, `${root.name}/`, `.\\\\${root.name}\\\\`, `${root.name}\\\\`];\n\t\t\tfor (const rootPrefix of rootPrefixes) {\n\t\t\t\tif (relativePath.startsWith(rootPrefix)) {\n\t\t\t\t\treturn path.join(root.uri.fsPath, relativePath.replace(rootPrefix, ''));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport VsCodeTelemetryReporter from 'vscode-extension-telemetry';\nimport { memoize } from './memoize';\n\ninterface PackageInfo {\n\treadonly name: string;\n\treadonly version: string;\n\treadonly aiKey: string;\n}\n\nexport interface TelemetryProperties {\n\treadonly [prop: string]: string | number | boolean | undefined;\n}\n\nexport interface TelemetryReporter {\n\tlogTelemetry(eventName: string, properties?: TelemetryProperties): void;\n\n\tdispose(): void;\n}\n\nexport class VSCodeTelemetryReporter implements TelemetryReporter {\n\tprivate _reporter: VsCodeTelemetryReporter | null = null;\n\n\tconstructor(\n\t\tprivate readonly clientVersionDelegate: () => string\n\t) { }\n\n\tpublic logTelemetry(eventName: string, properties: { [prop: string]: string } = {}) {\n\t\tconst reporter = this.reporter;\n\t\tif (!reporter) {\n\t\t\treturn;\n\t\t}\n\n\t\t/* __GDPR__FRAGMENT__\n\t\t\t\"TypeScriptCommonProperties\" : {\n\t\t\t\t\"version\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n\t\t\t}\n\t\t*/\n\t\tproperties['version'] = this.clientVersionDelegate();\n\n\t\treporter.sendTelemetryEvent(eventName, properties);\n\t}\n\n\tpublic dispose() {\n\t\tif (this._reporter) {\n\t\t\tthis._reporter.dispose();\n\t\t\tthis._reporter = null;\n\t\t}\n\t}\n\n\t@memoize\n\tprivate get reporter(): VsCodeTelemetryReporter | null {\n\t\tif (this.packageInfo && this.packageInfo.aiKey) {\n\t\t\tthis._reporter = new VsCodeTelemetryReporter(\n\t\t\t\tthis.packageInfo.name,\n\t\t\t\tthis.packageInfo.version,\n\t\t\t\tthis.packageInfo.aiKey);\n\t\t\treturn this._reporter;\n\t\t}\n\t\treturn null;\n\t}\n\n\t@memoize\n\tprivate get packageInfo(): PackageInfo | null {\n\t\tconst { packageJSON } = vscode.extensions.getExtension('vscode.typescript-language-features')!;\n\t\tif (packageJSON) {\n\t\t\treturn {\n\t\t\t\tname: packageJSON.name,\n\t\t\t\tversion: packageJSON.version,\n\t\t\t\taiKey: packageJSON.aiKey\n\t\t\t};\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../protocol';\nimport { Logger } from './logger';\n\nenum Trace {\n\tOff,\n\tMessages,\n\tVerbose,\n}\n\nnamespace Trace {\n\texport function fromString(value: string): Trace {\n\t\tvalue = value.toLowerCase();\n\t\tswitch (value) {\n\t\t\tcase 'off':\n\t\t\t\treturn Trace.Off;\n\t\t\tcase 'messages':\n\t\t\t\treturn Trace.Messages;\n\t\t\tcase 'verbose':\n\t\t\t\treturn Trace.Verbose;\n\t\t\tdefault:\n\t\t\t\treturn Trace.Off;\n\t\t}\n\t}\n}\n\ninterface RequestExecutionMetadata {\n\treadonly queuingStartTime: number\n}\n\nexport default class Tracer {\n\tprivate trace?: Trace;\n\n\tconstructor(\n\t\tprivate readonly logger: Logger\n\t) {\n\t\tthis.updateConfiguration();\n\t}\n\n\tpublic updateConfiguration() {\n\t\tthis.trace = Tracer.readTrace();\n\t}\n\n\tprivate static readTrace(): Trace {\n\t\tlet result: Trace = Trace.fromString(vscode.workspace.getConfiguration().get<string>('typescript.tsserver.trace', 'off'));\n\t\tif (result === Trace.Off && !!process.env.TSS_TRACE) {\n\t\t\tresult = Trace.Messages;\n\t\t}\n\t\treturn result;\n\t}\n\n\tpublic traceRequest(serverId: string, request: Proto.Request, responseExpected: boolean, queueLength: number): void {\n\t\tif (this.trace === Trace.Off) {\n\t\t\treturn;\n\t\t}\n\t\tlet data: string | undefined = undefined;\n\t\tif (this.trace === Trace.Verbose && request.arguments) {\n\t\t\tdata = `Arguments: ${JSON.stringify(request.arguments, null, 4)}`;\n\t\t}\n\t\tthis.logTrace(serverId, `Sending request: ${request.command} (${request.seq}). Response expected: ${responseExpected ? 'yes' : 'no'}. Current queue length: ${queueLength}`, data);\n\t}\n\n\tpublic traceResponse(serverId: string, response: Proto.Response, meta: RequestExecutionMetadata): void {\n\t\tif (this.trace === Trace.Off) {\n\t\t\treturn;\n\t\t}\n\t\tlet data: string | undefined = undefined;\n\t\tif (this.trace === Trace.Verbose && response.body) {\n\t\t\tdata = `Result: ${JSON.stringify(response.body, null, 4)}`;\n\t\t}\n\t\tthis.logTrace(serverId, `Response received: ${response.command} (${response.request_seq}). Request took ${Date.now() - meta.queuingStartTime} ms. Success: ${response.success} ${!response.success ? '. Message: ' + response.message : ''}`, data);\n\t}\n\n\tpublic traceRequestCompleted(serverId: string, command: string, request_seq: number, meta: RequestExecutionMetadata): any {\n\t\tif (this.trace === Trace.Off) {\n\t\t\treturn;\n\t\t}\n\t\tthis.logTrace(serverId, `Async response received: ${command} (${request_seq}). Request took ${Date.now() - meta.queuingStartTime} ms.`);\n\t}\n\n\tpublic traceEvent(serverId: string, event: Proto.Event): void {\n\t\tif (this.trace === Trace.Off) {\n\t\t\treturn;\n\t\t}\n\t\tlet data: string | undefined = undefined;\n\t\tif (this.trace === Trace.Verbose && event.body) {\n\t\t\tdata = `Data: ${JSON.stringify(event.body, null, 4)}`;\n\t\t}\n\t\tthis.logTrace(serverId, `Event received: ${event.event} (${event.seq}).`, data);\n\t}\n\n\tpublic logTrace(serverId: string, message: string, data?: any): void {\n\t\tif (this.trace !== Trace.Off) {\n\t\t\tthis.logger.logLevel('Trace', `<${serverId}> ${message}`, data);\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as nls from 'vscode-nls';\nimport { CommandManager } from '../commands/commandManager';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport { ActiveJsTsEditorTracker } from '../utils/activeJsTsEditorTracker';\nimport { Disposable } from '../utils/dispose';\nimport { isSupportedLanguageMode, isTypeScriptDocument, jsTsLanguageModes } from '../utils/languageModeIds';\nimport { isImplicitProjectConfigFile, openOrCreateConfig, openProjectConfigForFile, openProjectConfigOrPromptToCreate, ProjectType } from '../utils/tsconfig';\n\nconst localize = nls.loadMessageBundle();\n\nnamespace IntellisenseState {\n\texport const enum Type { None, Pending, Resolved, SyntaxOnly }\n\n\texport const None = Object.freeze({ type: Type.None } as const);\n\n\texport const SyntaxOnly = Object.freeze({ type: Type.SyntaxOnly } as const);\n\n\texport class Pending {\n\t\tpublic readonly type = Type.Pending;\n\n\t\tpublic readonly cancellation = new vscode.CancellationTokenSource();\n\n\t\tconstructor(\n\t\t\tpublic readonly resource: vscode.Uri,\n\t\t\tpublic readonly projectType: ProjectType,\n\t\t) { }\n\t}\n\n\texport class Resolved {\n\t\tpublic readonly type = Type.Resolved;\n\n\t\tconstructor(\n\t\t\tpublic readonly resource: vscode.Uri,\n\t\t\tpublic readonly projectType: ProjectType,\n\t\t\tpublic readonly configFile: string,\n\t\t) { }\n\t}\n\n\texport type State = typeof None | Pending | Resolved | typeof SyntaxOnly;\n}\n\nexport class IntellisenseStatus extends Disposable {\n\n\tpublic readonly openOpenConfigCommandId = '_typescript.openConfig';\n\tpublic readonly createConfigCommandId = '_typescript.createConfig';\n\n\tprivate _statusItem?: vscode.LanguageStatusItem;\n\n\tprivate _ready = false;\n\tprivate _state: IntellisenseState.State = IntellisenseState.None;\n\n\tconstructor(\n\t\tprivate readonly _client: ITypeScriptServiceClient,\n\t\tcommandManager: CommandManager,\n\t\tprivate readonly _activeTextEditorManager: ActiveJsTsEditorTracker,\n\t) {\n\t\tsuper();\n\n\t\tcommandManager.register({\n\t\t\tid: this.openOpenConfigCommandId,\n\t\t\texecute: async (rootPath: string, projectType: ProjectType) => {\n\t\t\t\tif (this._state.type === IntellisenseState.Type.Resolved) {\n\t\t\t\t\tawait openProjectConfigOrPromptToCreate(projectType, this._client, rootPath, this._state.configFile);\n\t\t\t\t} else if (this._state.type === IntellisenseState.Type.Pending) {\n\t\t\t\t\tawait openProjectConfigForFile(projectType, this._client, this._state.resource);\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t\tcommandManager.register({\n\t\t\tid: this.createConfigCommandId,\n\t\t\texecute: async (rootPath: string, projectType: ProjectType) => {\n\t\t\t\tawait openOrCreateConfig(projectType, rootPath, this._client.configuration);\n\t\t\t},\n\t\t});\n\n\t\t_activeTextEditorManager.onDidChangeActiveJsTsEditor(this.updateStatus, this, this._disposables);\n\n\t\tthis._client.onReady(() => {\n\t\t\tthis._ready = true;\n\t\t\tthis.updateStatus();\n\t\t});\n\t}\n\n\toverride dispose() {\n\t\tsuper.dispose();\n\t\tthis._statusItem?.dispose();\n\t}\n\n\tprivate async updateStatus() {\n\t\tconst doc = this._activeTextEditorManager.activeJsTsEditor?.document;\n\t\tif (!doc || !isSupportedLanguageMode(doc)) {\n\t\t\tthis.updateState(IntellisenseState.None);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._client.hasCapabilityForResource(doc.uri, ClientCapability.Semantic)) {\n\t\t\tthis.updateState(IntellisenseState.SyntaxOnly);\n\t\t\treturn;\n\t\t}\n\n\t\tconst file = this._client.toOpenedFilePath(doc, { suppressAlertOnFailure: true });\n\t\tif (!file) {\n\t\t\tthis.updateState(IntellisenseState.None);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._ready) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst projectType = isTypeScriptDocument(doc) ? ProjectType.TypeScript : ProjectType.JavaScript;\n\n\t\tconst pendingState = new IntellisenseState.Pending(doc.uri, projectType);\n\t\tthis.updateState(pendingState);\n\n\t\tconst response = await this._client.execute('projectInfo', { file, needFileNameList: false }, pendingState.cancellation.token);\n\t\tif (response.type === 'response' && response.body) {\n\t\t\tif (this._state === pendingState) {\n\t\t\t\tthis.updateState(new IntellisenseState.Resolved(doc.uri, projectType, response.body.configFileName));\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate updateState(newState: IntellisenseState.State): void {\n\t\tif (this._state === newState) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._state.type === IntellisenseState.Type.Pending) {\n\t\t\tthis._state.cancellation.cancel();\n\t\t\tthis._state.cancellation.dispose();\n\t\t}\n\n\t\tthis._state = newState;\n\n\t\tswitch (this._state.type) {\n\t\t\tcase IntellisenseState.Type.None:\n\t\t\t\tthis._statusItem?.dispose();\n\t\t\t\tthis._statusItem = undefined;\n\t\t\t\tbreak;\n\n\t\t\tcase IntellisenseState.Type.Pending:\n\t\t\t\t{\n\t\t\t\t\tconst statusItem = this.ensureStatusItem();\n\t\t\t\t\tstatusItem.severity = vscode.LanguageStatusSeverity.Information;\n\t\t\t\t\tstatusItem.text = '$(loading~spin)';\n\t\t\t\t\tstatusItem.detail = localize('pending.detail', 'Loading IntelliSense status');\n\t\t\t\t\tstatusItem.command = undefined;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\tcase IntellisenseState.Type.Resolved:\n\t\t\t\t{\n\t\t\t\t\tconst rootPath = this._client.getWorkspaceRootForResource(this._state.resource);\n\t\t\t\t\tif (!rootPath) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst statusItem = this.ensureStatusItem();\n\t\t\t\t\tstatusItem.severity = vscode.LanguageStatusSeverity.Information;\n\t\t\t\t\tif (isImplicitProjectConfigFile(this._state.configFile)) {\n\t\t\t\t\t\tstatusItem.text = this._state.projectType === ProjectType.TypeScript\n\t\t\t\t\t\t\t? localize('resolved.detail.noTsConfig', \"No tsconfig\")\n\t\t\t\t\t\t\t: localize('resolved.detail.noJsConfig', \"No jsconfig\");\n\n\t\t\t\t\t\tstatusItem.detail = undefined;\n\t\t\t\t\t\tstatusItem.command = {\n\t\t\t\t\t\t\tcommand: this.createConfigCommandId,\n\t\t\t\t\t\t\ttitle: this._state.projectType === ProjectType.TypeScript\n\t\t\t\t\t\t\t\t? localize('resolved.command.title.createTsconfig', \"Create tsconfig\")\n\t\t\t\t\t\t\t\t: localize('resolved.command.title.createJsconfig', \"Create jsconfig\"),\n\t\t\t\t\t\t\targuments: [rootPath],\n\t\t\t\t\t\t};\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstatusItem.text = vscode.workspace.asRelativePath(this._state.configFile);\n\t\t\t\t\t\tstatusItem.detail = undefined;\n\t\t\t\t\t\tstatusItem.command = {\n\t\t\t\t\t\t\tcommand: this.openOpenConfigCommandId,\n\t\t\t\t\t\t\ttitle: localize('resolved.command.title.open', \"Open config file\"),\n\t\t\t\t\t\t\targuments: [rootPath],\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase IntellisenseState.Type.SyntaxOnly:\n\t\t\t\t{\n\t\t\t\t\tconst statusItem = this.ensureStatusItem();\n\t\t\t\t\tstatusItem.severity = vscode.LanguageStatusSeverity.Warning;\n\t\t\t\t\tstatusItem.text = localize('syntaxOnly.text', 'Partial Mode');\n\t\t\t\t\tstatusItem.detail = localize('syntaxOnly.detail', 'Project Wide IntelliSense not available');\n\t\t\t\t\tstatusItem.command = {\n\t\t\t\t\t\ttitle: localize('syntaxOnly.command.title.learnMore', \"Learn More\"),\n\t\t\t\t\t\tcommand: 'vscode.open',\n\t\t\t\t\t\targuments: [\n\t\t\t\t\t\t\tvscode.Uri.parse('https://aka.ms/vscode/jsts/partial-mode'),\n\t\t\t\t\t\t]\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t}\n\t}\n\n\tprivate ensureStatusItem(): vscode.LanguageStatusItem {\n\t\tif (!this._statusItem) {\n\t\t\tthis._statusItem = vscode.languages.createLanguageStatusItem('typescript.projectStatus', jsTsLanguageModes);\n\t\t\tthis._statusItem.name = localize('statusItem.name', \"JS/TS IntelliSense Status\");\n\t\t}\n\t\treturn this._statusItem;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as nls from 'vscode-nls';\nimport { SelectTypeScriptVersionCommand } from '../commands/selectTypeScriptVersion';\nimport { TypeScriptVersion } from '../tsServer/versionProvider';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport { Disposable } from '../utils/dispose';\nimport { jsTsLanguageModes } from '../utils/languageModeIds';\n\nconst localize = nls.loadMessageBundle();\n\nexport class VersionStatus extends Disposable {\n\n\tprivate readonly _statusItem: vscode.LanguageStatusItem;\n\n\tconstructor(\n\t\tprivate readonly _client: ITypeScriptServiceClient,\n\t) {\n\t\tsuper();\n\n\t\tthis._statusItem = this._register(vscode.languages.createLanguageStatusItem('typescript.version', jsTsLanguageModes));\n\n\t\tthis._statusItem.name = localize('versionStatus.name', \"TypeScript Version\");\n\t\tthis._statusItem.detail = localize('versionStatus.detail', \"TypeScript Version\");\n\n\t\tthis._register(this._client.onTsServerStarted(({ version }) => this.onDidChangeTypeScriptVersion(version)));\n\t}\n\n\tprivate onDidChangeTypeScriptVersion(version: TypeScriptVersion) {\n\t\tthis._statusItem.text = version.displayName;\n\t\tthis._statusItem.command = {\n\t\t\tcommand: SelectTypeScriptVersionCommand.id,\n\t\t\ttitle: localize('versionStatus.command', \"Select Version\"),\n\t\t\ttooltip: version.path\n\t\t};\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { loadMessageBundle } from 'vscode-nls';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport { TelemetryReporter } from './telemetry';\nimport { isImplicitProjectConfigFile, openOrCreateConfig, ProjectType } from './tsconfig';\n\nconst localize = loadMessageBundle();\n\ninterface Hint {\n\tmessage: string;\n}\n\nclass ExcludeHintItem {\n\tpublic configFileName?: string;\n\tprivate _item: vscode.StatusBarItem;\n\tprivate _currentHint?: Hint;\n\n\tconstructor(\n\t\tprivate readonly telemetryReporter: TelemetryReporter\n\t) {\n\t\tthis._item = vscode.window.createStatusBarItem('status.typescript.exclude', vscode.StatusBarAlignment.Right, 98 /* to the right of typescript version status (99) */);\n\t\tthis._item.name = localize('statusExclude', \"TypeScript: Configure Excludes\");\n\t\tthis._item.command = 'js.projectStatus.command';\n\t}\n\n\tpublic getCurrentHint(): Hint {\n\t\treturn this._currentHint!;\n\t}\n\n\tpublic hide() {\n\t\tthis._item.hide();\n\t}\n\n\tpublic show(largeRoots?: string) {\n\t\tthis._currentHint = {\n\t\t\tmessage: largeRoots\n\t\t\t\t? localize('hintExclude', \"To enable project-wide JavaScript/TypeScript language features, exclude folders with many files, like: {0}\", largeRoots)\n\t\t\t\t: localize('hintExclude.generic', \"To enable project-wide JavaScript/TypeScript language features, exclude large folders with source files that you do not work on.\")\n\t\t};\n\t\tthis._item.tooltip = this._currentHint.message;\n\t\tthis._item.text = localize('large.label', \"Configure Excludes\");\n\t\tthis._item.tooltip = localize('hintExclude.tooltip', \"To enable project-wide JavaScript/TypeScript language features, exclude large folders with source files that you do not work on.\");\n\t\tthis._item.color = '#A5DF3B';\n\t\tthis._item.show();\n\t\t/* __GDPR__\n\t\t\t\"js.hintProjectExcludes\" : {\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t]\n\t\t\t}\n\t\t*/\n\t\tthis.telemetryReporter.logTelemetry('js.hintProjectExcludes');\n\t}\n}\n\n\nfunction createLargeProjectMonitorFromTypeScript(item: ExcludeHintItem, client: ITypeScriptServiceClient): vscode.Disposable {\n\n\tinterface LargeProjectMessageItem extends vscode.MessageItem {\n\t\tindex: number;\n\t}\n\n\treturn client.onProjectLanguageServiceStateChanged(body => {\n\t\tif (body.languageServiceEnabled) {\n\t\t\titem.hide();\n\t\t} else {\n\t\t\titem.show();\n\t\t\tconst configFileName = body.projectName;\n\t\t\tif (configFileName) {\n\t\t\t\titem.configFileName = configFileName;\n\t\t\t\tvscode.window.showWarningMessage<LargeProjectMessageItem>(item.getCurrentHint().message,\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: localize('large.label', \"Configure Excludes\"),\n\t\t\t\t\t\tindex: 0\n\t\t\t\t\t}).then(selected => {\n\t\t\t\t\t\tif (selected && selected.index === 0) {\n\t\t\t\t\t\t\tonConfigureExcludesSelected(client, configFileName);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction onConfigureExcludesSelected(\n\tclient: ITypeScriptServiceClient,\n\tconfigFileName: string\n) {\n\tif (!isImplicitProjectConfigFile(configFileName)) {\n\t\tvscode.workspace.openTextDocument(configFileName)\n\t\t\t.then(vscode.window.showTextDocument);\n\t} else {\n\t\tconst root = client.getWorkspaceRootForResource(vscode.Uri.file(configFileName));\n\t\tif (root) {\n\t\t\topenOrCreateConfig(\n\t\t\t\t/tsconfig\\.?.*\\.json/.test(configFileName) ? ProjectType.TypeScript : ProjectType.JavaScript,\n\t\t\t\troot,\n\t\t\t\tclient.configuration);\n\t\t}\n\t}\n}\n\nexport function create(\n\tclient: ITypeScriptServiceClient,\n): vscode.Disposable {\n\tconst toDispose: vscode.Disposable[] = [];\n\n\tconst item = new ExcludeHintItem(client.telemetryReporter);\n\ttoDispose.push(vscode.commands.registerCommand('js.projectStatus.command', () => {\n\t\tif (item.configFileName) {\n\t\t\tonConfigureExcludesSelected(client, item.configFileName);\n\t\t}\n\t\tconst { message } = item.getCurrentHint();\n\t\treturn vscode.window.showInformationMessage(message);\n\t}));\n\n\ttoDispose.push(createLargeProjectMonitorFromTypeScript(item, client));\n\n\treturn vscode.Disposable.from(...toDispose);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { localize } from '../tsServer/versionProvider';\nimport { TsServerLogLevel } from './configuration';\nimport { Disposable } from './dispose';\n\nexport class LogLevelMonitor extends Disposable {\n\n\tprivate static readonly logLevelConfigKey = 'typescript.tsserver.log';\n\tprivate static readonly logLevelChangedStorageKey = 'typescript.tsserver.logLevelChanged';\n\tprivate static readonly doNotPromptLogLevelStorageKey = 'typescript.tsserver.doNotPromptLogLevel';\n\n\tconstructor(private readonly context: vscode.ExtensionContext) {\n\t\tsuper();\n\n\t\tthis._register(vscode.workspace.onDidChangeConfiguration(this.onConfigurationChange, this, this._disposables));\n\n\t\tif (this.shouldNotifyExtendedLogging()) {\n\t\t\tthis.notifyExtendedLogging();\n\t\t}\n\t}\n\n\tprivate onConfigurationChange(event: vscode.ConfigurationChangeEvent) {\n\t\tconst logLevelChanged = event.affectsConfiguration(LogLevelMonitor.logLevelConfigKey);\n\t\tif (!logLevelChanged) {\n\t\t\treturn;\n\t\t}\n\t\tthis.context.globalState.update(LogLevelMonitor.logLevelChangedStorageKey, new Date());\n\t}\n\n\tprivate get logLevel(): TsServerLogLevel {\n\t\treturn TsServerLogLevel.fromString(vscode.workspace.getConfiguration().get<string>(LogLevelMonitor.logLevelConfigKey, 'off'));\n\t}\n\n\t/**\n\t * Last date change if it exists and can be parsed as a date,\n\t * otherwise undefined.\n\t */\n\tprivate get lastLogLevelChange(): Date | undefined {\n\t\tconst lastChange = this.context.globalState.get<string | undefined>(LogLevelMonitor.logLevelChangedStorageKey);\n\n\t\tif (lastChange) {\n\t\t\tconst date = new Date(lastChange);\n\t\t\tif (date instanceof Date && !isNaN(date.valueOf())) {\n\t\t\t\treturn date;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate get doNotPrompt(): boolean {\n\t\treturn this.context.globalState.get<boolean | undefined>(LogLevelMonitor.doNotPromptLogLevelStorageKey) || false;\n\t}\n\n\tprivate shouldNotifyExtendedLogging(): boolean {\n\t\tconst lastChangeMilliseconds = this.lastLogLevelChange ? new Date(this.lastLogLevelChange).valueOf() : 0;\n\t\tconst lastChangePlusOneWeek = new Date(lastChangeMilliseconds + /* 7 days in milliseconds */ 86400000 * 7);\n\n\t\tif (!this.doNotPrompt && this.logLevel !== TsServerLogLevel.Off && lastChangePlusOneWeek.valueOf() < Date.now()) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate notifyExtendedLogging() {\n\t\tconst enum Choice {\n\t\t\tDisableLogging = 0,\n\t\t\tDoNotShowAgain = 1\n\t\t}\n\t\tinterface Item extends vscode.MessageItem {\n\t\t\treadonly choice: Choice;\n\t\t}\n\n\t\tvscode.window.showInformationMessage<Item>(\n\t\t\tlocalize(\n\t\t\t\t'typescript.extendedLogging.isEnabled',\n\t\t\t\t\"TS Server logging is currently enabled which may impact performance.\"),\n\t\t\t{\n\t\t\t\ttitle: localize(\n\t\t\t\t\t'typescript.extendedLogging.disableLogging',\n\t\t\t\t\t\"Disable logging\"),\n\t\t\t\tchoice: Choice.DisableLogging\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: localize(\n\t\t\t\t\t'typescript.extendedLogging.doNotShowAgain',\n\t\t\t\t\t\"Don't show again\"),\n\t\t\t\tchoice: Choice.DoNotShowAgain\n\t\t\t})\n\t\t\t.then(selection => {\n\t\t\t\tif (!selection) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (selection.choice === Choice.DisableLogging) {\n\t\t\t\t\treturn vscode.workspace.getConfiguration().update(LogLevelMonitor.logLevelConfigKey, 'off', true);\n\t\t\t\t} else if (selection.choice === Choice.DoNotShowAgain) {\n\t\t\t\t\treturn this.context.globalState.update(LogLevelMonitor.doNotPromptLogLevelStorageKey, true);\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t});\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { loadMessageBundle } from 'vscode-nls';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport { Disposable } from './dispose';\n\nconst localize = loadMessageBundle();\n\nconst typingsInstallTimeout = 30 * 1000;\n\nexport default class TypingsStatus extends Disposable {\n\tprivate readonly _acquiringTypings = new Map<number, NodeJS.Timer>();\n\tprivate readonly _client: ITypeScriptServiceClient;\n\n\tconstructor(client: ITypeScriptServiceClient) {\n\t\tsuper();\n\t\tthis._client = client;\n\n\t\tthis._register(\n\t\t\tthis._client.onDidBeginInstallTypings(event => this.onBeginInstallTypings(event.eventId)));\n\n\t\tthis._register(\n\t\t\tthis._client.onDidEndInstallTypings(event => this.onEndInstallTypings(event.eventId)));\n\t}\n\n\tpublic override dispose(): void {\n\t\tsuper.dispose();\n\n\t\tfor (const timeout of this._acquiringTypings.values()) {\n\t\t\tclearTimeout(timeout);\n\t\t}\n\t}\n\n\tpublic get isAcquiringTypings(): boolean {\n\t\treturn Object.keys(this._acquiringTypings).length > 0;\n\t}\n\n\tprivate onBeginInstallTypings(eventId: number): void {\n\t\tif (this._acquiringTypings.has(eventId)) {\n\t\t\treturn;\n\t\t}\n\t\tthis._acquiringTypings.set(eventId, setTimeout(() => {\n\t\t\tthis.onEndInstallTypings(eventId);\n\t\t}, typingsInstallTimeout));\n\t}\n\n\tprivate onEndInstallTypings(eventId: number): void {\n\t\tconst timer = this._acquiringTypings.get(eventId);\n\t\tif (timer) {\n\t\t\tclearTimeout(timer);\n\t\t}\n\t\tthis._acquiringTypings.delete(eventId);\n\t}\n}\n\nexport class AtaProgressReporter extends Disposable {\n\n\tprivate readonly _promises = new Map<number, Function>();\n\n\tconstructor(client: ITypeScriptServiceClient) {\n\t\tsuper();\n\t\tthis._register(client.onDidBeginInstallTypings(e => this._onBegin(e.eventId)));\n\t\tthis._register(client.onDidEndInstallTypings(e => this._onEndOrTimeout(e.eventId)));\n\t\tthis._register(client.onTypesInstallerInitializationFailed(_ => this.onTypesInstallerInitializationFailed()));\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\t\tthis._promises.forEach(value => value());\n\t}\n\n\tprivate _onBegin(eventId: number): void {\n\t\tconst handle = setTimeout(() => this._onEndOrTimeout(eventId), typingsInstallTimeout);\n\t\tconst promise = new Promise<void>(resolve => {\n\t\t\tthis._promises.set(eventId, () => {\n\t\t\t\tclearTimeout(handle);\n\t\t\t\tresolve();\n\t\t\t});\n\t\t});\n\n\t\tvscode.window.withProgress({\n\t\t\tlocation: vscode.ProgressLocation.Window,\n\t\t\ttitle: localize('installingPackages', \"Fetching data for better TypeScript IntelliSense\")\n\t\t}, () => promise);\n\t}\n\n\tprivate _onEndOrTimeout(eventId: number): void {\n\t\tconst resolve = this._promises.get(eventId);\n\t\tif (resolve) {\n\t\t\tthis._promises.delete(eventId);\n\t\t\tresolve();\n\t\t}\n\t}\n\n\tprivate async onTypesInstallerInitializationFailed() {\n\t\tconst config = vscode.workspace.getConfiguration('typescript');\n\n\t\tif (config.get<boolean>('check.npmIsInstalled', true)) {\n\t\t\tconst dontShowAgain: vscode.MessageItem = {\n\t\t\t\ttitle: localize('typesInstallerInitializationFailed.doNotCheckAgain', \"Don't Show Again\"),\n\t\t\t};\n\t\t\tconst selected = await vscode.window.showWarningMessage(\n\t\t\t\tlocalize(\n\t\t\t\t\t'typesInstallerInitializationFailed.title',\n\t\t\t\t\t\"Could not install typings files for JavaScript language features. Please ensure that NPM is installed or configure 'typescript.npm' in your user settings. Click [here]({0}) to learn more.\",\n\t\t\t\t\t'https://go.microsoft.com/fwlink/?linkid=847635'\n\t\t\t\t),\n\t\t\t\tdontShowAgain);\n\n\t\t\tif (selected === dontShowAgain) {\n\t\t\t\tconfig.update('check.npmIsInstalled', false, true);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as path from 'path';\nimport * as vscode from 'vscode';\nimport * as nls from 'vscode-nls';\nimport type * as Proto from '../protocol';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport API from '../utils/api';\nimport { Delayer } from '../utils/async';\nimport { nulToken } from '../utils/cancellation';\nimport { conditionalRegistration, requireMinVersion, requireSomeCapability } from '../utils/dependentRegistration';\nimport { Disposable } from '../utils/dispose';\nimport * as fileSchemes from '../utils/fileSchemes';\nimport { doesResourceLookLikeATypeScriptFile } from '../utils/languageDescription';\nimport * as typeConverters from '../utils/typeConverters';\nimport FileConfigurationManager from './fileConfigurationManager';\n\nconst localize = nls.loadMessageBundle();\n\nconst updateImportsOnFileMoveName = 'updateImportsOnFileMove.enabled';\n\nasync function isDirectory(resource: vscode.Uri): Promise<boolean> {\n\ttry {\n\t\treturn (await vscode.workspace.fs.stat(resource)).type === vscode.FileType.Directory;\n\t} catch {\n\t\treturn false;\n\t}\n}\n\nconst enum UpdateImportsOnFileMoveSetting {\n\tPrompt = 'prompt',\n\tAlways = 'always',\n\tNever = 'never',\n}\n\ninterface RenameAction {\n\treadonly oldUri: vscode.Uri;\n\treadonly newUri: vscode.Uri;\n\treadonly newFilePath: string;\n\treadonly oldFilePath: string;\n\treadonly jsTsFileThatIsBeingMoved: vscode.Uri;\n}\n\nclass UpdateImportsOnFileRenameHandler extends Disposable {\n\tpublic static readonly minVersion = API.v300;\n\n\tprivate readonly _delayer = new Delayer(50);\n\tprivate readonly _pendingRenames = new Set<RenameAction>();\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly fileConfigurationManager: FileConfigurationManager,\n\t\tprivate readonly _handles: (uri: vscode.Uri) => Promise<boolean>,\n\t) {\n\t\tsuper();\n\n\t\tthis._register(vscode.workspace.onDidRenameFiles(async (e) => {\n\t\t\tconst [{ newUri, oldUri }] = e.files;\n\t\t\tconst newFilePath = this.client.toPath(newUri);\n\t\t\tif (!newFilePath) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst oldFilePath = this.client.toPath(oldUri);\n\t\t\tif (!oldFilePath) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst config = this.getConfiguration(newUri);\n\t\t\tconst setting = config.get<UpdateImportsOnFileMoveSetting>(updateImportsOnFileMoveName);\n\t\t\tif (setting === UpdateImportsOnFileMoveSetting.Never) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Try to get a js/ts file that is being moved\n\t\t\t// For directory moves, this returns a js/ts file under the directory.\n\t\t\tconst jsTsFileThatIsBeingMoved = await this.getJsTsFileBeingMoved(newUri);\n\t\t\tif (!jsTsFileThatIsBeingMoved || !this.client.toPath(jsTsFileThatIsBeingMoved)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._pendingRenames.add({ oldUri, newUri, newFilePath, oldFilePath, jsTsFileThatIsBeingMoved });\n\n\t\t\tthis._delayer.trigger(() => {\n\t\t\t\tvscode.window.withProgress({\n\t\t\t\t\tlocation: vscode.ProgressLocation.Window,\n\t\t\t\t\ttitle: localize('renameProgress.title', \"Checking for update of JS/TS imports\")\n\t\t\t\t}, () => this.flushRenames());\n\t\t\t});\n\t\t}));\n\t}\n\n\tprivate async flushRenames(): Promise<void> {\n\t\tconst renames = Array.from(this._pendingRenames);\n\t\tthis._pendingRenames.clear();\n\t\tfor (const group of this.groupRenames(renames)) {\n\t\t\tconst edits = new vscode.WorkspaceEdit();\n\t\t\tconst resourcesBeingRenamed: vscode.Uri[] = [];\n\n\t\t\tfor (const { oldUri, newUri, newFilePath, oldFilePath, jsTsFileThatIsBeingMoved } of group) {\n\t\t\t\tconst document = await vscode.workspace.openTextDocument(jsTsFileThatIsBeingMoved);\n\n\t\t\t\t// Make sure TS knows about file\n\t\t\t\tthis.client.bufferSyncSupport.closeResource(oldUri);\n\t\t\t\tthis.client.bufferSyncSupport.openTextDocument(document);\n\n\t\t\t\tif (await this.withEditsForFileRename(edits, document, oldFilePath, newFilePath)) {\n\t\t\t\t\tresourcesBeingRenamed.push(newUri);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (edits.size) {\n\t\t\t\tif (await this.confirmActionWithUser(resourcesBeingRenamed)) {\n\t\t\t\t\tawait vscode.workspace.applyEdit(edits);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate async confirmActionWithUser(newResources: readonly vscode.Uri[]): Promise<boolean> {\n\t\tif (!newResources.length) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst config = this.getConfiguration(newResources[0]);\n\t\tconst setting = config.get<UpdateImportsOnFileMoveSetting>(updateImportsOnFileMoveName);\n\t\tswitch (setting) {\n\t\t\tcase UpdateImportsOnFileMoveSetting.Always:\n\t\t\t\treturn true;\n\t\t\tcase UpdateImportsOnFileMoveSetting.Never:\n\t\t\t\treturn false;\n\t\t\tcase UpdateImportsOnFileMoveSetting.Prompt:\n\t\t\tdefault:\n\t\t\t\treturn this.promptUser(newResources);\n\t\t}\n\t}\n\n\tprivate getConfiguration(resource: vscode.Uri) {\n\t\treturn vscode.workspace.getConfiguration(doesResourceLookLikeATypeScriptFile(resource) ? 'typescript' : 'javascript', resource);\n\t}\n\n\tprivate async promptUser(newResources: readonly vscode.Uri[]): Promise<boolean> {\n\t\tif (!newResources.length) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst enum Choice {\n\t\t\tNone = 0,\n\t\t\tAccept = 1,\n\t\t\tReject = 2,\n\t\t\tAlways = 3,\n\t\t\tNever = 4,\n\t\t}\n\n\t\tinterface Item extends vscode.MessageItem {\n\t\t\treadonly choice: Choice;\n\t\t}\n\n\n\t\tconst response = await vscode.window.showInformationMessage<Item>(\n\t\t\tnewResources.length === 1\n\t\t\t\t? localize('prompt', \"Update imports for '{0}'?\", path.basename(newResources[0].fsPath))\n\t\t\t\t: this.getConfirmMessage(localize('promptMoreThanOne', \"Update imports for the following {0} files?\", newResources.length), newResources), {\n\t\t\tmodal: true,\n\t\t}, {\n\t\t\ttitle: localize('reject.title', \"No\"),\n\t\t\tchoice: Choice.Reject,\n\t\t\tisCloseAffordance: true,\n\t\t}, {\n\t\t\ttitle: localize('accept.title', \"Yes\"),\n\t\t\tchoice: Choice.Accept,\n\t\t}, {\n\t\t\ttitle: localize('always.title', \"Always automatically update imports\"),\n\t\t\tchoice: Choice.Always,\n\t\t}, {\n\t\t\ttitle: localize('never.title', \"Never automatically update imports\"),\n\t\t\tchoice: Choice.Never,\n\t\t});\n\n\t\tif (!response) {\n\t\t\treturn false;\n\t\t}\n\n\t\tswitch (response.choice) {\n\t\t\tcase Choice.Accept:\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\tcase Choice.Reject:\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\tcase Choice.Always:\n\t\t\t\t{\n\t\t\t\t\tconst config = this.getConfiguration(newResources[0]);\n\t\t\t\t\tconfig.update(\n\t\t\t\t\t\tupdateImportsOnFileMoveName,\n\t\t\t\t\t\tUpdateImportsOnFileMoveSetting.Always,\n\t\t\t\t\t\tvscode.ConfigurationTarget.Global);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\tcase Choice.Never:\n\t\t\t\t{\n\t\t\t\t\tconst config = this.getConfiguration(newResources[0]);\n\t\t\t\t\tconfig.update(\n\t\t\t\t\t\tupdateImportsOnFileMoveName,\n\t\t\t\t\t\tUpdateImportsOnFileMoveSetting.Never,\n\t\t\t\t\t\tvscode.ConfigurationTarget.Global);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tprivate async getJsTsFileBeingMoved(resource: vscode.Uri): Promise<vscode.Uri | undefined> {\n\t\tif (resource.scheme !== fileSchemes.file) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (await isDirectory(resource)) {\n\t\t\tconst files = await vscode.workspace.findFiles({\n\t\t\t\tbase: resource.fsPath,\n\t\t\t\tpattern: '**/*.{ts,tsx,js,jsx}',\n\t\t\t}, '**/node_modules/**', 1);\n\t\t\treturn files[0];\n\t\t}\n\n\t\treturn (await this._handles(resource)) ? resource : undefined;\n\t}\n\n\tprivate async withEditsForFileRename(\n\t\tedits: vscode.WorkspaceEdit,\n\t\tdocument: vscode.TextDocument,\n\t\toldFilePath: string,\n\t\tnewFilePath: string,\n\t): Promise<boolean> {\n\t\tconst response = await this.client.interruptGetErr(() => {\n\t\t\tthis.fileConfigurationManager.setGlobalConfigurationFromDocument(document, nulToken);\n\t\t\tconst args: Proto.GetEditsForFileRenameRequestArgs = {\n\t\t\t\toldFilePath,\n\t\t\t\tnewFilePath,\n\t\t\t};\n\t\t\treturn this.client.execute('getEditsForFileRename', args, nulToken);\n\t\t});\n\t\tif (response.type !== 'response' || !response.body.length) {\n\t\t\treturn false;\n\t\t}\n\n\t\ttypeConverters.WorkspaceEdit.withFileCodeEdits(edits, this.client, response.body);\n\t\treturn true;\n\t}\n\n\tprivate groupRenames(renames: Iterable<RenameAction>): Iterable<Iterable<RenameAction>> {\n\t\tconst groups = new Map<string, Set<RenameAction>>();\n\n\t\tfor (const rename of renames) {\n\t\t\t// Group renames by type (js/ts) and by workspace.\n\t\t\tconst key = `${this.client.getWorkspaceRootForResource(rename.jsTsFileThatIsBeingMoved)}@@@${doesResourceLookLikeATypeScriptFile(rename.jsTsFileThatIsBeingMoved)}`;\n\t\t\tif (!groups.has(key)) {\n\t\t\t\tgroups.set(key, new Set());\n\t\t\t}\n\t\t\tgroups.get(key)!.add(rename);\n\t\t}\n\n\t\treturn groups.values();\n\t}\n\n\tprivate getConfirmMessage(start: string, resourcesToConfirm: readonly vscode.Uri[]): string {\n\t\tconst MAX_CONFIRM_FILES = 10;\n\n\t\tconst paths = [start];\n\t\tpaths.push('');\n\t\tpaths.push(...resourcesToConfirm.slice(0, MAX_CONFIRM_FILES).map(r => path.basename(r.fsPath)));\n\n\t\tif (resourcesToConfirm.length > MAX_CONFIRM_FILES) {\n\t\t\tif (resourcesToConfirm.length - MAX_CONFIRM_FILES === 1) {\n\t\t\t\tpaths.push(localize('moreFile', \"...1 additional file not shown\"));\n\t\t\t} else {\n\t\t\t\tpaths.push(localize('moreFiles', \"...{0} additional files not shown\", resourcesToConfirm.length - MAX_CONFIRM_FILES));\n\t\t\t}\n\t\t}\n\n\t\tpaths.push('');\n\t\treturn paths.join('\\n');\n\t}\n}\n\nexport function register(\n\tclient: ITypeScriptServiceClient,\n\tfileConfigurationManager: FileConfigurationManager,\n\thandles: (uri: vscode.Uri) => Promise<boolean>,\n) {\n\treturn conditionalRegistration([\n\t\trequireMinVersion(client, UpdateImportsOnFileRenameHandler.minVersion),\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\treturn new UpdateImportsOnFileRenameHandler(client, fileConfigurationManager, handles);\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { basename } from 'path';\nimport * as vscode from 'vscode';\nimport * as languageModeIds from './languageModeIds';\n\nexport const enum DiagnosticLanguage {\n\tJavaScript,\n\tTypeScript\n}\n\nexport const allDiagnosticLanguages = [DiagnosticLanguage.JavaScript, DiagnosticLanguage.TypeScript];\n\nexport interface LanguageDescription {\n\treadonly id: string;\n\treadonly diagnosticOwner: string;\n\treadonly diagnosticSource: string;\n\treadonly diagnosticLanguage: DiagnosticLanguage;\n\treadonly modeIds: readonly string[];\n\treadonly configFilePattern?: RegExp;\n\treadonly isExternal?: boolean;\n\treadonly standardFileExtensions: readonly string[],\n}\n\nexport const standardLanguageDescriptions: LanguageDescription[] = [\n\t{\n\t\tid: 'typescript',\n\t\tdiagnosticOwner: 'typescript',\n\t\tdiagnosticSource: 'ts',\n\t\tdiagnosticLanguage: DiagnosticLanguage.TypeScript,\n\t\tmodeIds: [languageModeIds.typescript, languageModeIds.typescriptreact],\n\t\tconfigFilePattern: /^tsconfig(\\..*)?\\.json$/gi,\n\t\tstandardFileExtensions: [\n\t\t\t'ts',\n\t\t\t'tsx',\n\t\t\t'cts',\n\t\t\t'mts'\n\t\t],\n\t}, {\n\t\tid: 'javascript',\n\t\tdiagnosticOwner: 'typescript',\n\t\tdiagnosticSource: 'ts',\n\t\tdiagnosticLanguage: DiagnosticLanguage.JavaScript,\n\t\tmodeIds: [languageModeIds.javascript, languageModeIds.javascriptreact],\n\t\tconfigFilePattern: /^jsconfig(\\..*)?\\.json$/gi,\n\t\tstandardFileExtensions: [\n\t\t\t'js',\n\t\t\t'jsx',\n\t\t\t'cjs',\n\t\t\t'mjs',\n\t\t\t'es6',\n\t\t\t'pac',\n\t\t],\n\t}\n];\n\nexport function isTsConfigFileName(fileName: string): boolean {\n\treturn /^tsconfig\\.(.+\\.)?json$/i.test(basename(fileName));\n}\n\nexport function isJsConfigOrTsConfigFileName(fileName: string): boolean {\n\treturn /^[jt]sconfig\\.(.+\\.)?json$/i.test(basename(fileName));\n}\n\nexport function doesResourceLookLikeATypeScriptFile(resource: vscode.Uri): boolean {\n\treturn /\\.(tsx?|mts|cts)$/i.test(resource.fsPath);\n}\n\nexport function doesResourceLookLikeAJavaScriptFile(resource: vscode.Uri): boolean {\n\treturn /\\.(jsx?|mjs|cjs)$/i.test(resource.fsPath);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../protocol';\nimport * as PConst from '../protocol.const';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport API from '../utils/api';\nimport * as fileSchemes from '../utils/fileSchemes';\nimport { doesResourceLookLikeAJavaScriptFile, doesResourceLookLikeATypeScriptFile } from '../utils/languageDescription';\nimport { parseKindModifier } from '../utils/modifiers';\nimport * as typeConverters from '../utils/typeConverters';\n\nfunction getSymbolKind(item: Proto.NavtoItem): vscode.SymbolKind {\n\tswitch (item.kind) {\n\t\tcase PConst.Kind.method: return vscode.SymbolKind.Method;\n\t\tcase PConst.Kind.enum: return vscode.SymbolKind.Enum;\n\t\tcase PConst.Kind.enumMember: return vscode.SymbolKind.EnumMember;\n\t\tcase PConst.Kind.function: return vscode.SymbolKind.Function;\n\t\tcase PConst.Kind.class: return vscode.SymbolKind.Class;\n\t\tcase PConst.Kind.interface: return vscode.SymbolKind.Interface;\n\t\tcase PConst.Kind.type: return vscode.SymbolKind.Class;\n\t\tcase PConst.Kind.memberVariable: return vscode.SymbolKind.Field;\n\t\tcase PConst.Kind.memberGetAccessor: return vscode.SymbolKind.Field;\n\t\tcase PConst.Kind.memberSetAccessor: return vscode.SymbolKind.Field;\n\t\tcase PConst.Kind.variable: return vscode.SymbolKind.Variable;\n\t\tdefault: return vscode.SymbolKind.Variable;\n\t}\n}\n\nclass TypeScriptWorkspaceSymbolProvider implements vscode.WorkspaceSymbolProvider {\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly modeIds: readonly string[],\n\t) { }\n\n\tpublic async provideWorkspaceSymbols(\n\t\tsearch: string,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.SymbolInformation[]> {\n\t\tlet file: string | undefined;\n\t\tif (this.searchAllOpenProjects) {\n\t\t\tfile = undefined;\n\t\t} else {\n\t\t\tconst document = this.getDocument();\n\t\t\tfile = document ? await this.toOpenedFiledPath(document) : undefined;\n\n\t\t\tif (!file && this.client.apiVersion.lt(API.v390)) {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t}\n\n\t\tconst args: Proto.NavtoRequestArgs = {\n\t\t\tfile,\n\t\t\tsearchValue: search,\n\t\t\tmaxResultCount: 256,\n\t\t};\n\n\t\tconst response = await this.client.execute('navto', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn [];\n\t\t}\n\n\t\treturn response.body\n\t\t\t.filter(item => item.containerName || item.kind !== 'alias')\n\t\t\t.map(item => this.toSymbolInformation(item));\n\t}\n\n\tprivate get searchAllOpenProjects() {\n\t\treturn this.client.apiVersion.gte(API.v390)\n\t\t\t&& vscode.workspace.getConfiguration('typescript').get('workspaceSymbols.scope', 'allOpenProjects') === 'allOpenProjects';\n\t}\n\n\tprivate async toOpenedFiledPath(document: vscode.TextDocument) {\n\t\tif (document.uri.scheme === fileSchemes.git) {\n\t\t\ttry {\n\t\t\t\tconst path = vscode.Uri.file(JSON.parse(document.uri.query)?.path);\n\t\t\t\tif (doesResourceLookLikeATypeScriptFile(path) || doesResourceLookLikeAJavaScriptFile(path)) {\n\t\t\t\t\tconst document = await vscode.workspace.openTextDocument(path);\n\t\t\t\t\treturn this.client.toOpenedFilePath(document);\n\t\t\t\t}\n\t\t\t} catch {\n\t\t\t\t// noop\n\t\t\t}\n\t\t}\n\t\treturn this.client.toOpenedFilePath(document);\n\t}\n\n\tprivate toSymbolInformation(item: Proto.NavtoItem) {\n\t\tconst label = TypeScriptWorkspaceSymbolProvider.getLabel(item);\n\t\tconst info = new vscode.SymbolInformation(\n\t\t\tlabel,\n\t\t\tgetSymbolKind(item),\n\t\t\titem.containerName || '',\n\t\t\ttypeConverters.Location.fromTextSpan(this.client.toResource(item.file), item));\n\t\tconst kindModifiers = item.kindModifiers ? parseKindModifier(item.kindModifiers) : undefined;\n\t\tif (kindModifiers?.has(PConst.KindModifiers.deprecated)) {\n\t\t\tinfo.tags = [vscode.SymbolTag.Deprecated];\n\t\t}\n\t\treturn info;\n\t}\n\n\tprivate static getLabel(item: Proto.NavtoItem) {\n\t\tconst label = item.name;\n\t\tif (item.kind === 'method' || item.kind === 'function') {\n\t\t\treturn label + '()';\n\t\t}\n\t\treturn label;\n\t}\n\n\tprivate getDocument(): vscode.TextDocument | undefined {\n\t\t// typescript wants to have a resource even when asking\n\t\t// general questions so we check the active editor. If this\n\t\t// doesn't match we take the first TS document.\n\n\t\tconst activeDocument = vscode.window.activeTextEditor?.document;\n\t\tif (activeDocument) {\n\t\t\tif (this.modeIds.includes(activeDocument.languageId)) {\n\t\t\t\treturn activeDocument;\n\t\t\t}\n\t\t}\n\n\t\tconst documents = vscode.workspace.textDocuments;\n\t\tfor (const document of documents) {\n\t\t\tif (this.modeIds.includes(document.languageId)) {\n\t\t\t\treturn document;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nexport function register(\n\tclient: ITypeScriptServiceClient,\n\tmodeIds: readonly string[],\n) {\n\treturn vscode.languages.registerWorkspaceSymbolProvider(\n\t\tnew TypeScriptWorkspaceSymbolProvider(client, modeIds));\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport interface Lazy<T> {\n\tvalue: T;\n\thasValue: boolean;\n\tmap<R>(f: (x: T) => R): Lazy<R>;\n}\n\nclass LazyValue<T> implements Lazy<T> {\n\tprivate _hasValue: boolean = false;\n\tprivate _value?: T;\n\n\tconstructor(\n\t\tprivate readonly _getValue: () => T\n\t) { }\n\n\tget value(): T {\n\t\tif (!this._hasValue) {\n\t\t\tthis._hasValue = true;\n\t\t\tthis._value = this._getValue();\n\t\t}\n\t\treturn this._value!;\n\t}\n\n\tget hasValue(): boolean {\n\t\treturn this._hasValue;\n\t}\n\n\tpublic map<R>(f: (x: T) => R): Lazy<R> {\n\t\treturn new LazyValue(() => f(this.value));\n\t}\n}\n\nexport function lazy<T>(getValue: () => T): Lazy<T> {\n\treturn new LazyValue<T>(getValue);\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { ActiveJsTsEditorTracker } from './activeJsTsEditorTracker';\nimport { Disposable } from './dispose';\nimport { isJsConfigOrTsConfigFileName } from './languageDescription';\nimport { isSupportedLanguageMode } from './languageModeIds';\n\n/**E\n * When clause context set when the current file is managed by vscode's built-in typescript extension.\n */\nexport default class ManagedFileContextManager extends Disposable {\n\tprivate static readonly contextName = 'typescript.isManagedFile';\n\n\tprivate isInManagedFileContext: boolean = false;\n\n\tpublic constructor(\n\t\tactiveJsTsEditorTracker: ActiveJsTsEditorTracker,\n\t\tprivate readonly normalizePath: (resource: vscode.Uri) => string | undefined,\n\t) {\n\t\tsuper();\n\t\tactiveJsTsEditorTracker.onDidChangeActiveJsTsEditor(this.onDidChangeActiveTextEditor, this, this._disposables);\n\n\t\tthis.onDidChangeActiveTextEditor(activeJsTsEditorTracker.activeJsTsEditor);\n\t}\n\n\tprivate onDidChangeActiveTextEditor(editor?: vscode.TextEditor): void {\n\t\tif (editor) {\n\t\t\tthis.updateContext(this.isManagedFile(editor));\n\t\t} else {\n\t\t\tthis.updateContext(false);\n\t\t}\n\t}\n\n\tprivate updateContext(newValue: boolean) {\n\t\tif (newValue === this.isInManagedFileContext) {\n\t\t\treturn;\n\t\t}\n\n\t\tvscode.commands.executeCommand('setContext', ManagedFileContextManager.contextName, newValue);\n\t\tthis.isInManagedFileContext = newValue;\n\t}\n\n\tprivate isManagedFile(editor: vscode.TextEditor): boolean {\n\t\treturn this.isManagedScriptFile(editor) || this.isManagedConfigFile(editor);\n\t}\n\n\tprivate isManagedScriptFile(editor: vscode.TextEditor): boolean {\n\t\treturn isSupportedLanguageMode(editor.document) && this.normalizePath(editor.document.uri) !== null;\n\t}\n\n\tprivate isManagedConfigFile(editor: vscode.TextEditor): boolean {\n\t\treturn isJsConfigOrTsConfigFileName(editor.document.fileName);\n\t}\n}\n\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport Tracer from '../utils/tracer';\n\nexport interface OngoingRequestCanceller {\n\treadonly cancellationPipeName: string | undefined;\n\ttryCancelOngoingRequest(seq: number): boolean;\n}\n\nexport interface OngoingRequestCancellerFactory {\n\tcreate(serverId: string, tracer: Tracer): OngoingRequestCanceller;\n}\n\nconst noopRequestCanceller = new class implements OngoingRequestCanceller {\n\tpublic readonly cancellationPipeName = undefined;\n\n\tpublic tryCancelOngoingRequest(_seq: number): boolean {\n\t\treturn false;\n\t}\n};\n\nexport const noopRequestCancellerFactory = new class implements OngoingRequestCancellerFactory {\n\tcreate(_serverId: string, _tracer: Tracer): OngoingRequestCanceller {\n\t\treturn noopRequestCanceller;\n\t}\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport interface ILogDirectoryProvider {\n\tgetNewLogDirectory(): string | undefined;\n}\n\nexport const noopLogDirectoryProvider = new class implements ILogDirectoryProvider {\n\tpublic getNewLogDirectory(): undefined {\n\t\treturn undefined;\n\t}\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as nls from 'vscode-nls';\nimport type * as Proto from '../protocol';\nimport { TypeScriptServiceConfiguration } from '../utils/configuration';\nimport { memoize } from '../utils/memoize';\nimport { TsServerProcess, TsServerProcessKind } from './server';\n\n\nconst localize = nls.loadMessageBundle();\n\ndeclare const Worker: any;\ndeclare type Worker = any;\n\nexport class WorkerServerProcess implements TsServerProcess {\n\n\tpublic static fork(\n\t\ttsServerPath: string,\n\t\targs: readonly string[],\n\t\t_kind: TsServerProcessKind,\n\t\t_configuration: TypeScriptServiceConfiguration,\n\t) {\n\t\tconst worker = new Worker(tsServerPath);\n\t\treturn new WorkerServerProcess(worker, [\n\t\t\t...args,\n\n\t\t\t// Explicitly give TS Server its path so it can\n\t\t\t// load local resources\n\t\t\t'--executingFilePath', tsServerPath,\n\t\t]);\n\t}\n\n\tprivate _onDataHandlers = new Set<(data: Proto.Response) => void>();\n\tprivate _onErrorHandlers = new Set<(err: Error) => void>();\n\tprivate _onExitHandlers = new Set<(code: number | null, signal: string | null) => void>();\n\n\tpublic constructor(\n\t\tprivate readonly worker: Worker,\n\t\targs: readonly string[],\n\t) {\n\t\tworker.addEventListener('message', (msg: any) => {\n\t\t\tif (msg.data.type === 'log') {\n\t\t\t\tthis.output.appendLine(msg.data.body);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfor (const handler of this._onDataHandlers) {\n\t\t\t\thandler(msg.data);\n\t\t\t}\n\t\t});\n\t\tworker.onerror = (err: Error) => {\n\t\t\tfor (const handler of this._onErrorHandlers) {\n\t\t\t\thandler(err);\n\t\t\t}\n\t\t};\n\t\tworker.postMessage(args);\n\t}\n\n\t@memoize\n\tprivate get output(): vscode.OutputChannel {\n\t\treturn vscode.window.createOutputChannel(localize('channelName', 'TypeScript Server Log'));\n\t}\n\n\twrite(serverRequest: Proto.Request): void {\n\t\tthis.worker.postMessage(serverRequest);\n\t}\n\n\tonData(handler: (response: Proto.Response) => void): void {\n\t\tthis._onDataHandlers.add(handler);\n\t}\n\n\tonError(handler: (err: Error) => void): void {\n\t\tthis._onErrorHandlers.add(handler);\n\t}\n\n\tonExit(handler: (code: number | null, signal: string | null) => void): void {\n\t\tthis._onExitHandlers.add(handler);\n\t\t// Todo: not implemented\n\t}\n\n\tkill(): void {\n\t\tthis.worker.terminate();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { Disposable } from './dispose';\nimport { isJsConfigOrTsConfigFileName } from './languageDescription';\nimport { isSupportedLanguageMode } from './languageModeIds';\n\n/**\n * Tracks the active JS/TS editor.\n *\n * This tries to handle the case where the user focuses in the output view / debug console.\n * When this happens, we want to treat the last real focused editor as the active editor,\n * instead of using `vscode.window.activeTextEditor`\n */\nexport class ActiveJsTsEditorTracker extends Disposable {\n\n\tprivate _activeJsTsEditor: vscode.TextEditor | undefined;\n\n\tprivate readonly _onDidChangeActiveJsTsEditor = this._register(new vscode.EventEmitter<vscode.TextEditor | undefined>());\n\tpublic readonly onDidChangeActiveJsTsEditor = this._onDidChangeActiveJsTsEditor.event;\n\n\tpublic constructor() {\n\t\tsuper();\n\t\tvscode.window.onDidChangeActiveTextEditor(this.onDidChangeActiveTextEditor, this, this._disposables);\n\t\tvscode.window.onDidChangeVisibleTextEditors(() => {\n\t\t\t// Make sure the active editor is still in the visible set.\n\t\t\t// This can happen if the output view is focused and the last active TS file is closed\n\t\t\tif (this._activeJsTsEditor) {\n\t\t\t\tif (!vscode.window.visibleTextEditors.some(visibleEditor => visibleEditor === this._activeJsTsEditor)) {\n\t\t\t\t\tthis.onDidChangeActiveTextEditor(undefined);\n\t\t\t\t}\n\t\t\t}\n\t\t}, this, this._disposables);\n\n\t\tthis.onDidChangeActiveTextEditor(vscode.window.activeTextEditor);\n\t}\n\n\tpublic get activeJsTsEditor(): vscode.TextEditor | undefined {\n\t\treturn this._activeJsTsEditor;\n\t}\n\n\tprivate onDidChangeActiveTextEditor(editor: vscode.TextEditor | undefined): any {\n\t\tif (editor === this._activeJsTsEditor) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (editor && !editor.viewColumn) {\n\t\t\t// viewColumn is undefined for the debug/output panel, but we still want\n\t\t\t// to show the version info for the previous editor\n\t\t\treturn;\n\t\t}\n\n\t\tif (editor && this.isManagedFile(editor)) {\n\t\t\tthis._activeJsTsEditor = editor;\n\t\t} else {\n\t\t\tthis._activeJsTsEditor = undefined;\n\t\t}\n\t\tthis._onDidChangeActiveJsTsEditor.fire(this._activeJsTsEditor);\n\t}\n\n\tprivate isManagedFile(editor: vscode.TextEditor): boolean {\n\t\treturn this.isManagedScriptFile(editor) || this.isManagedConfigFile(editor);\n\t}\n\n\tprivate isManagedScriptFile(editor: vscode.TextEditor): boolean {\n\t\treturn isSupportedLanguageMode(editor.document);\n\t}\n\n\tprivate isManagedConfigFile(editor: vscode.TextEditor): boolean {\n\t\treturn isJsConfigOrTsConfigFileName(editor.document.fileName);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { BaseServiceConfigurationProvider } from './configuration';\n\nexport class BrowserServiceConfigurationProvider extends BaseServiceConfigurationProvider {\n\n\t// On browsers, we only support using the built-in TS version\n\tprotected extractGlobalTsdk(_configuration: vscode.WorkspaceConfiguration): string | null {\n\t\treturn null;\n\t}\n\n\tprotected extractLocalTsdk(_configuration: vscode.WorkspaceConfiguration): string | null {\n\t\treturn null;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as arrays from './arrays';\nimport { Disposable } from './dispose';\n\nexport interface TypeScriptServerPlugin {\n\treadonly path: string;\n\treadonly name: string;\n\treadonly enableForWorkspaceTypeScriptVersions: boolean;\n\treadonly languages: ReadonlyArray<string>;\n\treadonly configNamespace?: string\n}\n\nnamespace TypeScriptServerPlugin {\n\texport function equals(a: TypeScriptServerPlugin, b: TypeScriptServerPlugin): boolean {\n\t\treturn a.path === b.path\n\t\t\t&& a.name === b.name\n\t\t\t&& a.enableForWorkspaceTypeScriptVersions === b.enableForWorkspaceTypeScriptVersions\n\t\t\t&& arrays.equals(a.languages, b.languages);\n\t}\n}\n\nexport class PluginManager extends Disposable {\n\tprivate readonly _pluginConfigurations = new Map<string, {}>();\n\n\tprivate _plugins: Map<string, ReadonlyArray<TypeScriptServerPlugin>> | undefined;\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tvscode.extensions.onDidChange(() => {\n\t\t\tif (!this._plugins) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst newPlugins = this.readPlugins();\n\t\t\tif (!arrays.equals(arrays.flatten(Array.from(this._plugins.values())), arrays.flatten(Array.from(newPlugins.values())), TypeScriptServerPlugin.equals)) {\n\t\t\t\tthis._plugins = newPlugins;\n\t\t\t\tthis._onDidUpdatePlugins.fire(this);\n\t\t\t}\n\t\t}, undefined, this._disposables);\n\t}\n\n\tpublic get plugins(): ReadonlyArray<TypeScriptServerPlugin> {\n\t\tif (!this._plugins) {\n\t\t\tthis._plugins = this.readPlugins();\n\t\t}\n\t\treturn arrays.flatten(Array.from(this._plugins.values()));\n\t}\n\n\tprivate readonly _onDidUpdatePlugins = this._register(new vscode.EventEmitter<this>());\n\tpublic readonly onDidChangePlugins = this._onDidUpdatePlugins.event;\n\n\tprivate readonly _onDidUpdateConfig = this._register(new vscode.EventEmitter<{ pluginId: string, config: {} }>());\n\tpublic readonly onDidUpdateConfig = this._onDidUpdateConfig.event;\n\n\tpublic setConfiguration(pluginId: string, config: {}) {\n\t\tthis._pluginConfigurations.set(pluginId, config);\n\t\tthis._onDidUpdateConfig.fire({ pluginId, config });\n\t}\n\n\tpublic configurations(): IterableIterator<[string, {}]> {\n\t\treturn this._pluginConfigurations.entries();\n\t}\n\n\tprivate readPlugins() {\n\t\tconst pluginMap = new Map<string, ReadonlyArray<TypeScriptServerPlugin>>();\n\t\tfor (const extension of vscode.extensions.all) {\n\t\t\tconst pack = extension.packageJSON;\n\t\t\tif (pack.contributes && Array.isArray(pack.contributes.typescriptServerPlugins)) {\n\t\t\t\tconst plugins: TypeScriptServerPlugin[] = [];\n\t\t\t\tfor (const plugin of pack.contributes.typescriptServerPlugins) {\n\t\t\t\t\tplugins.push({\n\t\t\t\t\t\tname: plugin.name,\n\t\t\t\t\t\tenableForWorkspaceTypeScriptVersions: !!plugin.enableForWorkspaceTypeScriptVersions,\n\t\t\t\t\t\tpath: extension.extensionPath,\n\t\t\t\t\t\tlanguages: Array.isArray(plugin.languages) ? plugin.languages : [],\n\t\t\t\t\t\tconfigNamespace: plugin.configNamespace,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (plugins.length) {\n\t\t\t\t\tpluginMap.set(extension.id, plugins);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn pluginMap;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as jsonc from 'jsonc-parser';\nimport { basename, dirname, join } from 'path';\nimport * as vscode from 'vscode';\nimport { coalesce, flatten } from '../utils/arrays';\n\nfunction mapChildren<R>(node: jsonc.Node | undefined, f: (x: jsonc.Node) => R): R[] {\n\treturn node && node.type === 'array' && node.children\n\t\t? node.children.map(f)\n\t\t: [];\n}\n\nclass TsconfigLinkProvider implements vscode.DocumentLinkProvider {\n\n\tpublic provideDocumentLinks(\n\t\tdocument: vscode.TextDocument,\n\t\t_token: vscode.CancellationToken\n\t): vscode.ProviderResult<vscode.DocumentLink[]> {\n\t\tconst root = jsonc.parseTree(document.getText());\n\t\tif (!root) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn coalesce([\n\t\t\tthis.getExtendsLink(document, root),\n\t\t\t...this.getFilesLinks(document, root),\n\t\t\t...this.getReferencesLinks(document, root)\n\t\t]);\n\t}\n\n\tprivate getExtendsLink(document: vscode.TextDocument, root: jsonc.Node): vscode.DocumentLink | undefined {\n\t\tconst extendsNode = jsonc.findNodeAtLocation(root, ['extends']);\n\t\tif (!this.isPathValue(extendsNode)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (extendsNode.value.startsWith('.')) {\n\t\t\treturn new vscode.DocumentLink(\n\t\t\t\tthis.getRange(document, extendsNode),\n\t\t\t\tvscode.Uri.file(join(dirname(document.uri.fsPath), extendsNode.value + (extendsNode.value.endsWith('.json') ? '' : '.json')))\n\t\t\t);\n\t\t}\n\n\t\tconst workspaceFolderPath = vscode.workspace.getWorkspaceFolder(document.uri)!.uri.fsPath;\n\t\treturn new vscode.DocumentLink(\n\t\t\tthis.getRange(document, extendsNode),\n\t\t\tvscode.Uri.file(join(workspaceFolderPath, 'node_modules', extendsNode.value + (extendsNode.value.endsWith('.json') ? '' : '.json')))\n\t\t);\n\t}\n\n\tprivate getFilesLinks(document: vscode.TextDocument, root: jsonc.Node) {\n\t\treturn mapChildren(\n\t\t\tjsonc.findNodeAtLocation(root, ['files']),\n\t\t\tchild => this.pathNodeToLink(document, child));\n\t}\n\n\tprivate getReferencesLinks(document: vscode.TextDocument, root: jsonc.Node) {\n\t\treturn mapChildren(\n\t\t\tjsonc.findNodeAtLocation(root, ['references']),\n\t\t\tchild => {\n\t\t\t\tconst pathNode = jsonc.findNodeAtLocation(child, ['path']);\n\t\t\t\tif (!this.isPathValue(pathNode)) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\treturn new vscode.DocumentLink(this.getRange(document, pathNode),\n\t\t\t\t\tbasename(pathNode.value).endsWith('.json')\n\t\t\t\t\t\t? this.getFileTarget(document, pathNode)\n\t\t\t\t\t\t: this.getFolderTarget(document, pathNode));\n\t\t\t});\n\t}\n\n\tprivate pathNodeToLink(\n\t\tdocument: vscode.TextDocument,\n\t\tnode: jsonc.Node | undefined\n\t): vscode.DocumentLink | undefined {\n\t\treturn this.isPathValue(node)\n\t\t\t? new vscode.DocumentLink(this.getRange(document, node), this.getFileTarget(document, node))\n\t\t\t: undefined;\n\t}\n\n\tprivate isPathValue(extendsNode: jsonc.Node | undefined): extendsNode is jsonc.Node {\n\t\treturn extendsNode\n\t\t\t&& extendsNode.type === 'string'\n\t\t\t&& extendsNode.value\n\t\t\t&& !(extendsNode.value as string).includes('*'); // don't treat globs as links.\n\t}\n\n\tprivate getFileTarget(document: vscode.TextDocument, node: jsonc.Node): vscode.Uri {\n\t\treturn vscode.Uri.file(join(dirname(document.uri.fsPath), node!.value));\n\t}\n\n\tprivate getFolderTarget(document: vscode.TextDocument, node: jsonc.Node): vscode.Uri {\n\t\treturn vscode.Uri.file(join(dirname(document.uri.fsPath), node!.value, 'tsconfig.json'));\n\t}\n\n\tprivate getRange(document: vscode.TextDocument, node: jsonc.Node) {\n\t\tconst offset = node!.offset;\n\t\tconst start = document.positionAt(offset + 1);\n\t\tconst end = document.positionAt(offset + (node!.length - 1));\n\t\treturn new vscode.Range(start, end);\n\t}\n}\n\nexport function register() {\n\tconst patterns: vscode.GlobPattern[] = [\n\t\t'**/[jt]sconfig.json',\n\t\t'**/[jt]sconfig.*.json',\n\t];\n\n\tconst languages = ['json', 'jsonc'];\n\n\tconst selector: vscode.DocumentSelector = flatten(\n\t\tlanguages.map(language =>\n\t\t\tpatterns.map((pattern): vscode.DocumentFilter => ({ language, pattern }))));\n\n\treturn vscode.languages.registerDocumentLinkProvider(selector, new TsconfigLinkProvider());\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { Api, getExtensionApi } from './api';\nimport { CommandManager } from './commands/commandManager';\nimport { registerBaseCommands } from './commands/index';\nimport { LanguageConfigurationManager } from './languageFeatures/languageConfiguration';\nimport { createLazyClientHost, lazilyActivateClient } from './lazyClientHost';\nimport { noopRequestCancellerFactory } from './tsServer/cancellation';\nimport { noopLogDirectoryProvider } from './tsServer/logDirectoryProvider';\nimport { WorkerServerProcess } from './tsServer/serverProcess.browser';\nimport { ITypeScriptVersionProvider, TypeScriptVersion, TypeScriptVersionSource } from './tsServer/versionProvider';\nimport { ActiveJsTsEditorTracker } from './utils/activeJsTsEditorTracker';\nimport API from './utils/api';\nimport { TypeScriptServiceConfiguration } from './utils/configuration';\nimport { BrowserServiceConfigurationProvider } from './utils/configuration.browser';\nimport { PluginManager } from './utils/plugins';\n\nclass StaticVersionProvider implements ITypeScriptVersionProvider {\n\n\tconstructor(\n\t\tprivate readonly _version: TypeScriptVersion\n\t) { }\n\n\tupdateConfiguration(_configuration: TypeScriptServiceConfiguration): void {\n\t\t// noop\n\t}\n\n\tget defaultVersion() { return this._version; }\n\tget bundledVersion() { return this._version; }\n\n\treadonly globalVersion = undefined;\n\treadonly localVersion = undefined;\n\treadonly localVersions = [];\n}\n\nexport function activate(\n\tcontext: vscode.ExtensionContext\n): Api {\n\tconst pluginManager = new PluginManager();\n\tcontext.subscriptions.push(pluginManager);\n\n\tconst commandManager = new CommandManager();\n\tcontext.subscriptions.push(commandManager);\n\n\tcontext.subscriptions.push(new LanguageConfigurationManager());\n\n\tconst onCompletionAccepted = new vscode.EventEmitter<vscode.CompletionItem>();\n\tcontext.subscriptions.push(onCompletionAccepted);\n\n\tconst activeJsTsEditorTracker = new ActiveJsTsEditorTracker();\n\tcontext.subscriptions.push(activeJsTsEditorTracker);\n\n\tconst versionProvider = new StaticVersionProvider(\n\t\tnew TypeScriptVersion(\n\t\t\tTypeScriptVersionSource.Bundled,\n\t\t\tvscode.Uri.joinPath(context.extensionUri, 'dist/browser/typescript/tsserver.web.js').toString(),\n\t\t\tAPI.fromSimpleString('4.4.1')));\n\n\tconst lazyClientHost = createLazyClientHost(context, false, {\n\t\tpluginManager,\n\t\tcommandManager,\n\t\tlogDirectoryProvider: noopLogDirectoryProvider,\n\t\tcancellerFactory: noopRequestCancellerFactory,\n\t\tversionProvider,\n\t\tprocessFactory: WorkerServerProcess,\n\t\tactiveJsTsEditorTracker,\n\t\tserviceConfigurationProvider: new BrowserServiceConfigurationProvider(),\n\t}, item => {\n\t\tonCompletionAccepted.fire(item);\n\t});\n\n\tregisterBaseCommands(commandManager, lazyClientHost, pluginManager, activeJsTsEditorTracker);\n\n\t// context.subscriptions.push(task.register(lazyClientHost.map(x => x.serviceClient)));\n\n\timport('./languageFeatures/tsconfig').then(module => {\n\t\tcontext.subscriptions.push(module.register());\n\t});\n\n\tcontext.subscriptions.push(lazilyActivateClient(lazyClientHost, pluginManager, activeJsTsEditorTracker));\n\n\treturn getExtensionApi(onCompletionAccepted.event, pluginManager);\n}\n"],"sourceRoot":""}